"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9672],{9672:(Q,D,l)=>{l.r(D),l.d(D,{CalendarPageModule:()=>Nt});var v=l(6814),Z=l(6223),w=l(3582),k=l(8520),y=l(5861),Y=l(4036),p=l(6676),t=l(2029),P=l(2042),S=l(2234),$=l(5693),W=l(3271),F=l(2425),H=l(7364),A=l(3911),E=l(7913);function R(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",12)(1,"div",13),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.previousMonth())}),t._UZ(2,"img",14),t.qZA(),t.TgZ(3,"div",15),t._uU(4),t.qZA(),t.TgZ(5,"div",13),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.nextMonth())}),t._UZ(6,"img",16),t.qZA()()}if(2&a){const e=t.oxw();t.xp6(4),t.AsE(" ",e.monthNames[e.currentMonth]," ",e.currentYear," ")}}function q(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",12)(1,"div",13),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.previousWeek())}),t._UZ(2,"img",14),t.qZA(),t.TgZ(3,"div",15),t._uU(4),t.qZA(),t.TgZ(5,"div",13),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.nextWeek())}),t._UZ(6,"img",16),t.qZA()()}if(2&a){const e=t.oxw();t.xp6(4),t.hij(" ",e.getWeekRangeDisplay()," ")}}function j(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",12)(1,"div",13),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.previousDay())}),t._UZ(2,"img",14),t.qZA(),t.TgZ(3,"div",15),t._uU(4),t.qZA(),t.TgZ(5,"div",13),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.nextDay())}),t._UZ(6,"img",16),t.qZA()()}if(2&a){const e=t.oxw();t.xp6(4),t.HOy(" ",e.getWeekdayName(e.selectedDate),", ",e.currentDay," ",e.monthNames[e.currentMonth]," ",e.currentYear," ")}}function B(a,s){if(1&a&&(t.TgZ(0,"span",23),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.xp6(1),t.Oqu(e)}}function z(a,s){1&a&&t._UZ(0,"span",42)}function K(a,s){1&a&&t._UZ(0,"span",43)}function L(a,s){1&a&&t._UZ(0,"span",44)}function G(a,s){1&a&&t._UZ(0,"span",45)}function V(a,s){1&a&&t._UZ(0,"span",46)}function X(a,s){1&a&&t._UZ(0,"span",47)}function tt(a,s){1&a&&t._UZ(0,"span",46)}function et(a,s){1&a&&t._UZ(0,"span",48)}function nt(a,s){1&a&&t._UZ(0,"span",49)}function at(a,s){1&a&&t._UZ(0,"span",48)}function it(a,s){1&a&&t._UZ(0,"span",50)}function st(a,s){1&a&&t._UZ(0,"span",51)}function ot(a,s){1&a&&t._UZ(0,"span",52)}function rt(a,s){if(1&a&&t._UZ(0,"span",53),2&a){const e=t.oxw().$implicit;t.Q6J("ngClass",e.private||e.collective||e.other?"bottom-position-bar":"top-position-bar")}}function ct(a,s){if(1&a&&t._UZ(0,"span",54),2&a){const e=t.oxw().$implicit;t.Q6J("ngClass",e.private||e.collective||e.other?"bottom-position-bar":"top-position-bar")}}function lt(a,s){if(1&a&&t._UZ(0,"span",55),2&a){const e=t.oxw().$implicit;t.Q6J("ngClass",e.private||e.collective||e.other?"bottom-position-bar":"top-position-bar")}}function dt(a,s){if(1&a&&t._UZ(0,"span",56),2&a){const e=t.oxw().$implicit;t.Q6J("ngClass",e.private||e.collective||e.other?"bottom-position-bar":"top-position-bar")}}const pt=function(a){return{"very-light-opacity":a}};function ht(a,s){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"span",24),t.NdJ("click",function(){const o=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.selectDay(o))}),t.TgZ(2,"span",25)(3,"span",26),t._uU(4),t.qZA(),t.YNc(5,z,1,0,"span",27),t.YNc(6,K,1,0,"span",28),t.YNc(7,L,1,0,"span",29),t.YNc(8,G,1,0,"span",30),t.YNc(9,V,1,0,"span",31),t.YNc(10,X,1,0,"span",32),t.YNc(11,tt,1,0,"span",31),t.YNc(12,et,1,0,"span",33),t.YNc(13,nt,1,0,"span",34),t.YNc(14,at,1,0,"span",33),t.YNc(15,it,1,0,"span",35),t.YNc(16,st,1,0,"span",36),t.YNc(17,ot,1,0,"span",37),t.YNc(18,rt,1,1,"span",38),t.YNc(19,ct,1,1,"span",39),t.YNc(20,lt,1,1,"span",40),t.YNc(21,dt,1,1,"span",41),t.qZA()(),t.BQk()}if(2&a){const e=s.$implicit;t.xp6(1),t.Q6J("ngClass",t.VKq(19,pt,e.past)),t.xp6(3),t.Oqu(e.number),t.xp6(1),t.Q6J("ngIf",e.today),t.xp6(1),t.Q6J("ngIf",e.private&&!e.collective&&!e.other),t.xp6(1),t.Q6J("ngIf",!e.private&&e.collective&&!e.other),t.xp6(1),t.Q6J("ngIf",!e.private&&!e.collective&&e.other),t.xp6(1),t.Q6J("ngIf",e.private&&e.collective&&!e.other),t.xp6(1),t.Q6J("ngIf",e.private&&e.collective&&!e.other),t.xp6(1),t.Q6J("ngIf",e.private&&!e.collective&&e.other),t.xp6(1),t.Q6J("ngIf",e.private&&!e.collective&&e.other),t.xp6(1),t.Q6J("ngIf",!e.private&&e.collective&&e.other),t.xp6(1),t.Q6J("ngIf",!e.private&&e.collective&&e.other),t.xp6(1),t.Q6J("ngIf",e.private&&e.collective&&e.other),t.xp6(1),t.Q6J("ngIf",e.private&&e.collective&&e.other),t.xp6(1),t.Q6J("ngIf",e.private&&e.collective&&e.other),t.xp6(1),t.Q6J("ngIf",e.block&&!e.blockPayed),t.xp6(1),t.Q6J("ngIf",!e.block&&e.blockPayed),t.xp6(1),t.Q6J("ngIf",e.block&&e.blockPayed),t.xp6(1),t.Q6J("ngIf",e.block&&e.blockPayed)}}function gt(a,s){if(1&a&&(t.TgZ(0,"div",17)(1,"div",18)(2,"div",19),t.YNc(3,B,2,1,"span",20),t.qZA(),t.TgZ(4,"div",21),t.YNc(5,ht,22,21,"ng-container",22),t.qZA()()()),2&a){const e=t.oxw();t.xp6(3),t.Q6J("ngForOf",e.weekdays),t.xp6(2),t.Q6J("ngForOf",e.days)}}function _t(a,s){if(1&a&&(t.TgZ(0,"div",66),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.xp6(1),t.Oqu(e)}}function ut(a,s){if(1&a&&(t.TgZ(0,"div",67),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.xp6(1),t.hij(" ",e," ")}}function ft(a,s){1&a&&t._UZ(0,"div",68)}const vt=function(a,s,e,n,i){return{"collective-icon-only":a,"private-icon-only":s,"other-icon-only":e,"block-icon-only":n,"block-payed-icon-only":i}};function yt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",69),t.NdJ("click",function(){const o=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG("block"===o.type?c.openAvailables(o.block_id,o.date):"block_payed"===o.type||"other"===o.type?null:c.goTo("course-detail",o.booking_id,o.date))}),t._UZ(1,"img",70),t.qZA()}if(2&a){const e=s.$implicit,n=t.oxw(2);t.Q6J("ngClass",t.qbA(3,vt,"collective"===e.type,"private"===e.type,"other"===e.type,"block"===e.type,"block_payed"===e.type))("ngStyle",n.getTaskStyle(e,!0)),t.xp6(1),t.Q6J("src",n.getIconForTaskType(e.type),t.LSH)}}function mt(a,s){if(1&a&&(t.TgZ(0,"div",17)(1,"div",57)(2,"div",58),t.YNc(3,_t,2,1,"div",59),t.qZA(),t.TgZ(4,"div",60)(5,"div",61),t.YNc(6,ut,2,1,"div",62),t.qZA(),t.TgZ(7,"div",63),t.YNc(8,ft,1,0,"div",64),t.YNc(9,yt,2,9,"div",65),t.qZA()()()()),2&a){const e=t.oxw();t.xp6(3),t.Q6J("ngForOf",e.weekdaysShort),t.xp6(3),t.Q6J("ngForOf",e.hoursRange),t.xp6(2),t.Q6J("ngForOf",e.hoursRange),t.xp6(1),t.Q6J("ngForOf",e.filteredTasksWeek)}}function xt(a,s){if(1&a&&(t.TgZ(0,"div",67),t._uU(1),t.qZA()),2&a){const e=s.$implicit;t.xp6(1),t.hij(" ",e," ")}}function bt(a,s){1&a&&t._UZ(0,"div",68)}function kt(a,s){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",e.sport_name," ")}}function Ct(a,s){if(1&a&&(t.TgZ(0,"div",74),t._UZ(1,"img",75),t.TgZ(2,"div",76)(3,"div",77),t._uU(4),t.qZA(),t.TgZ(5,"span",78),t._uU(6),t.ALo(7,"translate"),t.YNc(8,kt,2,1,"ng-container",79),t.qZA()(),t.TgZ(9,"div",80)(10,"div",81),t._UZ(11,"img",82),t.TgZ(12,"span"),t._uU(13),t.qZA()(),t.TgZ(14,"div",81),t._UZ(15,"img",83),t.TgZ(16,"span"),t._uU(17),t.qZA()()()()),2&a){const e=t.oxw().$implicit,n=t.oxw(2);t.xp6(4),t.Oqu(e.name),t.xp6(2),t.hij(" ",t.lcZ(7,7,"collective")," "),t.xp6(2),t.Q6J("ngIf",e.sport_name&&n.sports.length),t.xp6(5),t.AsE("",e.clients,"/",e.max_participants,""),t.xp6(4),t.AsE("",e.date_index,"/",e.date_total,"")}}function Mt(a,s){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const e=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",e.sport_name," ")}}function Dt(a,s){if(1&a&&(t.TgZ(0,"div",74),t._UZ(1,"img",84),t.TgZ(2,"div",76)(3,"div",77),t._uU(4),t.qZA(),t.TgZ(5,"span",78),t._uU(6),t.ALo(7,"translate"),t.YNc(8,Mt,2,1,"ng-container",79),t.qZA()()()),2&a){const e=t.oxw().$implicit,n=t.oxw(2);t.xp6(4),t.Oqu(e.name),t.xp6(2),t.hij(" ",t.lcZ(7,3,"private")," "),t.xp6(2),t.Q6J("ngIf",e.sport_name&&n.sports.length)}}function wt(a,s){1&a&&(t.TgZ(0,"div",74),t._UZ(1,"img",85),t.TgZ(2,"div",76)(3,"div",77),t._uU(4,"Activit\xe9"),t.qZA()()())}function Pt(a,s){if(1&a&&(t.TgZ(0,"div",86),t._uU(1),t.qZA()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.name," ")}}function Tt(a,s){if(1&a&&(t.TgZ(0,"div",86),t._uU(1),t.qZA()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.name," ")}}const Ot=function(a,s,e,n,i){return{"collective-icon-full":a,"private-icon-full":s,"other-icon-full":e,"block-icon-full":n,"block-payed-icon-full":i}};function Zt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",69),t.NdJ("click",function(){const o=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG("block"===o.type?c.openAvailables(o.block_id,o.date):"block_payed"===o.type||"other"===o.type?null:c.goTo("course-detail",o.booking_id,o.date))}),t.YNc(1,Ct,18,9,"div",72),t.YNc(2,Dt,9,5,"div",72),t.YNc(3,wt,5,0,"div",72),t.YNc(4,Pt,2,1,"div",73),t.YNc(5,Tt,2,1,"div",73),t.qZA()}if(2&a){const e=s.$implicit,n=t.oxw(2);t.Q6J("ngClass",t.qbA(7,Ot,"collective"===e.type,"private"===e.type,"other"===e.type,"block"===e.type,"block_payed"===e.type))("ngStyle",n.getTaskStyle(e)),t.xp6(1),t.Q6J("ngIf","collective"===e.type),t.xp6(1),t.Q6J("ngIf","private"===e.type),t.xp6(1),t.Q6J("ngIf","other"===e.type),t.xp6(1),t.Q6J("ngIf","block"===e.type),t.xp6(1),t.Q6J("ngIf","block_payed"===e.type)}}function Yt(a,s){if(1&a&&(t.TgZ(0,"div",17)(1,"div",71)(2,"div",61),t.YNc(3,xt,2,1,"div",62),t.qZA(),t.TgZ(4,"div",63),t.YNc(5,bt,1,0,"div",64),t.YNc(6,Zt,6,13,"div",65),t.qZA()()()),2&a){const e=t.oxw();t.xp6(3),t.Q6J("ngForOf",e.hoursRange),t.xp6(2),t.Q6J("ngForOf",e.hoursRange),t.xp6(1),t.Q6J("ngForOf",e.filteredTasks)}}const J=function(a,s){return{"btn-back-primary":a,"btn-back-grey":s}},St=[{path:"",component:(()=>{var a;class s{constructor(n,i,o,c,r,d,_,u){this.router=n,this.menuService=i,this.monitorDataService=o,this.sharedDataService=c,this.teachService=r,this.toastr=d,this.spinnerService=_,this.translate=u,this.showMonth=!0,this.showWeek=!1,this.showDay=!1,this.today=new Date,this.monthNames=[],this.weekdays=[],this.weekdaysShort=[],this.weekdayNames=[],this.days=[],this.filteredTasksWeek=[],this.tasksCalendar=[],this.hourStartDay="08:00",this.hourEndDay="18:00",this.hoursRange=[],this.bookingsCurrent=[],this.nwdsCurrent=[],this.degrees=[],this.sports=[],this.canRestart=!1,this.translate.onLangChange.subscribe(()=>{this.loadWeekdays()}),this.loadWeekdays()}ngOnInit(){var n=this;return(0,y.Z)(function*(){n.subscription=n.monitorDataService.getMonitorData().subscribe(function(){var i=(0,y.Z)(function*(o){if(o){n.spinnerService.show(),n.monitorData=o;try{n.sports=yield(0,Y.z)(n.sharedDataService.fetchSports(n.monitorData.active_school))}catch(d){console.error("Error fetching data:",d),n.toastr.error(n.translate.instant("toast.error_loading_data"))}n.selectedDate=new Date,n.currentMonth=n.selectedDate.getMonth(),n.currentYear=n.selectedDate.getFullYear(),n.currentDay=n.selectedDate.getDate();const{firstDay:c,lastDay:r}=n.getMonthBoundaries(n.currentYear,n.currentMonth);yield n.generateHoursRange(),n.loadBookings(c,r)}});return function(o){return i.apply(this,arguments)}}())})()}loadWeekdays(){this.weekdays=[this.translate.instant("days_abbrev.sunday"),this.translate.instant("days_abbrev.monday"),this.translate.instant("days_abbrev.tuesday"),this.translate.instant("days_abbrev.wednesday"),this.translate.instant("days_abbrev.thursday"),this.translate.instant("days_abbrev.friday"),this.translate.instant("days_abbrev.saturday")],this.weekdaysShort=[this.translate.instant("days_abbrev_short.sunday"),this.translate.instant("days_abbrev_short.monday"),this.translate.instant("days_abbrev_short.tuesday"),this.translate.instant("days_abbrev_short.wednesday"),this.translate.instant("days_abbrev_short.thursday"),this.translate.instant("days_abbrev_short.friday"),this.translate.instant("days_abbrev_short.saturday")],this.weekdayNames=[this.translate.instant("days.sunday"),this.translate.instant("days.monday"),this.translate.instant("days.tuesday"),this.translate.instant("days.wednesday"),this.translate.instant("days.thursday"),this.translate.instant("days.friday"),this.translate.instant("days.saturday")],this.monthNames=[this.translate.instant("months.january"),this.translate.instant("months.february"),this.translate.instant("months.march"),this.translate.instant("months.april"),this.translate.instant("months.may"),this.translate.instant("months.june"),this.translate.instant("months.july"),this.translate.instant("months.august"),this.translate.instant("months.september"),this.translate.instant("months.october"),this.translate.instant("months.november"),this.translate.instant("months.december")]}ionViewDidEnter(){this.restartTasksAgain()}getMonthBoundaries(n,i){return{firstDay:p(new Date(n,i,1)).format("YYYY-MM-DD"),lastDay:p(new Date(n,i+1,0)).format("YYYY-MM-DD")}}restartTasks(){const{firstDay:n,lastDay:i}=this.getMonthBoundaries(this.currentYear,this.currentMonth);this.loadBookings(n,i)}restartTasksRange(n,i){this.loadBookings(n,i)}restartTasksAgain(){if(this.canRestart){if(this.showMonth)this.restartTasks();else if(this.showWeek){const n=p(this.weekStart).format("YYYY-MM-DD"),i=p(this.weekEnd).format("YYYY-MM-DD");this.restartTasksRange(n,i)}else if(this.showDay){const n=p(this.selectedDate).format("YYYY-MM-DD");this.restartTasksRange(n,n)}}else this.canRestart=!0}loadBookings(n,i){this.spinnerService.show();const o={date_start:n,date_end:i};this.monitorData.active_school&&(o.school_id=this.monitorData.active_school),this.teachService.getData("teach/getAgenda",null,o).subscribe(c=>{this.processBookings(c.data.bookings,c.data.nwd)},c=>{console.error("There was an error!",c),this.spinnerService.hide()})}processBookings(n,i){const o=new Map;let c;this.bookingsCurrent=[],this.nwdsCurrent=i,n.forEach(r=>{if(r.course){let d=`${r.course_id}-${r.course_date_id}`;1==r.course.course_type&&(d=`${r.course_id}-${r.course_date_id}-${r.course_subgroup_id}`),o.has(d)?o.get(d).all_clients.push(r.client):(o.set(d,{...r,all_clients:[r.client]}),this.bookingsCurrent.push(o.get(d)))}}),c=this.monitorData.active_school?this.nwdsCurrent.filter(r=>r.school_id===this.monitorData.active_school):this.nwdsCurrent,this.tasksCalendar=[...this.bookingsCurrent.map(r=>{let d;switch(r.course.course_type){case 1:d="collective";break;case 2:d="private";break;default:d="unknown"}const _=2===r.course.course_type?{date_total:0,date_index:0}:{date_total:r.course.course_dates.length,date_index:this.getPositionDate(r.course.course_dates,r.course_date_id)},u=this.sports.find(m=>m.id===r.course.sport_id);return{booking_id:r.id,date:p(r.date).format("YYYY-MM-DD"),hour_start:r.hour_start.substring(0,5),hour_end:r.hour_end.substring(0,5),type:d,name:r.course.name,sport_id:r.course.sport_id,sport_name:u?u.name:"",clients:r.all_clients.length,max_participants:r.course.max_participants,..._}}),...c.map(r=>{const d=r.full_day?{hour_start:this.hourStartDay,hour_end:this.hourEndDay}:{hour_start:r.start_time.substring(0,5),hour_end:r.end_time.substring(0,5)};return{school_id:r.school_id,block_id:r.id,date:p(r.start_date).format("YYYY-MM-DD"),full_day:r.full_day,type:1==r.user_nwd_subtype_id?"block":"block_payed",color:2==r.user_nwd_subtype_id?r.color:"#89add1",name:r.description,...d}})],this.updateTasksWithStyles(),this.spinnerService.hide()}getPositionDate(n,i){const o=n.findIndex(c=>c.id===i);return o>=0?o+1:0}getTaskStyle(n,i=!1){let o=i?n.styleWeek:n.style;return"block"===n.type||"block_payed"===n.type?{...o,background:n.color}:o}toggleMenu(){this.menuService.toggleMenu()}generateHoursRange(){var n=this;return(0,y.Z)(function*(){const i=n.parseTime(n.hourStartDay),o=n.parseTime(n.hourEndDay);let c=new Date(i);for(;c<=o;)n.hoursRange.push(n.formatTime(c)),c.setHours(c.getHours()+1)})()}parseTime(n){const[i,o]=n.split(":").map(Number),c=new Date;return c.setHours(i,o,0,0),c}formatTime(n){return n.toTimeString().substring(0,5)}previousMonth(){let n=p(this.selectedDate);n.subtract(1,"months"),this.selectedDate=n.toDate(),this.currentDay=this.selectedDate.getDate(),this.currentMonth--,this.currentMonth<0&&(this.currentMonth=11,this.currentYear--),this.restartTasks()}nextMonth(){let n=p(this.selectedDate);n.add(1,"months"),this.selectedDate=n.toDate(),this.currentDay=this.selectedDate.getDate(),this.currentMonth++,this.currentMonth>11&&(this.currentMonth=0,this.currentYear++),this.restartTasks()}calculateMonthRange(){this.restartTasks()}previousDay(){this.selectedDate.setDate(this.selectedDate.getDate()-1),this.currentMonth=this.selectedDate.getMonth(),this.currentYear=this.selectedDate.getFullYear(),this.currentDay=this.selectedDate.getDate();const n=p(this.selectedDate).format("YYYY-MM-DD");this.restartTasksRange(n,n)}nextDay(){this.selectedDate.setDate(this.selectedDate.getDate()+1),this.currentMonth=this.selectedDate.getMonth(),this.currentYear=this.selectedDate.getFullYear(),this.currentDay=this.selectedDate.getDate();const n=p(this.selectedDate).format("YYYY-MM-DD");this.restartTasksRange(n,n)}calculateDayRange(){const n=p(this.selectedDate).format("YYYY-MM-DD");this.currentMonth=this.selectedDate.getMonth(),this.currentYear=this.selectedDate.getFullYear(),this.restartTasksRange(n,n)}previousWeek(){this.selectedDate.setDate(this.selectedDate.getDate()-7),this.currentDay=this.selectedDate.getDate(),this.calculateWeekRange()}nextWeek(){this.selectedDate.setDate(this.selectedDate.getDate()+7),this.currentDay=this.selectedDate.getDate(),this.calculateWeekRange()}calculateWeekRange(){const n=this.selectedDate.getDay(),i=0===n?6:n-1;this.weekStart=new Date(this.selectedDate),this.weekStart.setDate(this.selectedDate.getDate()-i),this.weekStart.setHours(0,0,0,0),this.weekEnd=new Date(this.weekStart),this.weekEnd.setDate(this.weekStart.getDate()+6),this.weekEnd.setHours(0,0,0,0),this.currentMonth=this.weekEnd.getMonth(),this.currentYear=this.weekEnd.getFullYear();const o=p(this.weekStart).format("YYYY-MM-DD"),c=p(this.weekEnd).format("YYYY-MM-DD");this.restartTasksRange(o,c)}renderCalendar(){this.spinnerService.show();const n=new Date(this.currentYear,this.currentMonth,1).getDay(),i=new Date(this.currentYear,this.currentMonth+1,0).getDate();this.days=[];let o=n-1;o<0&&(o=6);for(let h=0;h<o;h++)this.days.push({number:"",active:!1});const c=new Date;c.setHours(0,0,0,0);const r=c.getDate(),d=c.getMonth(),_=c.getFullYear();for(let h=1;h<=i;h++){const f=new Date(this.currentYear,this.currentMonth,h);f.setHours(0,0,0,0);const T=f<c,C=`${this.currentMonth+1}`.padStart(2,"0"),O=`${h}`.padStart(2,"0"),x=`${this.currentYear}-${C}-${O}`,U=h===r&&this.currentMonth===d&&this.currentYear===_,M=this.tasksCalendar.reduce((g,b)=>(b.date===x&&(g.isPrivate=g.isPrivate||"private"===b.type,g.isCollective=g.isCollective||"collective"===b.type,g.isOther=g.isOther||"other"===b.type,g.isBlock=g.isBlock||"block"===b.type,g.isBlockPayed=g.isBlockPayed||"block_payed"===b.type),g),{isPrivate:!1,isCollective:!1,isOther:!1,isBlock:!1,isBlockPayed:!1});this.days.push({number:h,selected:!1,past:T,today:U,private:M.isPrivate,collective:M.isCollective,other:M.isOther,block:M.isBlock,blockPayed:M.isBlockPayed})}let u=new Date(this.currentYear,this.currentMonth,i).getDay();for(let h=u;h<=6&&6!==u;h++)this.days.push({number:"",active:!1,selected:!1,today:!1});const m=`${this.currentMonth+1}`.padStart(2,"0"),N=`${this.currentDay}`.padStart(2,"0"),I=`${this.currentYear}-${m}-${N}`;this.filteredTasks=this.tasksCalendar.filter(h=>h.date===I),this.filteredTasksWeek=this.tasksCalendar.filter(h=>{const f=new Date(h.date);return f.setHours(0,0,0,0),f>=this.weekStart&&f<=this.weekEnd}),this.spinnerService.hide()}selectDay(n){if(n.number){this.selectedDate=new Date(this.currentYear,this.currentMonth,n.number),this.currentDay=n.number,this.calculateDayRange(),this.showDay=!0,this.showMonth=!1,this.showWeek=!1;const i=`${this.currentMonth+1}`.padStart(2,"0"),o=`${this.currentDay}`.padStart(2,"0"),c=`${this.currentYear}-${i}-${o}`;this.filteredTasks=this.tasksCalendar.filter(r=>r.date===c)}}getWeekdayName(n){return this.weekdayNames[n.getDay()]}getWeekRangeDisplay(){const n=this.monthNames[this.weekEnd.getMonth()];return`${this.weekStart.getDate()}-${this.weekEnd.getDate()} ${n} ${this.weekEnd.getFullYear()}`}updateTasksWithStyles(){var n=this;return(0,y.Z)(function*(){const d={0:"85.5%",1:"0%",2:"14.25%",3:"28.5%",4:"42.75%",5:"57%",6:"71.25%"};n.tasksCalendar=n.tasksCalendar.map(_=>{const u=n.getDayOfWeek(_.date),m=n.parseTime(_.hour_start),N=n.parseTime(_.hour_end),f=11+57*(m.getHours()-parseInt(n.hourStartDay.split(":")[0],10))+m.getMinutes()/60*54,T=N.getTime()-m.getTime(),C=Math.floor(T/36e5),O=T%36e5/6e4;let x=0;x=C<=1?54*C+57*O/60:54+57*(C-1)+57*O/60;const U=d[u.toString()];return{..._,style:{top:`${f}px`,height:`${x}px`},styleWeek:{top:`${f}px`,height:`${x}px`,left:U}}}),n.renderCalendar()})()}getDayOfWeek(n){return new Date(n).getDay()}getIconForTaskType(n){switch(n){case"collective":return"assets/icon/course-collective-icon.png";case"private":return"assets/icon/course-private-icon.png";case"other":return"assets/icon/course-other-icon.png"}}openAvailables(n,i){n&&i?this.goTo("calendar-available","day",i,n):this.showDay?this.goTo("calendar-available","day",p(this.selectedDate).format("YYYY-MM-DD")):this.goTo("calendar-available")}goTo(...n){this.router.navigate(n)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}return(a=s).\u0275fac=function(n){return new(n||a)(t.Y36(k.F0),t.Y36(P.h),t.Y36(S.q),t.Y36($.g),t.Y36(W.b),t.Y36(F._W),t.Y36(H.V),t.Y36(A.sK))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-calendar"]],decls:30,vars:33,consts:[[1,"content-size","content-background-image"],[1,"background-color-dark","padding-wrapper","status-bar-overlap-wrapper"],[1,"header-section-content","mb-12"],[1,"header-section-title"],["src","assets/icon/icons-outline-calendar-1-blue.svg"],["src","assets/icon/icon-menu.png",1,"header-section-menu","cursor-pointer",3,"click"],[1,"mt-24","mb-32","flex-buttons"],[1,"montserrat","flex-buttons-button","cursor-pointer",3,"ngClass","click"],["class","flex-members",4,"ngIf"],["class","padding-wrapper",4,"ngIf"],[1,"montserrat","button-floating","btn-back-primary","uppercase",3,"click"],["section","calendar"],[1,"flex-members"],[1,"box-arrow","cursor-pointer",3,"click"],["src","assets/icon/arrow-left.svg"],[1,"montserrat","month-title"],["src","assets/icon/icons-outline-arrow-right-3-white.svg"],[1,"padding-wrapper"],[1,"calendar","mb-24","background-color-dark"],[1,"weekdays"],["class","montserrat uppercase",4,"ngFor","ngForOf"],[1,"days"],[4,"ngFor","ngForOf"],[1,"montserrat","uppercase"],[1,"montserrat","day-span-a",3,"ngClass","click"],[1,"day-span-b","cursor-pointer","position-relative"],[1,"day-on-top"],["class","active-today",4,"ngIf"],["class","top-position-bar private-calendar full-position",4,"ngIf"],["class","top-position-bar collective-calendar full-position",4,"ngIf"],["class","top-position-bar other-calendar full-position",4,"ngIf"],["class","top-position-bar private-calendar half-position left-border left-half",4,"ngIf"],["class","top-position-bar collective-calendar half-position right-border right-half",4,"ngIf"],["class","top-position-bar other-calendar half-position right-border right-half",4,"ngIf"],["class","top-position-bar collective-calendar half-position left-border left-half",4,"ngIf"],["class","top-position-bar private-calendar third-position left-border left-third",4,"ngIf"],["class","top-position-bar collective-calendar third-position middle-border middle-third",4,"ngIf"],["class","top-position-bar other-calendar third-position right-border right-third",4,"ngIf"],["class","block-calendar full-position",3,"ngClass",4,"ngIf"],["class","block-payed-calendar full-position",3,"ngClass",4,"ngIf"],["class","block-calendar half-position left-border left-half",3,"ngClass",4,"ngIf"],["class","block-payed-calendar half-position right-border right-half",3,"ngClass",4,"ngIf"],[1,"active-today"],[1,"top-position-bar","private-calendar","full-position"],[1,"top-position-bar","collective-calendar","full-position"],[1,"top-position-bar","other-calendar","full-position"],[1,"top-position-bar","private-calendar","half-position","left-border","left-half"],[1,"top-position-bar","collective-calendar","half-position","right-border","right-half"],[1,"top-position-bar","other-calendar","half-position","right-border","right-half"],[1,"top-position-bar","collective-calendar","half-position","left-border","left-half"],[1,"top-position-bar","private-calendar","third-position","left-border","left-third"],[1,"top-position-bar","collective-calendar","third-position","middle-border","middle-third"],[1,"top-position-bar","other-calendar","third-position","right-border","right-third"],[1,"block-calendar","full-position",3,"ngClass"],[1,"block-payed-calendar","full-position",3,"ngClass"],[1,"block-calendar","half-position","left-border","left-half",3,"ngClass"],[1,"block-payed-calendar","half-position","right-border","right-half",3,"ngClass"],[1,"background-color-dark","week-calendar-wrapper","mt-24"],[1,"week-calendar-days"],["class","color-light",4,"ngFor","ngForOf"],[1,"week-calendar-b"],[1,"hour-section"],["class","montserrat color-light hour-data",4,"ngFor","ngForOf"],[1,"task-section"],["class","task-data",4,"ngFor","ngForOf"],[3,"ngClass","ngStyle","click",4,"ngFor","ngForOf"],[1,"color-light"],[1,"montserrat","color-light","hour-data"],[1,"task-data"],[3,"ngClass","ngStyle","click"],[1,"task-icon-only",3,"src"],[1,"background-color-dark","week-calendar","mt-24"],["class","task-content",4,"ngIf"],["class","task-content-block",4,"ngIf"],[1,"task-content"],["src","assets/icon/course-collective-icon.png",1,"task-content-img"],[1,"task-content-text"],[1,"montserrat"],[1,"montserrat","color-light"],[4,"ngIf"],[1,"task-content-icon-list"],[1,"task-content-icon"],["src","assets/icon/icon-user-tick.png"],["src","assets/icon/icon-calendar-tick.png"],["src","assets/icon/course-private-icon.png",1,"task-content-img"],["src","assets/icon/course-other-icon.png",1,"task-content-img"],[1,"task-content-block"]],template:function(n,i){1&n&&(t.TgZ(0,"ion-content")(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3),t._UZ(5,"img",4),t.TgZ(6,"div"),t._uU(7),t.ALo(8,"translate"),t.qZA()(),t.TgZ(9,"img",5),t.NdJ("click",function(){return i.toggleMenu()}),t.qZA()(),t.TgZ(10,"div",6)(11,"div",7),t.NdJ("click",function(){return i.calculateMonthRange(),i.showMonth=!0,i.showWeek=!1,i.showDay=!1}),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"div",7),t.NdJ("click",function(){return i.calculateWeekRange(),i.showMonth=!1,i.showWeek=!0,i.showDay=!1}),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"div",7),t.NdJ("click",function(){return i.calculateDayRange(),i.showMonth=!1,i.showWeek=!1,i.showDay=!0}),t._uU(18),t.ALo(19,"translate"),t.qZA()(),t.YNc(20,R,7,2,"div",8),t.YNc(21,q,7,1,"div",8),t.YNc(22,j,7,4,"div",8),t.qZA(),t.YNc(23,gt,6,2,"div",9),t.YNc(24,mt,10,4,"div",9),t.YNc(25,Yt,7,3,"div",9),t.qZA(),t.TgZ(26,"div",10),t.NdJ("click",function(){return i.openAvailables()}),t._uU(27),t.ALo(28,"translate"),t.qZA()(),t._UZ(29,"app-footer",11)),2&n&&(t.xp6(7),t.Oqu(t.lcZ(8,14,"diary")),t.xp6(4),t.Q6J("ngClass",t.WLB(24,J,i.showMonth,!i.showMonth)),t.xp6(1),t.hij(" ",t.lcZ(13,16,"month")," "),t.xp6(2),t.Q6J("ngClass",t.WLB(27,J,i.showWeek,!i.showWeek)),t.xp6(1),t.hij(" ",t.lcZ(16,18,"week")," "),t.xp6(2),t.Q6J("ngClass",t.WLB(30,J,i.showDay,!i.showDay)),t.xp6(1),t.hij(" ",t.lcZ(19,20,"day")," "),t.xp6(2),t.Q6J("ngIf",i.showMonth),t.xp6(1),t.Q6J("ngIf",i.showWeek),t.xp6(1),t.Q6J("ngIf",i.showDay),t.xp6(1),t.Q6J("ngIf",i.showMonth),t.xp6(1),t.Q6J("ngIf",i.showWeek),t.xp6(1),t.Q6J("ngIf",i.showDay),t.xp6(2),t.hij(" ",t.lcZ(28,22,"availability")," "))},dependencies:[v.mk,v.sg,v.O5,v.PC,w.W2,E.c,A.X$],styles:[".content-size[_ngcontent-%COMP%]{width:100%;min-height:100%}.padding-wrapper[_ngcontent-%COMP%]{padding:20px 16px}.header-section-content[_ngcontent-%COMP%]{position:relative;top:0;left:0;width:100%;display:flex;align-items:center;justify-content:center}.header-section-title[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center;justify-content:center}.header-section-title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:24px}.header-section-title[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{color:#fff;font-size:16px;font-weight:600}.header-section-menu[_ngcontent-%COMP%]{position:absolute;right:0;top:50%;transform:translateY(-50%);width:22px;display:flex;align-items:center;justify-content:center}.month-title[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:500}.flex-members[_ngcontent-%COMP%]{display:flex;width:100%;align-items:center;justify-content:space-between}.box-arrow[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:8px;display:flex;align-items:center;justify-content:center;background:#2b303b}.box-arrow[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:22px}.filter-floating[_ngcontent-%COMP%]{width:54px;position:fixed;right:12px;bottom:102px;cursor:pointer}.button-floating[_ngcontent-%COMP%]{position:fixed;right:12px;bottom:102px;cursor:pointer;display:flex;align-items:center;justify-content:center;padding:12px 24px;border-radius:40px;width:-moz-fit-content;width:fit-content;font-weight:600;font-size:14px}.flex-buttons[_ngcontent-%COMP%]{display:flex;width:100%;align-items:center;gap:4px}.flex-buttons-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-size:14px;width:100%;padding:6px 0;border-radius:4px}.calendar[_ngcontent-%COMP%]{color:#fff;width:100%;box-sizing:border-box;padding:16px;border-radius:8px}.header-calendar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px}.header-calendar[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:18px;font-weight:500}.header-calendar-arrows[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.header-calendar-arrows[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{cursor:pointer;width:24px}.weekdays[_ngcontent-%COMP%], .days[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.weekdays[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1 0 calc(14.28% - 6px);height:40px;line-height:4px;text-align:center;margin:3px;font-size:11px;box-sizing:border-box}.days[_ngcontent-%COMP%]   .day-span-a[_ngcontent-%COMP%]{flex:1 0 calc(14.28% - 6px);height:40px;line-height:40px;text-align:center;margin:3px;font-size:16px!important;font-weight:500;box-sizing:border-box}.days[_ngcontent-%COMP%]   .day-span-b[_ngcontent-%COMP%]{display:flex;justify-content:center;width:32px;height:32px;align-items:center}.light-opacity[_ngcontent-%COMP%]{opacity:.6}.very-light-opacity[_ngcontent-%COMP%]{opacity:.4}.day-on-top[_ngcontent-%COMP%]{z-index:2}.active-calendar[_ngcontent-%COMP%]{width:8px;height:8px;border-radius:8px;background:var(--ion-color-primary);position:absolute;bottom:-7px;left:50%;transform:translate(-50%)}.top-position-bar[_ngcontent-%COMP%]{height:5px;border-radius:8px;position:absolute;bottom:2px;left:50%;transform:translate(-50%)}.bottom-position-bar[_ngcontent-%COMP%]{height:5px;border-radius:8px;position:absolute;bottom:-5px;left:50%;transform:translate(-50%)}.full-position[_ngcontent-%COMP%]{width:30px}.half-position[_ngcontent-%COMP%]{width:15px}.third-position[_ngcontent-%COMP%]{width:10px}.block-calendar[_ngcontent-%COMP%]{background:#89add1}.block-payed-calendar[_ngcontent-%COMP%]{background:#945db3}.private-calendar[_ngcontent-%COMP%]{background:rgb(42,201,64)}.collective-calendar[_ngcontent-%COMP%]{background:rgb(251,153,23)}.other-calendar[_ngcontent-%COMP%]{background:rgb(241,36,120)}.left-border[_ngcontent-%COMP%]{border-radius:8px 0 0 8px!important}.right-border[_ngcontent-%COMP%]{border-radius:0 8px 8px 0!important}.middle-border[_ngcontent-%COMP%]{border-radius:0!important}.left-half[_ngcontent-%COMP%]{transform:translate(-100%)}.right-half[_ngcontent-%COMP%]{transform:translate(0)}.left-third[_ngcontent-%COMP%]{transform:translate(-150%)}.right-third[_ngcontent-%COMP%]{transform:translate(50%)}.block-half[_ngcontent-%COMP%]{width:16px;transform:translate(-100%);border-radius:8px 0 0 8px}.block-payed-half[_ngcontent-%COMP%]{width:16px;transform:translate(0);border-radius:0 8px 8px 0}.active-today[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:28px;background:var(--ion-color-primary);position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:0}.active-collective[_ngcontent-%COMP%]{opacity:1;background-color:#d9b12099;border-radius:50%;cursor:pointer;transition:all .2s ease-in-out}.active-collective-selected[_ngcontent-%COMP%]{opacity:1;background-color:#d9b120;border-radius:50%;cursor:pointer;transition:all .2s ease-in-out}.active-private[_ngcontent-%COMP%]{opacity:1;background-color:#c2d94599;border-radius:50%;cursor:pointer;transition:all .2s ease-in-out}.active-private-selected[_ngcontent-%COMP%]{opacity:1;background-color:#c2d945;border-radius:50%;cursor:pointer;transition:all .2s ease-in-out}.week-calendar[_ngcontent-%COMP%]{width:100%;border-radius:8px;padding:16px;display:flex;align-items:flex-start}.week-calendar-wrapper[_ngcontent-%COMP%]{width:100%;border-radius:8px;padding:16px}.week-calendar-b[_ngcontent-%COMP%]{width:100%;display:flex;align-items:flex-start}.week-calendar-days[_ngcontent-%COMP%]{width:100%;padding-left:58px;display:block;text-align:center}.week-calendar-days[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:inline-block;width:14.25%;font-size:14px;text-align:center;height:40px;line-height:40px}.hour-section[_ngcontent-%COMP%]{width:58px;min-width:58px}.hour-data[_ngcontent-%COMP%]{font-size:14px;text-align:left;margin-bottom:40px}.task-section[_ngcontent-%COMP%]{width:100%;position:relative}.task-data[_ngcontent-%COMP%]{width:100%;border-bottom:1px solid #444953;height:10px;margin-bottom:47px}.collective-icon-only[_ngcontent-%COMP%]{position:absolute;width:calc(14.25% - 4px);background:rgba(251,153,23,.3);border:1px solid rgba(251,153,23,.6);border-radius:8px;cursor:pointer}.private-icon-only[_ngcontent-%COMP%]{position:absolute;width:calc(14.25% - 4px);background:rgba(42,201,64,.3);border:1px solid rgba(42,201,64,.6);border-radius:8px;cursor:pointer}.other-icon-only[_ngcontent-%COMP%]{position:absolute;width:calc(14.25% - 4px);background:rgba(241,36,120,.3);border:1px solid rgba(241,36,120,.6);border-radius:8px;cursor:pointer}.block-icon-only[_ngcontent-%COMP%], .block-payed-icon-only[_ngcontent-%COMP%]{position:absolute;width:calc(14.25% - 4px);border-radius:8px;cursor:pointer}.collective-icon-full[_ngcontent-%COMP%]{position:absolute;width:100%;background:rgba(251,153,23,.3);border:1px solid rgba(251,153,23,.6);border-radius:8px;cursor:pointer}.private-icon-full[_ngcontent-%COMP%]{position:absolute;width:100%;background:rgba(42,201,64,.3);border:1px solid rgba(42,201,64,.6);border-radius:8px;cursor:pointer}.other-icon-full[_ngcontent-%COMP%]{position:absolute;width:100%;background:rgba(241,36,120,.3);border:1px solid rgba(241,36,120,.6);border-radius:8px;cursor:pointer}.block-icon-full[_ngcontent-%COMP%], .block-payed-icon-full[_ngcontent-%COMP%]{position:absolute;width:100%;border-radius:8px;cursor:pointer}.task-content-block[_ngcontent-%COMP%]{background:rgba(7,10,14,.7);position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:13px;color:#fff;font-weight:500;text-align:center;padding:8px 16px;border-radius:8px;max-width:220px;width:80%}.task-icon-only[_ngcontent-%COMP%]{height:20px;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.task-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;position:absolute;top:50%;padding:0 14px 0 12px;transform:translateY(-50%);width:100%}.task-content-img[_ngcontent-%COMP%]{height:20px}.task-content-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:3px}.task-content-text[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:14px;color:#fff}.task-content-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px}.task-content-icon-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.task-content-icon[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.task-content-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:18px}.task-content-icon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px}"]}),s})()}];let At=(()=>{var a;class s{}return(a=s).\u0275fac=function(n){return new(n||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[k.Bz.forChild(St),k.Bz]}),s})();var Jt=l(822);let Nt=(()=>{var a;class s{}return(a=s).\u0275fac=function(n){return new(n||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[v.ez,Z.u5,w.Pc,At,Jt.K,A.aw]}),s})()},4036:(Q,D,l)=>{l.d(D,{z:()=>w});var v=l(6973),Z=l(305);function w(k,y){const Y="object"==typeof y;return new Promise((p,t)=>{const P=new Z.Hp({next:S=>{p(S),P.unsubscribe()},error:t,complete:()=>{Y?p(y.defaultValue):t(new v.K)}});k.subscribe(P)})}}}]);