(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6686],{6110:(Y,j,H)=>{"use strict";H.d(j,{P:()=>E});var L=H(467),t=H(6996),F=H(5083),G=function(l){return l.Prompt="PROMPT",l.Camera="CAMERA",l.Photos="PHOTOS",l}(G||{}),y=function(l){return l.Rear="REAR",l.Front="FRONT",l}(y||{}),B=function(l){return l.Uri="uri",l.Base64="base64",l.DataUrl="dataUrl",l}(B||{});class i extends F.E_{getPhoto(o){var b=this;return(0,L.A)(function*(){return new Promise(function(){var h=(0,L.A)(function*(u,s){if(o.webUseInput||o.source===G.Photos)b.fileInputExperience(o,u,s);else if(o.source===G.Prompt){let w=document.querySelector("pwa-action-sheet");w||(w=document.createElement("pwa-action-sheet"),document.body.appendChild(w)),w.header=o.promptLabelHeader||"Photo",w.cancelable=!1,w.options=[{title:o.promptLabelPhoto||"From Photos"},{title:o.promptLabelPicture||"Take Picture"}],w.addEventListener("onSelection",function(){var x=(0,L.A)(function*(C){0===C.detail?b.fileInputExperience(o,u,s):b.cameraExperience(o,u,s)});return function(C){return x.apply(this,arguments)}}())}else b.cameraExperience(o,u,s)});return function(u,s){return h.apply(this,arguments)}}())})()}pickImages(o){var b=this;return(0,L.A)(function*(){return new Promise(function(){var h=(0,L.A)(function*(u,s){b.multipleFileInputExperience(u,s)});return function(u,s){return h.apply(this,arguments)}}())})()}cameraExperience(o,b,h){var u=this;return(0,L.A)(function*(){if(customElements.get("pwa-camera-modal")){const s=document.createElement("pwa-camera-modal");s.facingMode=o.direction===y.Front?"user":"environment",document.body.appendChild(s);try{yield s.componentOnReady(),s.addEventListener("onPhoto",function(){var w=(0,L.A)(function*(x){const C=x.detail;null===C?h(new F.I9("User cancelled photos app")):C instanceof Error?h(C):b(yield u._getCameraPhoto(C,o)),s.dismiss(),document.body.removeChild(s)});return function(x){return w.apply(this,arguments)}}()),s.present()}catch{u.fileInputExperience(o,b,h)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),u.fileInputExperience(o,b,h)})()}fileInputExperience(o,b,h){let u=document.querySelector("#_capacitor-camera-input");const s=()=>{var w;null===(w=u.parentNode)||void 0===w||w.removeChild(u)};u||(u=document.createElement("input"),u.id="_capacitor-camera-input",u.type="file",u.hidden=!0,document.body.appendChild(u),u.addEventListener("change",w=>{const x=u.files[0];let C="jpeg";if("image/png"===x.type?C="png":"image/gif"===x.type&&(C="gif"),"dataUrl"===o.resultType||"base64"===o.resultType){const R=new FileReader;R.addEventListener("load",()=>{if("dataUrl"===o.resultType)b({dataUrl:R.result,format:C});else if("base64"===o.resultType){const M=R.result.split(",")[1];b({base64String:M,format:C})}s()}),R.readAsDataURL(x)}else b({webPath:URL.createObjectURL(x),format:C}),s()}),u.addEventListener("cancel",w=>{h(new F.I9("User cancelled photos app")),s()})),u.accept="image/*",u.capture=!0,o.source===G.Photos||o.source===G.Prompt?u.removeAttribute("capture"):o.direction===y.Front?u.capture="user":o.direction===y.Rear&&(u.capture="environment"),u.click()}multipleFileInputExperience(o,b){let h=document.querySelector("#_capacitor-camera-input-multiple");const u=()=>{var s;null===(s=h.parentNode)||void 0===s||s.removeChild(h)};h||(h=document.createElement("input"),h.id="_capacitor-camera-input-multiple",h.type="file",h.hidden=!0,h.multiple=!0,document.body.appendChild(h),h.addEventListener("change",s=>{const w=[];for(let x=0;x<h.files.length;x++){const C=h.files[x];let R="jpeg";"image/png"===C.type?R="png":"image/gif"===C.type&&(R="gif"),w.push({webPath:URL.createObjectURL(C),format:R})}o({photos:w}),u()}),h.addEventListener("cancel",s=>{b(new F.I9("User cancelled photos app")),u()})),h.accept="image/*",h.click()}_getCameraPhoto(o,b){return new Promise((h,u)=>{const s=new FileReader,w=o.type.split("/")[1];"uri"===b.resultType?h({webPath:URL.createObjectURL(o),format:w,saved:!1}):(s.readAsDataURL(o),s.onloadend=()=>{const x=s.result;h("dataUrl"===b.resultType?{dataUrl:x,format:w,saved:!1}:{base64String:x.split(",")[1],format:w,saved:!1})},s.onerror=x=>{u(x)})})}checkPermissions(){var o=this;return(0,L.A)(function*(){if(typeof navigator>"u"||!navigator.permissions)throw o.unavailable("Permissions API not available in this browser");try{return{camera:(yield window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw o.unavailable("Camera permissions are not available in this browser")}})()}requestPermissions(){var o=this;return(0,L.A)(function*(){throw o.unimplemented("Not implemented on web.")})()}pickLimitedLibraryPhotos(){var o=this;return(0,L.A)(function*(){throw o.unavailable("Not implemented on web.")})()}getLimitedLibraryPhotos(){var o=this;return(0,L.A)(function*(){throw o.unavailable("Not implemented on web.")})()}}new i;const A=(0,F.F3)("Camera",{web:()=>new i});var c=H(101),e=H(177),r=H(1547);function _(l,o){if(1&l){const b=t.RV6();t.j41(0,"button",7),t.bIt("click",function(){t.eBV(b),t.XpG();const u=t.sdS(17);return t.Njj(u.click())}),t.EFF(1),t.nI1(2,"translate"),t.k0s()}2&l&&(t.R7$(1),t.JRh(t.bMT(2,1,"record_video")))}function f(l,o){if(1&l&&t.nrm(0,"img",20),2&l){const b=t.XpG(2);t.Y8G("src",b.filePreview,t.B4B)}}function d(l,o){if(1&l&&t.nrm(0,"video",21),2&l){const b=t.XpG(2);t.Y8G("src",b.filePreview,t.B4B)}}function m(l,o){1&l&&(t.j41(0,"div",22),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&l&&(t.R7$(1),t.SpI(" ",t.bMT(2,1,"tap_to_play")," "))}function v(l,o){if(1&l){const b=t.RV6();t.j41(0,"div",14)(1,"div",15),t.DNE(2,f,1,1,"img",16),t.DNE(3,d,1,1,"video",17),t.DNE(4,m,3,3,"div",18),t.k0s(),t.j41(5,"button",19),t.bIt("click",function(){t.eBV(b);const u=t.XpG();return t.Njj(u.saveFile())}),t.EFF(6),t.nI1(7,"translate"),t.k0s()()}if(2&l){const b=t.XpG();t.R7$(2),t.Y8G("ngIf",!b.isVideo),t.R7$(1),t.Y8G("ngIf",b.isVideo),t.R7$(1),t.Y8G("ngIf",b.isVideo),t.R7$(2),t.JRh(t.bMT(7,4,"save"))}}let E=(()=>{var l;class o{constructor(){this.title="T\xe9l\xe9verser un fichier",this.allowImage=!0,this.allowVideo=!0,this.isVideo=!1,this.close=new t.bkB,this.fileSelected=new t.bkB}onFileSelected(h){const u=h.target;if(u.files&&u.files.length>0){const s=u.files[0];this.isVideo=s.type.startsWith("video"),this.isVideo?this.previewVideo(s):this.resizeAndPreviewImage(s)}}onVideoSelected(h){const u=h.target;if(u.files&&u.files.length>0){const s=u.files[0];this.isVideo=!0,this.previewVideo(s)}}openCamera(){var h=this;return(0,L.A)(function*(){try{const u=yield A.getPhoto({quality:90,allowEditing:!1,resultType:B.Uri,source:G.Camera});if(h.isVideo="video"===u.format,h.isVideo)h.filePreview=u.webPath,h.fileResult={base64:u.webPath,isVideo:!0};else{const s=yield fetch(u.webPath).then(w=>w.blob());h.resizeAndPreviewImage(s)}}catch(u){console.error("Error accessing camera or gallery",u)}})()}resizeAndPreviewImage(h){this.resizeImage(h,600).then(s=>{this.filePreview=s,this.fileResult={base64:s,isVideo:!1}}).catch(s=>{console.error("Error resizing image:",s)})}previewVideo(h){const u=new FileReader;u.onload=()=>{this.filePreview=u.result,this.fileResult={base64:u.result,isVideo:!0}},u.readAsDataURL(h)}saveFile(){this.fileResult&&(this.fileSelected.emit(this.fileResult),this.close.emit())}doCloseModal(){this.close.emit()}get acceptTypes(){let h="";return this.allowImage&&(h+="image/*"),this.allowVideo&&(h+=this.allowImage?",video/*":"video/*"),h}resizeImage(h,u){return new Promise((s,w)=>{const x="image/png"===h.type,R=["image/png","image/gif","image/avif","image/bmp","image/tiff","image/ico","image/heic"].includes(h.type)?"image/jpeg":h.type||"image/jpeg",M=new FileReader;M.onload=S=>{const U=new Image;U.src=S.target.result,U.onload=()=>{let a=U.width,p=U.height;if(a>u||p>u)if(a>p){const I=u/a;a=u,p*=I}else{const I=u/p;p=u,a*=I}const g=document.createElement("canvas");if(g.width=a,g.height=p,x){const I=g.getContext("2d");I.fillStyle="white",I.fillRect(0,0,g.width,g.height)}const Q=document.createElement("canvas");Q.width=a,Q.height=p,c().resize(U,Q).then(I=>(g.getContext("2d").drawImage(Q,0,0,a,p),c().toBlob(g,R,.6))).then(I=>{const k=new FileReader;k.onloadend=()=>s(k.result),k.readAsDataURL(I)}).catch(w)}},M.readAsDataURL(h)})}}return(l=o).\u0275fac=function(h){return new(h||l)},l.\u0275cmp=t.VBU({type:l,selectors:[["app-file-upload"]],inputs:{title:"title",allowImage:"allowImage",allowVideo:"allowVideo"},outputs:{close:"close",fileSelected:"fileSelected"},decls:20,vars:10,consts:[[1,"modal"],[1,"modal-content","content-background-image"],["src","assets/icon/icons-outline-close.svg",1,"cursor-pointer","modal-close",3,"click"],[1,"title-upload","mt-24","mb-24"],[1,"file-upload"],["type","file",2,"display","none",3,"accept","change"],["fileInput",""],[1,"content-button","btn-back-grey","montserrat",3,"click"],[1,"camera-upload","mt-12"],[1,"file-upload","mt-12"],["type","file","accept","video/*","capture","user",2,"display","none",3,"change"],["videoInput",""],["class","content-button btn-back-grey montserrat",3,"click",4,"ngIf"],["class","mt-24 mb-32",4,"ngIf"],[1,"mt-24","mb-32"],[1,"preview-wrapper"],["class","preview",3,"src",4,"ngIf"],["class","preview","controls","","playsinline","",3,"src",4,"ngIf"],["class","preview-hint",4,"ngIf"],[1,"content-button","btn-back-primary","montserrat","mt-24",3,"click"],[1,"preview",3,"src"],["controls","","playsinline","",1,"preview",3,"src"],[1,"preview-hint"]],template:function(h,u){if(1&h){const s=t.RV6();t.j41(0,"div",0)(1,"div",1)(2,"img",2),t.bIt("click",function(){return u.doCloseModal()}),t.k0s(),t.j41(3,"div",3),t.EFF(4),t.k0s(),t.j41(5,"div",4)(6,"input",5,6),t.bIt("change",function(x){return u.onFileSelected(x)}),t.k0s(),t.j41(8,"button",7),t.bIt("click",function(){t.eBV(s);const x=t.sdS(7);return t.Njj(x.click())}),t.EFF(9),t.nI1(10,"translate"),t.k0s()(),t.j41(11,"div",8)(12,"button",7),t.bIt("click",function(){return u.openCamera()}),t.EFF(13),t.nI1(14,"translate"),t.k0s()(),t.j41(15,"div",9)(16,"input",10,11),t.bIt("change",function(x){return u.onVideoSelected(x)}),t.k0s(),t.DNE(18,_,3,3,"button",12),t.k0s(),t.DNE(19,v,8,6,"div",13),t.k0s()()}2&h&&(t.R7$(4),t.JRh(u.title),t.R7$(2),t.Y8G("accept",u.acceptTypes),t.R7$(3),t.JRh(t.bMT(10,6,"choose_file")),t.R7$(4),t.JRh(t.bMT(14,8,"use_camera")),t.R7$(5),t.Y8G("ngIf",u.allowVideo),t.R7$(1),t.Y8G("ngIf",u.filePreview))},dependencies:[e.bT,r.D9],styles:[".modal[_ngcontent-%COMP%]{width:100%;height:100vh;min-height:100vh;max-height:100vh;z-index:999;background:rgba(0,0,0,.7);position:fixed;top:0;left:0}.modal-content[_ngcontent-%COMP%]{width:80%;max-width:300px;padding:20px 16px;position:relative;z-index:1000;left:50%;top:50%;transform:translate(-50%,-50%);border-radius:8px;text-align:center}.modal-close[_ngcontent-%COMP%]{width:28px;position:absolute;top:8px;right:8px}.title-upload[_ngcontent-%COMP%]{font-size:17px;font-weight:500}.content-button[_ngcontent-%COMP%]{width:100%;height:44px;line-height:44px;display:block;border-radius:44px;color:#000;text-align:center;font-size:14px;font-weight:500;cursor:pointer;transition:all ease-in-out .3s}.preview[_ngcontent-%COMP%]{max-width:100%;max-height:300px}.preview-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;border-radius:12px;overflow:hidden;background:rgba(0,0,0,.2);padding:8px}.preview-wrapper[_ngcontent-%COMP%]   video.preview[_ngcontent-%COMP%]{background:#000}.preview-hint[_ngcontent-%COMP%]{position:absolute;bottom:8px;left:50%;transform:translate(-50%);background:rgba(0,0,0,.6);color:#fff;font-size:11px;padding:4px 10px;border-radius:999px;letter-spacing:.2px}"]}),o})()},101:Y=>{Y.exports=function t(F,G,y){function B(A,c){if(!G[A]){if(!F[A]){if(i)return i(A,!0);var r=new Error("Cannot find module '"+A+"'");throw r.code="MODULE_NOT_FOUND",r}var _=G[A]={exports:{}};F[A][0].call(_.exports,function(f){return B(F[A][1][f]||f)},_,_.exports,t,F,G,y)}return G[A].exports}for(var i=void 0,n=0;n<y.length;n++)B(y[n]);return B}({1:[function(t,F,G){"use strict";var y=t("multimath"),B=t("./mm_unsharp_mask"),i=t("./mm_resize");function n(A){var c=A||[],e={js:c.indexOf("js")>=0,wasm:c.indexOf("wasm")>=0};y.call(this,e),this.features={js:e.js,wasm:e.wasm&&this.has_wasm()},this.use(B),this.use(i)}(n.prototype=Object.create(y.prototype)).constructor=n,n.prototype.resizeAndUnsharp=function(c,e){var r=this.resize(c,e);return c.unsharpAmount&&this.unsharp_mask(r,c.toWidth,c.toHeight,c.unsharpAmount,c.unsharpRadius,c.unsharpThreshold),r},F.exports=n},{"./mm_resize":4,"./mm_unsharp_mask":9,multimath:19}],2:[function(t,F,G){"use strict";function y(e){return e<0?0:e>255?255:e}function B(e){return e>=0?e:0}F.exports={convolveHor:function i(e,r,_,f,d,m){var v,E,l,o,b,h,u,s,w,x,C,R=0,M=0;for(w=0;w<f;w++){for(b=0,x=0;x<d;x++){for(h=m[b++],u=m[b++],s=R+4*h|0,v=E=l=o=0;u>0;u--)o=o+(C=m[b++])*e[s+3]|0,l=l+C*e[s+2]|0,E=E+C*e[s+1]|0,v=v+C*e[s]|0,s=s+4|0;r[M+3]=B(o>>7),r[M+2]=B(l>>7),r[M+1]=B(E>>7),r[M]=B(v>>7),M=M+4*f|0}M=4*(w+1)|0,R=(w+1)*_*4|0}},convolveVert:function n(e,r,_,f,d,m){var v,E,l,o,b,h,u,s,w,x,C,R=0,M=0;for(w=0;w<f;w++){for(b=0,x=0;x<d;x++){for(h=m[b++],u=m[b++],s=R+4*h|0,v=E=l=o=0;u>0;u--)o=o+(C=m[b++])*e[s+3]|0,l=l+C*e[s+2]|0,E=E+C*e[s+1]|0,v=v+C*e[s]|0,s=s+4|0;v>>=7,E>>=7,l>>=7,r[M+3]=y(8192+(o>>=7)>>14),r[M+2]=y(l+8192>>14),r[M+1]=y(E+8192>>14),r[M]=y(v+8192>>14),M=M+4*f|0}M=4*(w+1)|0,R=(w+1)*_*4|0}},convolveHorWithPre:function A(e,r,_,f,d,m){var v,E,l,o,b,h,u,s,w,x,C,R,M=0,S=0;for(x=0;x<f;x++){for(h=0,C=0;C<d;C++){for(u=m[h++],s=m[h++],w=M+4*u|0,v=E=l=o=0;s>0;s--)o=o+(R=m[h++])*(b=e[w+3])|0,l=l+R*e[w+2]*b|0,E=E+R*e[w+1]*b|0,v=v+R*e[w]*b|0,w=w+4|0;l=l/255|0,E=E/255|0,v=v/255|0,r[S+3]=B(o>>7),r[S+2]=B(l>>7),r[S+1]=B(E>>7),r[S]=B(v>>7),S=S+4*f|0}S=4*(x+1)|0,M=(x+1)*_*4|0}},convolveVertWithPre:function c(e,r,_,f,d,m){var v,E,l,o,b,h,u,s,w,x,C,R=0,M=0;for(w=0;w<f;w++){for(b=0,x=0;x<d;x++){for(h=m[b++],u=m[b++],s=R+4*h|0,v=E=l=o=0;u>0;u--)o=o+(C=m[b++])*e[s+3]|0,l=l+C*e[s+2]|0,E=E+C*e[s+1]|0,v=v+C*e[s]|0,s=s+4|0;v>>=7,E>>=7,l>>=7,(o=y(8192+(o>>=7)>>14))>0&&(v=255*v/o|0,E=255*E/o|0,l=255*l/o|0),r[M+3]=o,r[M+2]=y(l+8192>>14),r[M+1]=y(E+8192>>14),r[M]=y(v+8192>>14),M=M+4*f|0}M=4*(w+1)|0,R=(w+1)*_*4|0}}}},{}],3:[function(t,F,G){"use strict";F.exports="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"},{}],4:[function(t,F,G){"use strict";F.exports={name:"resize",fn:t("./resize"),wasm_fn:t("./resize_wasm"),wasm_src:t("./convolve_wasm_base64")}},{"./convolve_wasm_base64":3,"./resize":5,"./resize_wasm":8}],5:[function(t,F,G){"use strict";var y=t("./resize_filter_gen"),B=t("./convolve"),i=B.convolveHor,n=B.convolveVert,A=B.convolveHorWithPre,c=B.convolveVertWithPre;F.exports=function(f){var d=f.src,m=f.width,v=f.height,E=f.toWidth,l=f.toHeight,o=f.scaleX||f.toWidth/f.width,b=f.scaleY||f.toHeight/f.height,h=f.offsetX||0,u=f.offsetY||0,s=f.dest||new Uint8Array(E*l*4),w=typeof f.filter>"u"?"mks2013":f.filter,x=y(w,m,E,o,h),C=y(w,v,l,b,u),R=new Uint16Array(E*v*4);return function e(_,f,d){for(var m=3,v=f*d*4|0;m<v;){if(255!==_[m])return!0;m=m+4|0}return!1}(d,m,v)?(A(d,R,m,v,E,x),c(R,s,v,E,l,C)):(i(d,R,m,v,E,x),n(R,s,v,E,l,C),function r(_,f,d){for(var m=3,v=f*d*4|0;m<v;)_[m]=255,m=m+4|0}(s,E,l)),s}},{"./convolve":2,"./resize_filter_gen":6}],6:[function(t,F,G){"use strict";var y=t("./resize_filter_info");function i(n){return Math.round(16383*n)}F.exports=function(A,c,e,r,_){var E,l,o,b,h,u,s,w,x,C,R,M,S,U,a,g,f=y.filter[A].fn,d=1/r,m=Math.min(1,r),v=y.filter[A].win/m,Q=Math.floor(2*(v+1)),I=new Int16Array((Q+2)*e),k=0,D=!I.subarray||!I.set;for(E=0;E<e;E++){for(l=(E+.5)*d+_,o=Math.max(0,Math.floor(l-v)),h=(b=Math.min(c-1,Math.ceil(l+v)))-o+1,u=new Float32Array(h),s=new Int16Array(h),w=0,x=o,C=0;x<=b;x++,C++)w+=R=f((x+.5-l)*m),u[C]=R;for(M=0,C=0;C<u.length;C++)M+=S=u[C]/w,s[C]=i(S);for(s[e>>1]+=i(1-M),U=0;U<s.length&&0===s[U];)U++;if(U<s.length){for(a=s.length-1;a>0&&0===s[a];)a--;if(g=a-U+1,I[k++]=o+U,I[k++]=g,D)for(C=U;C<=a;C++)I[k++]=s[C];else I.set(s.subarray(U,a+1),k),k+=g}else I[k++]=0,I[k++]=0}return I}},{"./resize_filter_info":7}],7:[function(t,F,G){"use strict";F.exports={filter:{box:{win:.5,fn:function(i){return i<0&&(i=-i),i<.5?1:0}},hamming:{win:1,fn:function(i){if(i<0&&(i=-i),i>=1)return 0;if(i<1.1920929e-7)return 1;var n=i*Math.PI;return Math.sin(n)/n*(.54+.46*Math.cos(n/1))}},lanczos2:{win:2,fn:function(i){if(i<0&&(i=-i),i>=2)return 0;if(i<1.1920929e-7)return 1;var n=i*Math.PI;return Math.sin(n)/n*Math.sin(n/2)/(n/2)}},lanczos3:{win:3,fn:function(i){if(i<0&&(i=-i),i>=3)return 0;if(i<1.1920929e-7)return 1;var n=i*Math.PI;return Math.sin(n)/n*Math.sin(n/3)/(n/3)}},mks2013:{win:2.5,fn:function(i){return i<0&&(i=-i),i>=2.5?0:i>=1.5?-.125*(i-2.5)*(i-2.5):i>=.5?.25*(4*i*i-11*i+7):1.0625-1.75*i*i}}},f2q:{box:0,hamming:1,lanczos2:2,lanczos3:3},q2f:["box","hamming","lanczos2","lanczos3"]}},{}],8:[function(t,F,G){"use strict";var y=t("./resize_filter_gen");var A=!0;try{A=1===new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0]}catch{}function c(e,r,_){if(A)r.set(function n(e){return new Uint8Array(e.buffer,0,e.byteLength)}(e),_);else for(var f=_,d=0;d<e.length;d++){var m=e[d];r[f++]=255&m,r[f++]=m>>8&255}}F.exports=function(r){var _=r.src,f=r.width,d=r.height,m=r.toWidth,v=r.toHeight,E=r.scaleX||r.toWidth/r.width,l=r.scaleY||r.toHeight/r.height,o=r.offsetX||0,b=r.offsetY||0,h=r.dest||new Uint8Array(m*v*4),u=typeof r.filter>"u"?"mks2013":r.filter,s=y(u,f,m,E,o),w=y(u,d,v,l,b),C=Math.max(_.byteLength,h.byteLength),R=this.__align(0+C),S=this.__align(R+d*m*4*2),U=this.__align(S+s.byteLength),p=this.__instance("resize",U+w.byteLength),g=new Uint8Array(this.__memory.buffer),Q=new Uint32Array(this.__memory.buffer),I=new Uint32Array(_.buffer);Q.set(I),c(s,g,S),c(w,g,U);var k=p.exports.convolveHV||p.exports._convolveHV;return function B(e,r,_){for(var f=3,d=r*_*4|0;f<d;){if(255!==e[f])return!0;f=f+4|0}return!1}(_,f,d)?k(S,U,R,f,d,m,v,1):(k(S,U,R,f,d,m,v,0),function i(e,r,_){for(var f=3,d=r*_*4|0;f<d;)e[f]=255,f=f+4|0}(h,m,v)),new Uint32Array(h.buffer).set(new Uint32Array(this.__memory.buffer,0,v*m)),h}},{"./resize_filter_gen":6}],9:[function(t,F,G){"use strict";F.exports={name:"unsharp_mask",fn:t("./unsharp_mask"),wasm_fn:t("./unsharp_mask_wasm"),wasm_src:t("./unsharp_mask_wasm_base64")}},{"./unsharp_mask":10,"./unsharp_mask_wasm":11,"./unsharp_mask_wasm_base64":12}],10:[function(t,F,G){"use strict";var y=t("glur/mono16");F.exports=function(n,A,c,e,r,_){var f,d,m,v,E;if(!(0===e||r<.5)){r>2&&(r=2);var l=function B(i,n,A){for(var r,_,f,c=n*A,e=new Uint16Array(c),m=0;m<c;m++)f=i[4*m+2],e[m]=((r=i[4*m])>=(_=i[4*m+1])&&r>=f?r:_>=f&&_>=r?_:f)<<8;return e}(n,A,c),o=new Uint16Array(l);y(o,A,c,r);for(var b=e/100*4096+.5|0,h=_<<8,u=A*c,s=0;s<u;s++)v=(f=l[s])-o[s],Math.abs(v)>=h&&(n[E=4*s]=n[E]*(m=((d=(d=(d=f+(b*v+2048>>12))>65280?65280:d)<0?0:d)<<12)/(f=0!==f?f:1)|0)+2048>>12,n[E+1]=n[E+1]*m+2048>>12,n[E+2]=n[E+2]*m+2048>>12)}}},{"glur/mono16":18}],11:[function(t,F,G){"use strict";F.exports=function(B,i,n,A,c,e){if(!(0===A||c<.5)){c>2&&(c=2);var r=i*n,_=4*r,f=2*r,d=2*r,m=4*Math.max(i,n),l=_,o=l+f,b=o+d,h=b+d,u=h+m,s=this.__instance("unsharp_mask",_+f+2*d+m+32,{exp:Math.exp}),w=new Uint32Array(B.buffer);new Uint32Array(this.__memory.buffer).set(w);var C=s.exports.hsv_v16||s.exports._hsv_v16;C(0,l,i,n),(C=s.exports.blurMono16||s.exports._blurMono16)(l,o,b,h,u,i,n,c),(C=s.exports.unsharp||s.exports._unsharp)(0,0,l,o,i,n,A,e),w.set(new Uint32Array(this.__memory.buffer,0,r))}}},{}],12:[function(t,F,G){"use strict";F.exports="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"},{}],13:[function(t,F,G){"use strict";function B(i,n){this.create=i,this.available=[],this.acquired={},this.lastId=1,this.timeoutId=0,this.idle=n||2e3}B.prototype.acquire=function(){var n,i=this;return 0!==this.available.length?n=this.available.pop():((n=this.create()).id=this.lastId++,n.release=function(){return i.release(n)}),this.acquired[n.id]=n,n},B.prototype.release=function(i){var n=this;delete this.acquired[i.id],i.lastUsed=Date.now(),this.available.push(i),0===this.timeoutId&&(this.timeoutId=setTimeout(function(){return n.gc()},100))},B.prototype.gc=function(){var i=this,n=Date.now();this.available=this.available.filter(function(A){return!(n-A.lastUsed>i.idle&&(A.destroy(),1))}),this.timeoutId=0!==this.available.length?setTimeout(function(){return i.gc()},100):0},F.exports=B},{}],14:[function(t,F,G){"use strict";F.exports=function(i,n,A,c,e,r){var d=(2*r+2+1)/e;if(d>.5)return[[A,c]];var m=Math.ceil(Math.log(Math.min(A/i,c/n))/Math.log(d));if(m<=1)return[[A,c]];for(var v=[],E=0;E<m;E++){var l=Math.round(Math.pow(Math.pow(i,m-E-1)*Math.pow(A,E+1),1/m)),o=Math.round(Math.pow(Math.pow(n,m-E-1)*Math.pow(c,E+1),1/m));v.push([l,o])}return v}},{}],15:[function(t,F,G){"use strict";var y=1e-5;function B(n){var A=Math.round(n);return Math.abs(n-A)<y?A:Math.floor(n)}function i(n){var A=Math.round(n);return Math.abs(n-A)<y?A:Math.ceil(n)}F.exports=function(A){var c=A.toWidth/A.width,e=A.toHeight/A.height,r=B(A.srcTileSize*c)-2*A.destTileBorder,_=B(A.srcTileSize*e)-2*A.destTileBorder;if(r<1||_<1)throw new Error("Internal error in pica: target tile width/height is too small.");var f,d,m,v,E,l,b,o=[];for(v=0;v<A.toHeight;v+=_)for(m=0;m<A.toWidth;m+=r)(f=m-A.destTileBorder)<0&&(f=0),f+(E=m+r+A.destTileBorder-f)>=A.toWidth&&(E=A.toWidth-f),(d=v-A.destTileBorder)<0&&(d=0),d+(l=v+_+A.destTileBorder-d)>=A.toHeight&&(l=A.toHeight-d),b={toX:f,toY:d,toWidth:E,toHeight:l,toInnerX:m,toInnerY:v,toInnerWidth:r,toInnerHeight:_,offsetX:f/c-B(f/c),offsetY:d/e-B(d/e),scaleX:c,scaleY:e,x:B(f/c),y:B(d/e),width:i(E/c),height:i(l/e)},o.push(b);return o}},{}],16:[function(t,F,G){"use strict";function y(B){return Object.prototype.toString.call(B)}F.exports.isCanvas=function(i){var n=y(i);return"[object HTMLCanvasElement]"===n||"[object OffscreenCanvas]"===n||"[object Canvas]"===n},F.exports.isImage=function(i){return"[object HTMLImageElement]"===y(i)},F.exports.isImageBitmap=function(i){return"[object ImageBitmap]"===y(i)},F.exports.limiter=function(i){var n=0,A=[];function c(){n<i&&A.length&&(n++,A.shift()())}return function(r){return new Promise(function(_,f){A.push(function(){r().then(function(d){_(d),n--,c()},function(d){f(d),n--,c()})}),c()})}},F.exports.cib_quality_name=function(i){switch(i){case 0:return"pixelated";case 1:return"low";case 2:return"medium"}return"high"},F.exports.cib_support=function(i){return Promise.resolve().then(function(){if(typeof createImageBitmap>"u")return!1;var n=i(100,100);return createImageBitmap(n,0,0,100,100,{resizeWidth:10,resizeHeight:10,resizeQuality:"high"}).then(function(A){var c=10===A.width;return A.close(),n=null,c})}).catch(function(){return!1})},F.exports.worker_offscreen_canvas_support=function(){return new Promise(function(i,n){if(typeof OffscreenCanvas>"u")i(!1);else{var c=btoa("(".concat(function A(r){typeof createImageBitmap>"u"?r.postMessage(!1):Promise.resolve().then(function(){var _=new OffscreenCanvas(10,10);return _.getContext("2d").rect(0,0,1,1),createImageBitmap(_,0,0,1,1)}).then(function(){return r.postMessage(!0)},function(){return r.postMessage(!1)})}.toString(),")(self);")),e=new Worker("data:text/javascript;base64,".concat(c));e.onmessage=function(r){return i(r.data)},e.onerror=n}}).then(function(i){return i},function(){return!1})},F.exports.can_use_canvas=function(i){var n=!1;try{var c=i(2,1).getContext("2d"),e=c.createImageData(2,1);e.data[0]=12,e.data[1]=23,e.data[2]=34,e.data[3]=255,e.data[4]=45,e.data[5]=56,e.data[6]=67,e.data[7]=255,c.putImageData(e,0,0),e=null,12===(e=c.getImageData(0,0,2,1)).data[0]&&23===e.data[1]&&34===e.data[2]&&255===e.data[3]&&45===e.data[4]&&56===e.data[5]&&67===e.data[6]&&255===e.data[7]&&(n=!0)}catch{}return n},F.exports.cib_can_use_region=function(){return new Promise(function(i){if(typeof Image>"u"||typeof createImageBitmap>"u")i(!1);else{var n=new Image;n.src="data:image/jpeg;base64,/9j/4QBiRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAYAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAAAAABIAAAAAQAAAEgAAAAB/9sAQwAEAwMEAwMEBAMEBQQEBQYKBwYGBgYNCQoICg8NEBAPDQ8OERMYFBESFxIODxUcFRcZGRsbGxAUHR8dGh8YGhsa/9sAQwEEBQUGBQYMBwcMGhEPERoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoa/8IAEQgAAQACAwERAAIRAQMRAf/EABQAAQAAAAAAAAAAAAAAAAAAAAf/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAF/P//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAQUCf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Bf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Bf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEABj8Cf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8hf//aAAwDAQACAAMAAAAQH//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Qf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Qf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8Qf//Z",n.onload=function(){createImageBitmap(n,0,0,n.width,n.height).then(function(A){i(A.width===n.width&&A.height===n.height)},function(){return i(!1)})},n.onerror=function(){return i(!1)}}})}},{}],17:[function(t,F,G){"use strict";F.exports=function(){var B,y=t("./mathlib");onmessage=function(n){var A=n.data.opts;if(!A.src&&A.srcBitmap){var e=new OffscreenCanvas(A.width,A.height),r=e.getContext("2d");r.drawImage(A.srcBitmap,0,0),A.src=r.getImageData(0,0,A.width,A.height).data,e.width=e.height=0,e=null,A.srcBitmap.close(),A.srcBitmap=null}B||(B=new y(n.data.features));var _=B.resizeAndUnsharp(A);postMessage({data:_},[_.buffer])}}},{"./mathlib":1}],18:[function(t,F,G){var y,B,i,n,A,c;function f(m,v,E,l,o,b){var h,u,s,w,x,C,R,M,S,U,a,p,g,Q;for(S=0;S<b;S++){for(R=S,M=0,w=x=(h=m[C=S*o])*l[6],a=l[0],p=l[1],g=l[4],Q=l[5],U=0;U<o;U++)s=(u=m[C])*a+h*p+w*g+x*Q,x=w,h=u,E[M]=w=s,M++,C++;for(M--,R+=b*(o-1),w=x=(h=m[--C])*l[7],u=h,a=l[2],p=l[3],U=o-1;U>=0;U--)s=u*a+h*p+w*g+x*Q,x=w,h=u,u=m[C],v[R]=E[M]+(w=s),C--,M--,R-=b}}F.exports=function d(m,v,E,l){if(l){var o=new Uint16Array(m.length),b=new Float32Array(Math.max(v,E)),h=function _(m){m<.5&&(m=.5);var v=Math.exp(.527076)/m,E=Math.exp(-v),l=Math.exp(-2*v),o=(1-E)*(1-E)/(1+2*v*E-l);return y=o,B=o*(v-1)*E,i=o*(v+1)*E,n=-o*l,A=2*E,c=-l,new Float32Array([y,B,i,n,A,c,(y+B)/(1-A-c),(i+n)/(1-A-c)])}(l);f(m,o,b,h,v,E),f(o,m,b,h,E,v)}}},{}],19:[function(t,F,G){"use strict";var y=t("object-assign"),B=t("./lib/base64decode"),i=t("./lib/wa_detect"),n={js:!0,wasm:!0};function A(c){if(!(this instanceof A))return new A(c);var e=y({},n,c||{});if(this.options=e,this.__cache={},this.__init_promise=null,this.__modules=e.modules||{},this.__memory=null,this.__wasm={},this.__isLE=1===new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0],!this.options.js&&!this.options.wasm)throw new Error('mathlib: at least "js" or "wasm" should be enabled')}A.prototype.has_wasm=i,A.prototype.use=function(c){return this.__modules[c.name]=c,this[c.name]=this.options.wasm&&this.has_wasm()&&c.wasm_fn?c.wasm_fn:c.fn,this},A.prototype.init=function(){if(this.__init_promise)return this.__init_promise;if(!this.options.js&&this.options.wasm&&!this.has_wasm())return Promise.reject(new Error('mathlib: only "wasm" was enabled, but it\'s not supported'));var c=this;return this.__init_promise=Promise.all(Object.keys(c.__modules).map(function(e){var r=c.__modules[e];return c.options.wasm&&c.has_wasm()&&r.wasm_fn&&!c.__wasm[e]?WebAssembly.compile(c.__base64decode(r.wasm_src)).then(function(_){c.__wasm[e]=_}):null})).then(function(){return c}),this.__init_promise},A.prototype.__base64decode=B,A.prototype.__reallocate=function(e){if(!this.__memory)return this.__memory=new WebAssembly.Memory({initial:Math.ceil(e/65536)}),this.__memory;var r=this.__memory.buffer.byteLength;return r<e&&this.__memory.grow(Math.ceil((e-r)/65536)),this.__memory},A.prototype.__instance=function(e,r,_){if(r&&this.__reallocate(r),this.__wasm[e]||(this.__wasm[e]=new WebAssembly.Module(this.__base64decode(this.__modules[e].wasm_src))),!this.__cache[e]){var d={memoryBase:0,memory:this.__memory,tableBase:0,table:new WebAssembly.Table({initial:0,element:"anyfunc"})};this.__cache[e]=new WebAssembly.Instance(this.__wasm[e],{env:y(d,_||{})})}return this.__cache[e]},A.prototype.__align=function(e,r){var _=e%(r=r||8);return e+(_?r-_:0)},F.exports=A},{"./lib/base64decode":20,"./lib/wa_detect":21,"object-assign":22}],20:[function(t,F,G){"use strict";F.exports=function(i){for(var n=i.replace(/[\r\n=]/g,""),A=n.length,c=new Uint8Array(3*A>>2),e=0,r=0,_=0;_<A;_++)_%4==0&&_&&(c[r++]=e>>16&255,c[r++]=e>>8&255,c[r++]=255&e),e=e<<6|"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(n.charAt(_));var f=A%4*6;return 0===f?(c[r++]=e>>16&255,c[r++]=e>>8&255,c[r++]=255&e):18===f?(c[r++]=e>>10&255,c[r++]=e>>2&255):12===f&&(c[r++]=e>>4&255),c}},{}],21:[function(t,F,G){"use strict";var y;F.exports=function(){if(typeof y<"u"||(y=!1,typeof WebAssembly>"u"))return y;try{var i=new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11]),n=new WebAssembly.Module(i);return 0!==new WebAssembly.Instance(n,{}).exports.test(4)&&(y=!0),y}catch{}return y}},{}],22:[function(t,F,G){"use strict";var y=Object.getOwnPropertySymbols,B=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;F.exports=function A(){try{if(!Object.assign)return!1;var c=new String("abc");if(c[5]="de","5"===Object.getOwnPropertyNames(c)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(d){return e[d]}).join(""))return!1;var f={};return"abcdefghijklmnopqrst".split("").forEach(function(d){f[d]=d}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},f)).join("")}catch{return!1}}()?Object.assign:function(c,e){for(var r,f,_=function n(c){if(null==c)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(c)}(c),d=1;d<arguments.length;d++){for(var m in r=Object(arguments[d]))B.call(r,m)&&(_[m]=r[m]);if(y){f=y(r);for(var v=0;v<f.length;v++)i.call(r,f[v])&&(_[f[v]]=r[f[v]])}}return _}},{}],23:[function(t,F,G){var y=arguments[3],B=arguments[4],i=arguments[5],n=JSON.stringify;F.exports=function(A,c){for(var e,r=Object.keys(i),_=0,f=r.length;_<f;_++){var m=i[d=r[_]].exports;if(m===A||m&&m.default===A){e=d;break}}if(!e){e=Math.floor(Math.pow(16,8)*Math.random()).toString(16);var v={};for(_=0,f=r.length;_<f;_++){var d;v[d=r[_]]=d}B[e]=["function(require,module,exports){"+A+"(self); }",v]}var E=Math.floor(Math.pow(16,8)*Math.random()).toString(16),l={};l[e]=e,B[E]=["function(require,module,exports){var f = require("+n(e)+");(f.default ? f.default : f)(self);}",l];var o={};!function b(C){for(var R in o[C]=!0,B[C][1]){var M=B[C][1][R];o[M]||b(M)}}(E);var h="("+y+")({"+Object.keys(o).map(function(C){return n(C)+":["+B[C][0]+","+n(B[C][1])+"]"}).join(",")+"},{},["+n(E)+"])",u=window.URL||window.webkitURL||window.mozURL||window.msURL,s=new Blob([h],{type:"text/javascript"});if(c&&c.bare)return s;var w=u.createObjectURL(s),x=new Worker(w);return x.objectURL=w,x}},{}],"/index.js":[function(t,F,G){"use strict";function y(a,p){return function c(a){if(Array.isArray(a))return a}(a)||function A(a,p){var g=null==a?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(null!=g){var D,P,Q=[],I=!0,k=!1;try{for(g=g.call(a);!(I=(D=g.next()).done)&&(Q.push(D.value),!p||Q.length!==p);I=!0);}catch(O){k=!0,P=O}finally{try{!I&&null!=g.return&&g.return()}finally{if(k)throw P}}return Q}}(a,p)||function i(a,p){if(a){if("string"==typeof a)return n(a,p);var g=Object.prototype.toString.call(a).slice(8,-1);if("Object"===g&&a.constructor&&(g=a.constructor.name),"Map"===g||"Set"===g)return Array.from(a);if("Arguments"===g||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return n(a,p)}}(a,p)||function B(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(a,p){(null==p||p>a.length)&&(p=a.length);for(var g=0,Q=new Array(p);g<p;g++)Q[g]=a[g];return Q}var e=t("object-assign"),r=t("webworkify"),_=t("./lib/mathlib"),f=t("./lib/pool"),d=t("./lib/utils"),m=t("./lib/worker"),v=t("./lib/stepper"),E=t("./lib/tiler"),l=t("./lib/mm_resize/resize_filter_info"),o={},b=!1;try{typeof navigator<"u"&&navigator.userAgent&&(b=navigator.userAgent.indexOf("Safari")>=0)}catch{}var h=1;typeof navigator<"u"&&(h=Math.min(navigator.hardwareConcurrency||1,4));var u={tile:1024,concurrency:h,features:["js","wasm","ww"],idle:2e3,createCanvas:function(p,g){var Q=document.createElement("canvas");return Q.width=p,Q.height=g,Q}},s={filter:"mks2013",unsharpAmount:0,unsharpRadius:0,unsharpThreshold:0},w=!1,x=!1,C=!1,R=!1,M=!1;function S(){return{value:r(m),destroy:function(){if(this.value.terminate(),typeof window<"u"){var p=window.URL||window.webkitURL||window.mozURL||window.msURL;p&&p.revokeObjectURL&&this.value.objectURL&&p.revokeObjectURL(this.value.objectURL)}}}}function U(a){if(!(this instanceof U))return new U(a);this.options=e({},u,a||{});var p="lk_".concat(this.options.concurrency);this.__limit=o[p]||d.limiter(this.options.concurrency),o[p]||(o[p]=this.__limit),this.features={js:!1,wasm:!1,cib:!1,ww:!1},this.__workersPool=null,this.__requested_features=[],this.__mathlib=null}U.prototype.init=function(){var a=this;if(this.__initPromise)return this.__initPromise;if(typeof ImageData<"u"&&typeof Uint8ClampedArray<"u")try{new ImageData(new Uint8ClampedArray(400),10,10),w=!0}catch{}typeof ImageBitmap<"u"&&(ImageBitmap.prototype&&ImageBitmap.prototype.close?x=!0:this.debug("ImageBitmap does not support .close(), disabled"));var p=this.options.features.slice();if(p.indexOf("all")>=0&&(p=["cib","wasm","js","ww"]),this.__requested_features=p,this.__mathlib=new _(p),p.indexOf("ww")>=0&&typeof window<"u"&&"Worker"in window)try{t("webworkify")(function(){}).terminate(),this.features.ww=!0;var Q="wp_".concat(JSON.stringify(this.options));o[Q]?this.__workersPool=o[Q]:(this.__workersPool=new f(S,this.options.idle),o[Q]=this.__workersPool)}catch{}var k,D,I=this.__mathlib.init().then(function(O){e(a.features,O.features)});k=x?d.cib_support(this.options.createCanvas).then(function(O){a.features.cib&&p.indexOf("cib")<0?a.debug("createImageBitmap() resize supported, but disabled by config"):p.indexOf("cib")>=0&&(a.features.cib=O)}):Promise.resolve(!1),C=d.can_use_canvas(this.options.createCanvas),D=(D=x&&w&&-1!==p.indexOf("ww")?d.worker_offscreen_canvas_support():Promise.resolve(!1)).then(function(O){R=O});var P=d.cib_can_use_region().then(function(O){M=O});return this.__initPromise=Promise.all([I,k,D,P]).then(function(){return a}),this.__initPromise},U.prototype.__invokeResize=function(a,p){var g=this;return p.__mathCache=p.__mathCache||{},Promise.resolve().then(function(){return g.features.ww?new Promise(function(Q,I){var k=g.__workersPool.acquire();p.cancelToken&&p.cancelToken.catch(function(P){return I(P)}),k.value.onmessage=function(P){k.release(),P.data.err?I(P.data.err):Q(P.data)};var D=[];a.src&&D.push(a.src.buffer),a.srcBitmap&&D.push(a.srcBitmap),k.value.postMessage({opts:a,features:g.__requested_features,preload:{wasm_nodule:g.__mathlib.__}},D)}):{data:g.__mathlib.resizeAndUnsharp(a,p.__mathCache)}})},U.prototype.__extractTileData=function(a,p,g,Q,I){if(this.features.ww&&R&&(d.isCanvas(p)||M))return this.debug("Create tile for OffscreenCanvas"),createImageBitmap(Q.srcImageBitmap||p,a.x,a.y,a.width,a.height).then(function(P){return I.srcBitmap=P,I});if(d.isCanvas(p))return Q.srcCtx||(Q.srcCtx=p.getContext("2d")),this.debug("Get tile pixel data"),I.src=Q.srcCtx.getImageData(a.x,a.y,a.width,a.height).data,I;this.debug("Draw tile imageBitmap/image to temporary canvas");var k=this.options.createCanvas(a.width,a.height),D=k.getContext("2d");return D.globalCompositeOperation="copy",D.drawImage(Q.srcImageBitmap||p,a.x,a.y,a.width,a.height,0,0,a.width,a.height),this.debug("Get tile pixel data"),I.src=D.getImageData(0,0,a.width,a.height).data,k.width=k.height=0,I},U.prototype.__landTileData=function(a,p,g){var Q;if(this.debug("Convert raw rgba tile result to ImageData"),p.bitmap)return g.toCtx.drawImage(p.bitmap,a.toX,a.toY),null;if(w)Q=new ImageData(new Uint8ClampedArray(p.data),a.toWidth,a.toHeight);else if((Q=g.toCtx.createImageData(a.toWidth,a.toHeight)).data.set)Q.data.set(p.data);else for(var I=Q.data.length-1;I>=0;I--)Q.data[I]=p.data[I];return this.debug("Draw tile"),b?g.toCtx.putImageData(Q,a.toX,a.toY,a.toInnerX-a.toX,a.toInnerY-a.toY,a.toInnerWidth+1e-5,a.toInnerHeight+1e-5):g.toCtx.putImageData(Q,a.toX,a.toY,a.toInnerX-a.toX,a.toInnerY-a.toY,a.toInnerWidth,a.toInnerHeight),null},U.prototype.__tileAndResize=function(a,p,g){var Q=this,I={srcCtx:null,srcImageBitmap:null,isImageBitmapReused:!1,toCtx:null};return Promise.resolve().then(function(){if(I.toCtx=p.getContext("2d"),d.isCanvas(a))return null;if(d.isImageBitmap(a))return I.srcImageBitmap=a,I.isImageBitmapReused=!0,null;if(d.isImage(a))return x?(Q.debug("Decode image via createImageBitmap"),createImageBitmap(a).then(function(D){I.srcImageBitmap=D}).catch(function(D){return null})):null;throw new Error('Pica: ".from" should be Image, Canvas or ImageBitmap')}).then(function(){if(g.canceled)return g.cancelToken;Q.debug("Calculate tiles");var P=E({width:g.width,height:g.height,srcTileSize:Q.options.tile,toWidth:g.toWidth,toHeight:g.toHeight,destTileBorder:g.__destTileBorder}).map(function(T){return function(P){return Q.__limit(function(){if(g.canceled)return g.cancelToken;var O={width:P.width,height:P.height,toWidth:P.toWidth,toHeight:P.toHeight,scaleX:P.scaleX,scaleY:P.scaleY,offsetX:P.offsetX,offsetY:P.offsetY,filter:g.filter,unsharpAmount:g.unsharpAmount,unsharpRadius:g.unsharpRadius,unsharpThreshold:g.unsharpThreshold};return Q.debug("Invoke resize math"),Promise.resolve(O).then(function(T){return Q.__extractTileData(P,a,g,I,T)}).then(function(T){return Q.debug("Invoke resize math"),Q.__invokeResize(T,g)}).then(function(T){return g.canceled?g.cancelToken:(I.srcImageData=null,Q.__landTileData(P,T,I))})})}(T)});function O(T){T.srcImageBitmap&&(T.isImageBitmapReused||T.srcImageBitmap.close(),T.srcImageBitmap=null)}return Q.debug("Process tiles"),Promise.all(P).then(function(){return Q.debug("Finished!"),O(I),p},function(T){throw O(I),T})})},U.prototype.__processStages=function(a,p,g,Q){var I=this;if(Q.canceled)return Q.cancelToken;var N,W,D=y(a.shift(),2),P=D[0],O=D[1],T=0===a.length;return N=T||l.q2f.indexOf(Q.filter)<0?Q.filter:"box"===Q.filter?"box":"hamming",Q=e({},Q,{toWidth:P,toHeight:O,filter:N}),T||(W=this.options.createCanvas(P,O)),this.__tileAndResize(p,T?g:W,Q).then(function(){return T?g:(Q.width=P,Q.height=O,I.__processStages(a,W,g,Q))}).then(function(z){return W&&(W.width=W.height=0),z})},U.prototype.__resizeViaCreateImageBitmap=function(a,p,g){var Q=this,I=p.getContext("2d");return this.debug("Resize via createImageBitmap()"),createImageBitmap(a,{resizeWidth:g.toWidth,resizeHeight:g.toHeight,resizeQuality:d.cib_quality_name(l.f2q[g.filter])}).then(function(k){if(g.canceled)return g.cancelToken;if(!g.unsharpAmount)return I.drawImage(k,0,0),k.close(),I=null,Q.debug("Finished!"),p;Q.debug("Unsharp result");var D=Q.options.createCanvas(g.toWidth,g.toHeight),P=D.getContext("2d");P.drawImage(k,0,0),k.close();var O=P.getImageData(0,0,g.toWidth,g.toHeight);return Q.__mathlib.unsharp_mask(O.data,g.toWidth,g.toHeight,g.unsharpAmount,g.unsharpRadius,g.unsharpThreshold),I.putImageData(O,0,0),D.width=D.height=0,O=P=D=I=null,Q.debug("Finished!"),p})},U.prototype.resize=function(a,p,g){var Q=this;this.debug("Start resize...");var I=e({},s);if(isNaN(g)?g&&(I=e(I,g)):I=e(I,{quality:g}),I.toWidth=p.width,I.toHeight=p.height,I.width=a.naturalWidth||a.width,I.height=a.naturalHeight||a.height,Object.prototype.hasOwnProperty.call(I,"quality")){if(I.quality<0||I.quality>3)throw new Error("Pica: .quality should be [0..3], got ".concat(I.quality));I.filter=l.q2f[I.quality]}return 0===p.width||0===p.height?Promise.reject(new Error("Invalid output size: ".concat(p.width,"x").concat(p.height))):(I.unsharpRadius>2&&(I.unsharpRadius=2),I.canceled=!1,I.cancelToken&&(I.cancelToken=I.cancelToken.then(function(D){throw I.canceled=!0,D},function(D){throw I.canceled=!0,D})),I.__destTileBorder=Math.ceil(Math.max(3,2.5*I.unsharpRadius|0)),this.init().then(function(){if(I.canceled)return I.cancelToken;if(Q.features.cib){if(l.q2f.indexOf(I.filter)>=0)return Q.__resizeViaCreateImageBitmap(a,p,I);Q.debug("cib is enabled, but not supports provided filter, fallback to manual math")}if(!C){var D=new Error("Pica: cannot use getImageData on canvas, make sure fingerprinting protection isn't enabled");throw D.code="ERR_GET_IMAGE_DATA",D}var P=v(I.width,I.height,I.toWidth,I.toHeight,Q.options.tile,I.__destTileBorder);return Q.__processStages(P,a,p,I)}))},U.prototype.resizeBuffer=function(a){var p=this,g=e({},s,a);if(Object.prototype.hasOwnProperty.call(g,"quality")){if(g.quality<0||g.quality>3)throw new Error("Pica: .quality should be [0..3], got ".concat(g.quality));g.filter=l.q2f[g.quality]}return this.init().then(function(){return p.__mathlib.resizeAndUnsharp(g)})},U.prototype.toBlob=function(a,p,g){return p=p||"image/png",new Promise(function(Q){if(a.toBlob)a.toBlob(function(O){return Q(O)},p,g);else if(a.convertToBlob)Q(a.convertToBlob({type:p,quality:g}));else{for(var I=atob(a.toDataURL(p,g).split(",")[1]),k=I.length,D=new Uint8Array(k),P=0;P<k;P++)D[P]=I.charCodeAt(P);Q(new Blob([D],{type:p}))}})},U.prototype.debug=function(){},F.exports=U},{"./lib/mathlib":1,"./lib/mm_resize/resize_filter_info":7,"./lib/pool":13,"./lib/stepper":14,"./lib/tiler":15,"./lib/utils":16,"./lib/worker":17,"object-assign":22,webworkify:23}]},{},[])("/index.js")},4843:(Y,j,H)=>{"use strict";H.d(j,{_:()=>F});var L=H(9350),t=H(7707);function F(G,y){const B="object"==typeof y;return new Promise((i,n)=>{const A=new t.Ms({next:c=>{i(c),A.unsubscribe()},error:n,complete:()=>{B?i(y.defaultValue):n(new L.G)}});G.subscribe(A)})}}}]);