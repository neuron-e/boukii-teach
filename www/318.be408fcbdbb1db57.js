"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[318],{318:(k,f,a)=>{a.r(f),a.d(f,{CourseDetailLevelPageModule:()=>be});var p=a(177),C=a(9417),_=a(8974),v=a(3314),d=a(467),m=a(4843),u=a(7586),x=a(9065),b=a(9569),e=a(6996),I=a(5663),O=a(918),D=a(4387),L=a(5794),w=a(8551),M=a(1547),R=a(5567);function $(o,r){if(1&o&&(e.j41(0,"div",44),e.EFF(1),e.k0s()),2&o){const i=e.XpG();e.Y8G("title",i.selectedBooking.course.name),e.R7$(1),e.SpI(" ",i.selectedBooking.course.name," ")}}function E(o,r){if(1&o&&(e.qex(0),e.EFF(1),e.bVm()),2&o){const i=e.XpG(2);e.R7$(1),e.SpI(" ",i.getLanguageById(i.clientMonitor.main.language1_id)," \xc2\xb7 ")}}function F(o,r){if(1&o&&(e.j41(0,"a",56),e.nrm(1,"img",57),e.j41(2,"span",58),e.EFF(3,"M"),e.k0s()()),2&o){const i=e.XpG(2);e.Y8G("href","tel:"+i.clientMonitor.main.phone,e.B4B)}}function B(o,r){if(1&o&&(e.j41(0,"a",56),e.nrm(1,"img",57),e.j41(2,"span",58),e.EFF(3,"T"),e.k0s()()),2&o){const i=e.XpG(2);e.Y8G("href","tel:"+i.clientMonitor.main.telephone,e.B4B)}}function j(o,r){if(1&o&&(e.j41(0,"a",59),e.nrm(1,"img",60),e.k0s()),2&o){const i=e.XpG(2);e.Y8G("href","mailto:"+i.clientMonitor.main.email,e.B4B)}}function T(o,r){if(1&o&&(e.j41(0,"div",45)(1,"div",46),e.nrm(2,"img",47),e.k0s(),e.j41(3,"div",48)(4,"div",49)(5,"div",50),e.DNE(6,E,2,1,"ng-container",12),e.EFF(7),e.nI1(8,"translate"),e.k0s()(),e.j41(9,"div",51)(10,"div"),e.EFF(11),e.k0s(),e.nrm(12,"img",52),e.k0s(),e.j41(13,"div",53),e.DNE(14,F,4,1,"a",54),e.DNE(15,B,4,1,"a",54),e.DNE(16,j,2,1,"a",55),e.k0s()()()),2&o){const i=e.XpG();e.R7$(2),e.Y8G("src",i.clientMonitor.main.image?i.clientMonitor.main.image:"assets/icon/icons-outline-default-avatar.svg",e.B4B),e.R7$(4),e.Y8G("ngIf",i.clientMonitor.main.language1_id),e.R7$(1),e.E5c(" ",i.getCountryById(i.clientMonitor.main.country)," \xc2\xb7 ",i.getBirthYears(i.clientMonitor.main.birth_date)," ",e.bMT(8,10,"years")," "),e.R7$(4),e.Lme("",i.clientMonitor.main.first_name," ",i.clientMonitor.main.last_name,""),e.R7$(3),e.Y8G("ngIf",i.isPhone(i.clientMonitor.main.phone)),e.R7$(1),e.Y8G("ngIf",i.isPhone(i.clientMonitor.main.telephone)),e.R7$(1),e.Y8G("ngIf",i.clientMonitor.main.email)}}function G(o,r){if(1&o&&(e.qex(0),e.EFF(1),e.bVm()),2&o){const i=e.XpG(2);e.R7$(1),e.SpI(" ",i.getLanguageById(i.clientMonitor.language1_id)," \xc2\xb7 ")}}function S(o,r){if(1&o&&(e.j41(0,"a",56),e.nrm(1,"img",57),e.j41(2,"span",58),e.EFF(3,"M"),e.k0s()()),2&o){const i=e.XpG(2);e.Y8G("href","tel:"+i.clientMonitor.phone,e.B4B)}}function N(o,r){if(1&o&&(e.j41(0,"a",56),e.nrm(1,"img",57),e.j41(2,"span",58),e.EFF(3,"T"),e.k0s()()),2&o){const i=e.XpG(2);e.Y8G("href","tel:"+i.clientMonitor.telephone,e.B4B)}}function Y(o,r){if(1&o&&(e.j41(0,"a",59),e.nrm(1,"img",60),e.k0s()),2&o){const i=e.XpG(2);e.Y8G("href","mailto:"+i.clientMonitor.email,e.B4B)}}function X(o,r){if(1&o&&(e.j41(0,"div",45)(1,"div",46),e.nrm(2,"img",47),e.k0s(),e.j41(3,"div",48)(4,"div",49)(5,"div",50),e.DNE(6,G,2,1,"ng-container",12),e.EFF(7),e.nI1(8,"translate"),e.k0s()(),e.j41(9,"div",51)(10,"div"),e.EFF(11),e.k0s()(),e.j41(12,"div",53),e.DNE(13,S,4,1,"a",54),e.DNE(14,N,4,1,"a",54),e.DNE(15,Y,2,1,"a",55),e.k0s()()()),2&o){const i=e.XpG();e.R7$(2),e.Y8G("src",i.clientMonitor.image?i.clientMonitor.image:"assets/icon/icons-outline-default-avatar.svg",e.B4B),e.R7$(4),e.Y8G("ngIf",i.clientMonitor.language1_id),e.R7$(1),e.E5c(" ",i.getCountryById(i.clientMonitor.country)," \xc2\xb7 ",i.clientMonitor.birth_years," ",e.bMT(8,10,"years")," "),e.R7$(4),e.Lme("",i.clientMonitor.first_name," ",i.clientMonitor.last_name,""),e.R7$(2),e.Y8G("ngIf",i.isPhone(i.clientMonitor.phone)),e.R7$(1),e.Y8G("ngIf",i.isPhone(i.clientMonitor.telephone)),e.R7$(1),e.Y8G("ngIf",i.clientMonitor.email)}}function z(o,r){if(1&o&&(e.qex(0),e.EFF(1),e.bVm()),2&o){const i=e.XpG(2);e.R7$(1),e.SpI(" ",i.getLanguageById(i.clientMonitor.language1_id)," \xc2\xb7 ")}}function H(o,r){if(1&o&&(e.j41(0,"a",56),e.nrm(1,"img",57),e.j41(2,"span",58),e.EFF(3,"M"),e.k0s()()),2&o){const i=e.XpG(2);e.Y8G("href","tel:"+i.clientMonitor.phone,e.B4B)}}function A(o,r){if(1&o&&(e.j41(0,"a",56),e.nrm(1,"img",57),e.j41(2,"span",58),e.EFF(3,"T"),e.k0s()()),2&o){const i=e.XpG(2);e.Y8G("href","tel:"+i.clientMonitor.telephone,e.B4B)}}function V(o,r){if(1&o&&(e.j41(0,"a",59),e.nrm(1,"img",60),e.k0s()),2&o){const i=e.XpG(2);e.Y8G("href","mailto:"+i.clientMonitor.email,e.B4B)}}function U(o,r){if(1&o&&(e.j41(0,"div",61)(1,"div",46),e.nrm(2,"img",47),e.k0s(),e.j41(3,"div",48)(4,"div",49)(5,"div",50),e.DNE(6,z,2,1,"ng-container",12),e.EFF(7),e.nI1(8,"translate"),e.k0s()(),e.j41(9,"div",51)(10,"div"),e.EFF(11),e.k0s()(),e.j41(12,"div",53),e.DNE(13,H,4,1,"a",54),e.DNE(14,A,4,1,"a",54),e.DNE(15,V,2,1,"a",55),e.k0s()()()),2&o){const i=e.XpG();e.R7$(2),e.Y8G("src",i.clientMonitor.image?i.clientMonitor.image:"assets/icon/icons-outline-default-avatar.svg",e.B4B),e.R7$(4),e.Y8G("ngIf",i.clientMonitor.language1_id),e.R7$(1),e.E5c(" ",i.getCountryById(i.clientMonitor.country)," \xc2\xb7 ",i.clientMonitor.birth_years," ",e.bMT(8,10,"years")," "),e.R7$(4),e.Lme("",i.clientMonitor.first_name," ",i.clientMonitor.last_name,""),e.R7$(2),e.Y8G("ngIf",i.isPhone(i.clientMonitor.phone)),e.R7$(1),e.Y8G("ngIf",i.isPhone(i.clientMonitor.telephone)),e.R7$(1),e.Y8G("ngIf",i.clientMonitor.email)}}function J(o,r){if(1&o&&(e.qex(0),e.nrm(1,"img",47),e.j41(2,"div",62),e.EFF(3),e.k0s(),e.bVm()),2&o){const i=e.XpG();e.R7$(1),e.Y8G("src",i.selectedBooking.course.sport.icon_selected,e.B4B),e.R7$(2),e.SpI(" ",i.selectedBooking.course.sport.name," ")}}function W(o,r){if(1&o){const i=e.RV6();e.j41(0,"app-level-full",63),e.bIt("levelSelected",function(t){e.eBV(i);const s=e.XpG();return e.Njj(s.onLevelSelected(t))}),e.k0s()}if(2&o){const i=e.XpG();e.Y8G("allLevels",i.sportDegrees)("selectLevel",i.selectedLevelId)("size",280)}}function K(o,r){1&o&&(e.j41(0,"div",64),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"observations_sources_description")," "))}function Q(o,r){if(1&o&&(e.j41(0,"div",65),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o){const i=e.XpG();e.R7$(1),e.SpI(" ",(null==i.selectedBooking||null==i.selectedBooking.booking?null:i.selectedBooking.booking.notes)||e.bMT(2,1,"not_assigned")," ")}}function Z(o,r){if(1&o&&(e.j41(0,"div",65),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o){const i=e.XpG();e.R7$(1),e.SpI(" ",(null==i.selectedBooking||null==i.selectedBooking.booking?null:i.selectedBooking.booking.notes_school)||e.bMT(2,1,"not_assigned")," ")}}function q(o,r){if(1&o&&(e.j41(0,"div",69),e.EFF(1),e.k0s()),2&o){const i=r.$implicit;e.R7$(1),e.SpI(" ",i," ")}}function ee(o,r){if(1&o&&(e.j41(0,"div"),e.DNE(1,q,2,1,"div",68),e.k0s()),2&o){const i=e.XpG(2);e.R7$(1),e.Y8G("ngForOf",i.clientObservationHistory)}}function te(o,r){1&o&&(e.j41(0,"div",70),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(1),e.JRh(e.bMT(2,1,"not_assigned")))}function ne(o,r){if(1&o&&(e.j41(0,"div",65),e.DNE(1,ee,2,1,"div",66),e.DNE(2,te,3,3,"ng-template",null,67,e.C5r),e.k0s()),2&o){const i=e.sdS(3),n=e.XpG();e.R7$(1),e.Y8G("ngIf",n.clientObservationHistory.length>0)("ngIfElse",i)}}function ie(o,r){if(1&o&&(e.j41(0,"div",65),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o){const i=e.XpG();let n;e.R7$(1),e.SpI(" ",(null==(n=i.getEvaluationForSelectedLevel())?null:n.observations)||e.bMT(2,1,"not_assigned")," ")}}function oe(o,r){1&o&&(e.j41(0,"div",72),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(1),e.JRh(e.bMT(2,1,"loading")))}function se(o,r){1&o&&(e.j41(0,"div",72),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"no_comments")," "))}function re(o,r){if(1&o&&(e.j41(0,"div",75)(1,"div",76),e.EFF(2),e.k0s(),e.j41(3,"div",77)(4,"span",78),e.EFF(5),e.k0s(),e.j41(6,"span"),e.EFF(7),e.nI1(8,"date"),e.k0s()()()),2&o){const i=r.$implicit,n=e.XpG(3);e.R7$(2),e.JRh(i.comment),e.R7$(3),e.JRh(n.getCommentAuthor(i)),e.R7$(2),e.JRh(e.i5U(8,3,i.created_at,"short"))}}function le(o,r){if(1&o){const i=e.RV6();e.j41(0,"button",79),e.bIt("click",function(){e.eBV(i);const t=e.XpG(3);return e.Njj(t.toggleCommentsView())}),e.EFF(1),e.nI1(2,"translate"),e.nI1(3,"translate"),e.k0s()}if(2&o){const i=e.XpG(3);e.R7$(1),e.SpI(" ",i.showAllComments?e.bMT(2,1,"show_less"):e.bMT(3,3,"view_more")," ")}}function ae(o,r){if(1&o&&(e.j41(0,"div"),e.DNE(1,se,3,3,"div",71),e.DNE(2,re,9,6,"div",73),e.DNE(3,le,4,5,"button",74),e.k0s()),2&o){const i=e.XpG(2);e.R7$(1),e.Y8G("ngIf",0===i.getVisibleComments().length),e.R7$(1),e.Y8G("ngForOf",i.getVisibleComments()),e.R7$(1),e.Y8G("ngIf",i.evaluationComments.length>i.commentsPreviewLimit)}}function ce(o,r){if(1&o&&(e.j41(0,"div",65),e.DNE(1,oe,3,3,"div",71),e.DNE(2,ae,4,3,"div",12),e.k0s()),2&o){const i=e.XpG();e.R7$(1),e.Y8G("ngIf",i.commentsLoading),e.R7$(1),e.Y8G("ngIf",!i.commentsLoading)}}function de(o,r){1&o&&(e.j41(0,"div",72),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"loading")," "))}function ge(o,r){1&o&&(e.j41(0,"div",72),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"history_no_changes")," "))}function ue(o,r){if(1&o&&(e.j41(0,"div",86),e.EFF(1),e.k0s()),2&o){const i=e.XpG().$implicit,n=e.XpG(3);e.R7$(1),e.SpI(" ",n.getHistorySummary(i)," ")}}function pe(o,r){if(1&o&&(e.j41(0,"div",82)(1,"div",83),e.EFF(2),e.k0s(),e.j41(3,"div",84),e.EFF(4),e.nI1(5,"date"),e.k0s(),e.DNE(6,ue,2,1,"div",85),e.k0s()),2&o){const i=r.$implicit,n=e.XpG(3);e.R7$(2),e.JRh(n.getHistoryTitle(i)),e.R7$(2),e.Lme(" ",n.getHistoryUserLabel(i)," \xb7 ",e.i5U(5,4,i.created_at,"short")," "),e.R7$(2),e.Y8G("ngIf",n.getHistorySummary(i))}}function ve(o,r){if(1&o){const i=e.RV6();e.j41(0,"button",79),e.bIt("click",function(){e.eBV(i);const t=e.XpG(3);return e.Njj(t.toggleHistoryView())}),e.EFF(1),e.nI1(2,"translate"),e.nI1(3,"translate"),e.k0s()}if(2&o){const i=e.XpG(3);e.R7$(1),e.SpI(" ",i.showAllHistory?e.bMT(2,1,"show_less"):e.bMT(3,3,"view_more")," ")}}function he(o,r){if(1&o&&(e.qex(0),e.DNE(1,ge,3,3,"div",71),e.DNE(2,pe,7,7,"div",81),e.DNE(3,ve,4,5,"button",74),e.bVm()),2&o){const i=e.XpG(2);e.R7$(1),e.Y8G("ngIf",0===i.getVisibleHistory().length),e.R7$(1),e.Y8G("ngForOf",i.getVisibleHistory()),e.R7$(1),e.Y8G("ngIf",i.evaluationHistory.length>i.historyPreviewLimit)}}function _e(o,r){if(1&o&&(e.j41(0,"div",80),e.DNE(1,de,3,3,"div",71),e.DNE(2,he,4,3,"ng-container",12),e.k0s()),2&o){const i=e.XpG();e.R7$(1),e.Y8G("ngIf",i.historyLoading),e.R7$(1),e.Y8G("ngIf",!i.historyLoading)}}const me=[{path:"",component:(()=>{var o;class r{constructor(n,t,s,l,c,y,h,g){this.router=n,this.activatedRoute=t,this.monitorDataService=s,this.sharedDataService=l,this.teachService=c,this.toastr=y,this.spinnerService=h,this.translate=g,this.showGeneral=!0,this.showSports=!1,this.showWinter=!0,this.showSummer=!1,this.showOther=!1,this.showLevel=!1,this.dataSports=[{id:1,name:"Ski",image:"assets/icon/icons-outline-disciplinas-1.svg",checked:!1},{id:2,name:"Snowboard",image:"assets/icon/icons-outline-disciplinas-2.svg",checked:!1},{id:3,name:"Telemark",image:"assets/icon/icons-outline-disciplinas-3.svg",checked:!1},{id:4,name:"S.Rando",image:"assets/icon/icons-outline-disciplinas-4.svg",checked:!1}],this.bookingsCurrent=[],this.degrees=[],this.sportDegrees=[],this.sports=[],this.languages=[],this.showBookingNotes=!0,this.showSchoolNotes=!0,this.showClientObservations=!0,this.showEvaluationObservations=!0,this.showMonitorComments=!0,this.showObservationsInfo=!1,this.showHistoryPanel=!0,this.clientObservationHistory=[],this.clientEvaluations=[],this.selectedLevelId=null,this.evaluationComments=[],this.evaluationHistory=[],this.commentsLoading=!1,this.historyLoading=!1,this.showAllComments=!1,this.showAllHistory=!1,this.commentsPreviewLimit=3,this.historyPreviewLimit=3}ngOnInit(){var n=this;return(0,d.A)(function*(){n.subscription=n.monitorDataService.getMonitorData().subscribe(function(){var t=(0,d.A)(function*(s){if(s){n.monitorData=s;try{n.degrees=yield(0,m._)(n.sharedDataService.fetchDegrees(n.monitorData.active_school)),n.sports=yield(0,m._)(n.sharedDataService.fetchSports(n.monitorData.active_school)),n.languages=yield(0,m._)(n.sharedDataService.fetchLanguages()),console.log("Course-detail-level loaded degrees:",n.degrees.length)}catch(l){console.error("Error fetching data:",l),n.toastr.error(n.translate.instant("toast.error_loading_data")),n.degrees=[],n.sports=[],n.languages=[]}n.activatedRoute.params.subscribe(function(){var l=(0,d.A)(function*(c){n.bookingId=+c.id,n.dateBooking=c.date,n.clientIdBooking=+c.client,n.sportIdBooking=+c.sport,n.bookingId&&n.dateBooking&&n.clientIdBooking&&n.sportIdBooking?(n.spinnerService.show(),n.loadBookings()):n.goTo("home")});return function(c){return l.apply(this,arguments)}}())}});return function(s){return t.apply(this,arguments)}}())})()}getLanguageById(n){const t=this.languages.find(s=>s.id===n);return t?t.code.toUpperCase():""}getCountryById(n){const t=x.k.find(s=>s.id===n);return t?t.iso:"Aucun"}getProvinceById(n){const t=b.R.find(s=>s.id===n);return t?t.name:"Aucune"}loadBookings(){this.sportDegrees=this.degrees&&this.degrees.length>0?this.degrees.filter(t=>t.sport_id===this.sportIdBooking):[],console.log("Course-detail-level sportDegrees:",this.sportDegrees);const n={date_start:this.dateBooking,date_end:this.dateBooking};this.monitorData.active_school&&(n.school_id=this.monitorData.active_school),this.teachService.getData("teach/getAgenda",null,n).subscribe(t=>{this.processBookings(t.data.bookings)},t=>{console.error("There was an error!",t),this.spinnerService.hide()})}processBookings(n){const t=new Map;this.bookingsCurrent=[],n.forEach(s=>{if(s.course){let l=`${s.course_id}`;if(1==s.course.course_type?l=`${s.course_id}-${s.course_subgroup_id}`:2==s.course.course_type&&(l=`${s.course_id}-${s.hour_start}-${s.hour_end}`),t.has(l)){const c={...s.client,booking_client:s.booking};t.get(l).all_clients.push(c),s.id===this.bookingId&&(t.get(l).selected_detail=!0)}else{const c={...s.client,booking_client:s.booking};t.set(l,{...s,all_clients:[c],selected_detail:s.id===this.bookingId}),this.bookingsCurrent.push(t.get(l))}}}),this.selectedBooking=this.bookingsCurrent.find(s=>!0===s.selected_detail),this.selectedBooking&&this.selectedBooking.course&&this.sports&&(this.selectedBooking.course.sport=this.sports.find(s=>s.id===this.sportIdBooking)),this.spinnerService.hide(),this.getClient()}getClient(){this.spinnerService.show(),this.teachService.getData(`teach/clients/${this.clientIdBooking}`).subscribe(n=>{const t=n.data;if(t){var s,l;const c=u(t.birth_date),y=u().diff(c,"years");t.birth_years=y;let h=t.sports.find(g=>g.id===this.sportIdBooking);this.spinnerService.hide(),t.degree_sport=h&&h.pivot&&h.pivot.degree_id?h.pivot.degree_id:0,this.clientMonitor=t,this.clientEvaluations=t.evaluations||[],this.clientObservationHistory=(t.observations||[]).filter(g=>{var P;return g.school_id===(null===(P=this.monitorData)||void 0===P?void 0:P.active_school)}).map(g=>this.normalizeObservationText(g)).filter(g=>g.length>0),this.setSelectedLevel((null===(s=this.clientMonitor)||void 0===s?void 0:s.degree_sport)||(null===(l=this.sportDegrees[0])||void 0===l?void 0:l.id)||null)}else this.goTo("clients")},n=>{console.error("There was an error fetching clients!",n),this.spinnerService.hide()})}getBirthYears(n){const t=u(n);return u().diff(t,"years")}getEvaluationForSelectedLevel(){if(!this.selectedLevelId)return null;const n=(this.clientEvaluations||[]).filter(t=>t.degree_id===this.selectedLevelId);return n.length?n.sort((t,s)=>s.id-t.id)[0]:null}getVisibleComments(){return this.showAllComments?this.evaluationComments:this.evaluationComments.slice(0,this.commentsPreviewLimit)}getVisibleHistory(){return this.showAllHistory?this.evaluationHistory:this.evaluationHistory.slice(0,this.historyPreviewLimit)}toggleCommentsView(){this.showAllComments=!this.showAllComments}toggleHistoryView(){this.showAllHistory=!this.showAllHistory}getCommentAuthor(n){const t=null==n?void 0:n.monitor;if(t){const s=[t.first_name,t.last_name].filter(Boolean).join(" ").trim()||t.name||t.email||"",l=this.translate.instant("history_role_monitor");if(s)return`${s} (${l})`}return this.getUserDisplayLabel(null==n?void 0:n.user)}getHistoryUserLabel(n){const t=null==n?void 0:n.monitor;if(t){const s=[t.first_name,t.last_name].filter(Boolean).join(" ").trim()||t.name||t.email||"",l=this.translate.instant("history_role_monitor");if(s)return`${s} (${l})`}return this.getUserDisplayLabel(null==n?void 0:n.user)}getHistoryTitle(n){switch(null==n?void 0:n.type){case"goal_created":return this.translate.instant("history_change_goal_created");case"goal_updated":return this.translate.instant("history_change_goal_updated");case"goal_deleted":return this.translate.instant("history_change_goal_deleted");case"observation_updated":return this.translate.instant("history_change_observation_updated");case"comment_added":return this.translate.instant("history_change_comment_added");case"file_added":return this.translate.instant("history_change_file_added");case"file_deleted":return this.translate.instant("history_change_file_deleted");default:return this.translate.instant("history_change_generic")}}getHistorySummary(n){const t=(null==n?void 0:n.payload)||{};return t.comment?t.comment:t.file?t.file.split("/").pop()||t.file:t.new?t.new:void 0!==t.score?`${this.translate.instant("history_change_status_label")}: ${this.getScoreLabel(t.score)}`:""}getScoreLabel(n){return this.translate.instant(n>=10?"achieved":n>=5?"to_improve":"not_started")}setSelectedLevel(n){this.selectedLevelId=n,this.showAllComments=!1,this.showAllHistory=!1,this.loadEvaluationSummary()}resetToCurrentLevel(){var n;const t=(null===(n=this.clientMonitor)||void 0===n?void 0:n.degree_sport)||null;t&&this.setSelectedLevel(t)}onLevelSelected(n){this.setSelectedLevel(n)}getLevelNameById(n){if(!n)return"-";const t=this.sportDegrees.find(s=>s.id===n);return(null==t?void 0:t.name)||"-"}getPreviousLevelName(){var n,t;if(null===(n=this.sportDegrees)||void 0===n||!n.length||!this.selectedLevelId)return"-";const s=this.sportDegrees.findIndex(l=>l.id===this.selectedLevelId);return s>0&&(null===(t=this.sportDegrees[s-1])||void 0===t?void 0:t.name)||"-"}getNextLevelName(){var n;if(null===(n=this.sportDegrees)||void 0===n||!n.length||!this.selectedLevelId)return"-";const t=this.sportDegrees.findIndex(l=>l.id===this.selectedLevelId);var s;return t>=0&&this.sportDegrees[t+1]&&(null===(s=this.sportDegrees[t+1])||void 0===s?void 0:s.name)||"-"}toggleBookingNotes(){this.showBookingNotes=!this.showBookingNotes}toggleSchoolNotes(){this.showSchoolNotes=!this.showSchoolNotes}toggleClientObservations(){this.showClientObservations=!this.showClientObservations}toggleMonitorComments(){this.showMonitorComments=!this.showMonitorComments}toggleEvaluationObservations(){this.showEvaluationObservations=!this.showEvaluationObservations}toggleHistoryPanel(){this.showHistoryPanel=!this.showHistoryPanel}toggleObservationsInfo(n){n.stopPropagation(),this.showObservationsInfo=!this.showObservationsInfo}goToPreviousLevel(){var n;if(null===(n=this.sportDegrees)||void 0===n||!n.length||!this.selectedLevelId)return;const t=this.sportDegrees.findIndex(l=>l.id===this.selectedLevelId);var s;t>0&&this.setSelectedLevel((null===(s=this.sportDegrees[t-1])||void 0===s?void 0:s.id)||null)}goToNextLevel(){var n;if(null===(n=this.sportDegrees)||void 0===n||!n.length||!this.selectedLevelId)return;const t=this.sportDegrees.findIndex(l=>l.id===this.selectedLevelId);var s;t>=0&&this.sportDegrees[t+1]&&this.setSelectedLevel((null===(s=this.sportDegrees[t+1])||void 0===s?void 0:s.id)||null)}loadEvaluationSummary(){var n=this;return(0,d.A)(function*(){const t=n.getEvaluationForSelectedLevel();if(null==t||!t.id)return n.evaluationComments=[],void(n.evaluationHistory=[]);yield Promise.all([n.loadEvaluationComments(t.id),n.loadEvaluationHistory(t.id)])})()}loadEvaluationComments(n){var t=this;return(0,d.A)(function*(){if(n&&!t.commentsLoading){t.commentsLoading=!0;try{const s=yield t.teachService.getData(`teach/evaluations/${n}/comments`,null,{limit:200}).toPromise();t.evaluationComments=(null==s?void 0:s.data)||[]}catch(s){console.error("Error loading evaluation comments:",s),t.evaluationComments=[]}finally{t.commentsLoading=!1}}})()}loadEvaluationHistory(n){var t=this;return(0,d.A)(function*(){if(n&&!t.historyLoading){t.historyLoading=!0;try{const s=yield t.teachService.getData(`teach/evaluations/${n}/history`,null,{limit:200}).toPromise();t.evaluationHistory=(null==s?void 0:s.data)||[]}catch(s){console.error("Error loading evaluation history:",s),t.evaluationHistory=[]}finally{t.historyLoading=!1}}})()}getUserDisplayLabel(n){if(!n)return this.translate.instant("history_change_system");const t=[n.first_name,n.last_name].filter(Boolean).join(" ").trim()||n.name||n.username||n.email||"",s=this.getUserRoleLabel(n);return t&&s?`${t} (${s})`:t||s||this.translate.instant("history_change_system")}getUserRoleLabel(n){const t=null==n?void 0:n.type;return 1===t||"admin"===t?this.translate.instant("history_role_admin"):3===t||"monitor"===t?this.translate.instant("history_role_monitor"):null}isPhone(n){if(!n)return!1;const t=String(n);return/[0-9]/.test(t)&&!t.includes("@")}goTo(...n){this.router.navigate(n)}goToClientLevelWithCourse(){var n,t,s,l;this.router.navigate(["client-level","course",this.bookingId,this.dateBooking,this.clientIdBooking,this.sportIdBooking],{queryParams:{courseId:null!==(n=null===(t=this.selectedBooking)||void 0===t||null===(t=t.course)||void 0===t?void 0:t.id)&&void 0!==n?n:null,courseName:null!==(s=null===(l=this.selectedBooking)||void 0===l||null===(l=l.course)||void 0===l?void 0:l.name)&&void 0!==s?s:null}})}normalizeObservationText(n){if(!n)return"";const t=[],s=(n.notes||"").trim(),l=(n.general||"").trim(),c=(n.historical||"").trim();return s&&t.push(s),l&&t.push(`General: ${l}`),c&&t.push(`Historial: ${c}`),t.join("\n").trim()}goToClientLevelSelected(){var n,t,s,l,c;this.router.navigate(["client-level","course",this.bookingId,this.dateBooking,this.clientIdBooking,this.sportIdBooking],{queryParams:{courseId:null!==(n=null===(t=this.selectedBooking)||void 0===t||null===(t=t.course)||void 0===t?void 0:t.id)&&void 0!==n?n:null,courseName:null!==(s=null===(l=this.selectedBooking)||void 0===l||null===(l=l.course)||void 0===l?void 0:l.name)&&void 0!==s?s:null,levelId:null!==(c=this.selectedLevelId)&&void 0!==c?c:null}})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}return(o=r).\u0275fac=function(n){return new(n||o)(e.rXU(v.Ix),e.rXU(v.nX),e.rXU(I.O),e.rXU(O.H),e.rXU(D.R),e.rXU(L.tw),e.rXU(w.D),e.rXU(M.c$))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-course-detail-level"]],decls:108,vars:73,consts:[[1,"content-size","content-background-image","status-bar-overlap"],[1,"background-color-dark","padding-wrapper"],[1,"header-content","mb-24"],["src","assets/icon/arrow-left.svg",1,"cursor-pointer","header-content-icon",3,"click"],["class","header-top-title",3,"title",4,"ngIf"],["class","header-user-data mt-24",4,"ngIf"],[1,"padding-wrapper"],[1,"background-color-dark","box-radius"],["class","header-user-data padding-wrapper",4,"ngIf"],[1,"box-top-center"],[1,"box-top-left"],[1,"box-top-icon","cursor-pointer"],[4,"ngIf"],[1,"pt-24"],["class","cursor-pointer",3,"allLevels","selectLevel","size","levelSelected",4,"ngIf"],[1,"padding-wrapper","mt-8"],[1,"level-current-banner","background-color-dark","mb-12","level-current-clickable",3,"click"],[1,"level-current-label"],[1,"level-current-value"],[1,"level-meta","mb-16"],[1,"level-meta-item","level-meta-left","level-meta-clickable",3,"click"],[1,"level-meta-label"],[1,"level-meta-value"],[1,"level-meta-item","level-meta-right","level-meta-clickable",3,"click"],[1,"content-button","btn-back-primary","montserrat","level-cta",3,"click"],[1,"flex-title-selector","mt-32","mb-8"],[1,"flex-title-selector-interior"],[1,"background-color-dark","flex-title-selector-icon"],["src","assets/icon/icon-observations.png"],[1,"flex-title-selector-text"],["name","information-circle-outline",1,"info-icon",3,"click"],["class","observations-tooltip",4,"ngIf"],[1,"observations-card",3,"click"],[1,"observations-panel"],[1,"panel-heading",3,"click"],[1,"panel-title"],[3,"name"],["class","panel-body",4,"ngIf"],["src","assets/icon/icon-award-level-grey.svg"],[1,"observations-card","evaluation-card"],["src","assets/icon/icon-historic.png"],[1,"history-card"],[1,"history-panel"],["class","history-body",4,"ngIf"],[1,"header-top-title",3,"title"],[1,"header-user-data","mt-24"],[1,"header-user-data-img"],[3,"src"],[1,"header-user-data-text"],[1,"header-user-data-text-top"],[1,"color-light"],[1,"header-user-data-text-title"],["src","assets/icon/icon-crown.png"],[1,"header-user-data-text-icons"],["class","icon-with-label",3,"href",4,"ngIf"],[3,"href",4,"ngIf"],[1,"icon-with-label",3,"href"],["src","assets/icon/icon-phone-box.png",1,"cursor-pointer"],[1,"icon-label"],[3,"href"],["src","assets/icon/icon-mail-box.png",1,"cursor-pointer"],[1,"header-user-data","padding-wrapper"],[1,"montserrat"],[1,"cursor-pointer",3,"allLevels","selectLevel","size","levelSelected"],[1,"observations-tooltip"],[1,"panel-body"],[4,"ngIf","ngIfElse"],["noClientObservations",""],["class","observation-entry",4,"ngFor","ngForOf"],[1,"observation-entry"],[1,"observation-empty"],["class","mini-empty",4,"ngIf"],[1,"mini-empty"],["class","comment-mini",4,"ngFor","ngForOf"],["class","mini-toggle",3,"click",4,"ngIf"],[1,"comment-mini"],[1,"comment-mini-text"],[1,"comment-mini-meta"],[1,"comment-mini-author"],[1,"mini-toggle",3,"click"],[1,"history-body"],["class","history-mini",4,"ngFor","ngForOf"],[1,"history-mini"],[1,"history-mini-title"],[1,"history-mini-meta"],["class","history-mini-detail",4,"ngIf"],[1,"history-mini-detail"]],template:function(n,t){1&n&&(e.j41(0,"ion-content")(1,"div",0)(2,"div",1)(3,"div",2)(4,"img",3),e.bIt("click",function(){return t.goTo("course-detail",t.bookingId,t.dateBooking)}),e.k0s(),e.DNE(5,$,2,2,"div",4),e.k0s(),e.DNE(6,T,17,12,"div",5),e.DNE(7,X,16,12,"div",5),e.k0s(),e.j41(8,"div",6)(9,"div",7),e.DNE(10,U,16,12,"div",8),e.j41(11,"div",9)(12,"div",10)(13,"div",11),e.DNE(14,J,4,2,"ng-container",12),e.k0s()()(),e.j41(15,"div",13),e.DNE(16,W,1,3,"app-level-full",14),e.j41(17,"div",15)(18,"div",16),e.bIt("click",function(){return t.resetToCurrentLevel()}),e.j41(19,"div",17),e.EFF(20),e.nI1(21,"translate"),e.k0s(),e.j41(22,"div",18),e.EFF(23),e.k0s()(),e.j41(24,"div",19)(25,"div",20),e.bIt("click",function(){return t.goToPreviousLevel()}),e.j41(26,"span",21),e.EFF(27),e.nI1(28,"translate"),e.k0s(),e.j41(29,"span",22),e.EFF(30),e.k0s()(),e.j41(31,"div",23),e.bIt("click",function(){return t.goToNextLevel()}),e.j41(32,"span",21),e.EFF(33),e.nI1(34,"translate"),e.k0s(),e.j41(35,"span",22),e.EFF(36),e.k0s()()(),e.j41(37,"button",24),e.bIt("click",function(){return t.goToClientLevelSelected()}),e.EFF(38),e.nI1(39,"translate"),e.k0s()()()(),e.j41(40,"div",25)(41,"div",26)(42,"div",27),e.nrm(43,"img",28),e.k0s(),e.j41(44,"div",29),e.EFF(45),e.nI1(46,"translate"),e.j41(47,"ion-icon",30),e.bIt("click",function(l){return t.toggleObservationsInfo(l)}),e.k0s(),e.DNE(48,K,3,3,"div",31),e.k0s()()(),e.j41(49,"div",32),e.bIt("click",function(){return t.showObservationsInfo=!1}),e.j41(50,"div",33)(51,"div",34),e.bIt("click",function(){return t.toggleBookingNotes()}),e.j41(52,"div",35),e.EFF(53),e.nI1(54,"translate"),e.k0s(),e.nrm(55,"ion-icon",36),e.k0s(),e.DNE(56,Q,3,3,"div",37),e.k0s(),e.j41(57,"div",33)(58,"div",34),e.bIt("click",function(){return t.toggleSchoolNotes()}),e.j41(59,"div",35),e.EFF(60),e.nI1(61,"translate"),e.k0s(),e.nrm(62,"ion-icon",36),e.k0s(),e.DNE(63,Z,3,3,"div",37),e.k0s(),e.j41(64,"div",33)(65,"div",34),e.bIt("click",function(){return t.toggleClientObservations()}),e.j41(66,"div",35),e.EFF(67),e.nI1(68,"translate"),e.k0s(),e.nrm(69,"ion-icon",36),e.k0s(),e.DNE(70,ne,4,2,"div",37),e.k0s()(),e.j41(71,"div",25)(72,"div",26)(73,"div",27),e.nrm(74,"img",38),e.k0s(),e.j41(75,"div",29),e.EFF(76),e.nI1(77,"translate"),e.k0s()()(),e.j41(78,"div",39)(79,"div",33)(80,"div",34),e.bIt("click",function(){return t.toggleEvaluationObservations()}),e.j41(81,"div",35),e.EFF(82),e.nI1(83,"translate"),e.k0s(),e.nrm(84,"ion-icon",36),e.k0s(),e.DNE(85,ie,3,3,"div",37),e.k0s(),e.j41(86,"div",33)(87,"div",34),e.bIt("click",function(){return t.toggleMonitorComments()}),e.j41(88,"div",35),e.EFF(89),e.nI1(90,"translate"),e.k0s(),e.nrm(91,"ion-icon",36),e.k0s(),e.DNE(92,ce,3,2,"div",37),e.k0s()(),e.j41(93,"div",25)(94,"div",26)(95,"div",27),e.nrm(96,"img",40),e.k0s(),e.j41(97,"div",29),e.EFF(98),e.nI1(99,"translate"),e.k0s()()(),e.j41(100,"div",41)(101,"div",42)(102,"div",34),e.bIt("click",function(){return t.toggleHistoryPanel()}),e.j41(103,"div",35),e.EFF(104),e.nI1(105,"translate"),e.k0s(),e.nrm(106,"ion-icon",36),e.k0s(),e.DNE(107,_e,3,2,"div",43),e.k0s()()()()()),2&n&&(e.R7$(5),e.Y8G("ngIf",t.selectedBooking),e.R7$(1),e.Y8G("ngIf",t.clientMonitor&&t.clientMonitor.main),e.R7$(1),e.Y8G("ngIf",t.clientMonitor&&!t.clientMonitor.main),e.R7$(3),e.Y8G("ngIf",t.clientMonitor&&t.clientMonitor.main),e.R7$(4),e.Y8G("ngIf",t.selectedBooking&&t.selectedBooking.course.sport&&t.sports.length),e.R7$(2),e.Y8G("ngIf",t.clientMonitor&&t.sportDegrees&&t.sportDegrees.length),e.R7$(4),e.JRh(e.bMT(21,47,"level_in_progress")),e.R7$(3),e.JRh(t.getLevelNameById(null==t.clientMonitor?null:t.clientMonitor.degree_sport)),e.R7$(4),e.JRh(e.bMT(28,49,"previous_level")),e.R7$(3),e.JRh(t.getPreviousLevelName()),e.R7$(3),e.JRh(e.bMT(34,51,"next_level")),e.R7$(3),e.JRh(t.getNextLevelName()),e.R7$(2),e.SpI(" ",e.bMT(39,53,"evaluate_progress")," "),e.R7$(7),e.SpI(" ",e.bMT(46,55,"observations")," "),e.R7$(3),e.Y8G("ngIf",t.showObservationsInfo),e.R7$(2),e.AVh("open",t.showBookingNotes),e.R7$(3),e.JRh(e.bMT(54,57,"booking_notes")),e.R7$(2),e.Y8G("name",t.showBookingNotes?"chevron-up-outline":"chevron-down-outline"),e.R7$(1),e.Y8G("ngIf",t.showBookingNotes),e.R7$(1),e.AVh("open",t.showSchoolNotes),e.R7$(3),e.JRh(e.bMT(61,59,"school_notes")),e.R7$(2),e.Y8G("name",t.showSchoolNotes?"chevron-up-outline":"chevron-down-outline"),e.R7$(1),e.Y8G("ngIf",t.showSchoolNotes),e.R7$(1),e.AVh("open",t.showClientObservations),e.R7$(3),e.JRh(e.bMT(68,61,"client_observations")),e.R7$(2),e.Y8G("name",t.showClientObservations?"chevron-up-outline":"chevron-down-outline"),e.R7$(1),e.Y8G("ngIf",t.showClientObservations),e.R7$(6),e.SpI(" ",e.bMT(77,63,"evaluation_section")," "),e.R7$(3),e.AVh("open",t.showEvaluationObservations),e.R7$(3),e.JRh(e.bMT(83,65,"evaluation_observations")),e.R7$(2),e.Y8G("name",t.showEvaluationObservations?"chevron-up-outline":"chevron-down-outline"),e.R7$(1),e.Y8G("ngIf",t.showEvaluationObservations),e.R7$(1),e.AVh("open",t.showMonitorComments),e.R7$(3),e.JRh(e.bMT(90,67,"monitor_comments")),e.R7$(2),e.Y8G("name",t.showMonitorComments?"chevron-up-outline":"chevron-down-outline"),e.R7$(1),e.Y8G("ngIf",t.showMonitorComments),e.R7$(6),e.SpI(" ",e.bMT(99,69,"historical")," "),e.R7$(3),e.AVh("open",t.showHistoryPanel),e.R7$(3),e.JRh(e.bMT(105,71,"history")),e.R7$(2),e.Y8G("name",t.showHistoryPanel?"chevron-up-outline":"chevron-down-outline"),e.R7$(1),e.Y8G("ngIf",t.showHistoryPanel))},dependencies:[p.Sq,p.bT,_.W9,_.iq,R.t,p.vh,M.D9],styles:[".content-wrapper[_ngcontent-%COMP%]{width:100%;min-height:100%;padding:20px 16px}.content-size[_ngcontent-%COMP%]{width:100%;min-height:100%}.padding-wrapper[_ngcontent-%COMP%]{padding:20px 16px}.dark-background[_ngcontent-%COMP%]{width:100%;min-height:100vh;background:var(--ion-back-color-dark)}.header-content[_ngcontent-%COMP%]{position:relative;top:0;left:0;width:100%;display:flex;align-items:center;justify-content:center;margin-bottom:60px;padding-left:36px;padding-right:12px}.header-content-icon[_ngcontent-%COMP%]{position:absolute;left:0;top:50%;transform:translateY(-50%);width:28px}.header-top-title[_ngcontent-%COMP%]{font-size:15px;color:#fff;font-weight:600;max-width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:center}.header-user-data[_ngcontent-%COMP%]{display:flex;width:100%;align-items:flex-start;gap:16px}.header-user-data-img[_ngcontent-%COMP%]{width:60px;min-width:60px;height:60px;position:relative;border-radius:60px}.header-user-data-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:cover;width:100%;height:100%;border-radius:100%}.header-user-data-text[_ngcontent-%COMP%]{display:flex;width:100%;flex-direction:column;gap:4px}.header-user-data-text-top[_ngcontent-%COMP%]{display:flex;width:100%;align-items:center;justify-content:space-between}.header-user-data-text-top[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:11px}.header-user-data-text-top[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:22px}.header-user-data-text-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;font-size:17px;color:#fff;font-weight:500}.header-user-data-text-title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:24px}.header-user-data-text-subtitle[_ngcontent-%COMP%]{font-size:13px}.header-user-data-text-icons[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.icon-with-label[_ngcontent-%COMP%]{position:relative;display:inline-flex;align-items:center;justify-content:center}.icon-label[_ngcontent-%COMP%]{position:absolute;right:-4px;bottom:-4px;background:#1f2937;color:#fff;font-size:9px;line-height:1;padding:2px 4px;border-radius:999px}.header-user-data-text-icons[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:34px}.box-sport[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;align-items:center;justify-content:center;padding:18px 12px;border-radius:8px}.box-sport[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:22px}.box-sport[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:15px;color:#fff}.box-sport[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px}.box-school[_ngcontent-%COMP%]{display:block;width:300px;min-width:300px;padding:18px 12px;border-radius:8px}.box-school-icons[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px}.flex-title-selector[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.flex-title-selector-interior[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center}.flex-title-selector-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:40px;display:flex;align-items:center;justify-content:center}.flex-title-selector-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px}.flex-title-selector-text[_ngcontent-%COMP%]{color:#fff;font-size:20px;font-weight:500;position:relative}.flex-title-selector-text[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%]{margin-left:8px;font-size:18px;vertical-align:middle;color:#b0b7c3;cursor:pointer}.flex-title-selector-arrow[_ngcontent-%COMP%]{width:24px}.box-radius[_ngcontent-%COMP%]{width:100%;border-radius:8px}.box-top[_ngcontent-%COMP%]{padding:10px 20px;border-bottom:1px solid #43494f;display:flex;width:100%;align-items:center;justify-content:space-between}.box-top-center[_ngcontent-%COMP%]{padding:10px 20px;border-bottom:1px solid #43494f;display:flex;width:100%;align-items:center;justify-content:center}.box-top-left[_ngcontent-%COMP%]{display:flex;gap:20px;align-items:center}.box-top-icon[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;align-items:center;justify-content:center}.box-top-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:18px}.box-top-icon[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:13px}.content-button[_ngcontent-%COMP%]{width:100%;height:44px;line-height:44px;display:block;border-radius:44px;color:#000;text-align:center;font-size:14px;font-weight:500;cursor:pointer;transition:all ease-in-out .3s}.level-meta[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:space-between;align-items:flex-start;flex-wrap:wrap}.level-meta-item[_ngcontent-%COMP%]{background:#2b303b;border-radius:12px;padding:8px 12px;display:flex;flex-direction:column;gap:4px;min-width:0;flex:1 1 140px}.level-meta-clickable[_ngcontent-%COMP%]{cursor:pointer}.level-meta-label[_ngcontent-%COMP%]{font-size:11px;color:#b0b7c3}.level-meta-value[_ngcontent-%COMP%]{font-size:13px;font-weight:600;color:#fff}.level-meta-left[_ngcontent-%COMP%]{text-align:left}.level-meta-right[_ngcontent-%COMP%]{text-align:right}.level-current-banner[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;align-items:center;padding:12px;border-radius:12px}.level-current-label[_ngcontent-%COMP%]{font-size:11px;text-transform:uppercase;color:#b0b7c3}.level-current-value[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#fff;text-align:center}.level-current-clickable[_ngcontent-%COMP%]{cursor:pointer}.level-cta[_ngcontent-%COMP%]{margin-top:12px}.box-observations[_ngcontent-%COMP%]{padding:12px 16px}.accordion-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;cursor:pointer}.accordion-chevron[_ngcontent-%COMP%]{font-size:18px;color:#b0b7c3}.observations-card[_ngcontent-%COMP%]{background:#10131b;border-radius:16px;padding:16px;display:flex;flex-direction:column;gap:12px;color:#fff;position:relative}.evaluation-card[_ngcontent-%COMP%]{border:1px solid rgba(255,255,255,.12);box-shadow:0 16px 26px #00000059}.observations-panel[_ngcontent-%COMP%]{background:rgba(255,255,255,.04);border-radius:12px;padding:12px 16px;border:1px solid rgba(255,255,255,.1);transition:border-color .2s ease,box-shadow .2s ease}.observations-panel.open[_ngcontent-%COMP%]{border-color:#ffffff40;box-shadow:0 8px 18px #00000059}.panel-heading[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;cursor:pointer;font-size:15px;font-weight:600;color:#f4f6fb}.panel-heading[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;color:#cbd5f5}.panel-body[_ngcontent-%COMP%]{margin-top:10px;font-size:14px;color:#dfe4f5;line-height:1.5;min-height:28px}.observation-entry[_ngcontent-%COMP%]{margin-bottom:8px;white-space:pre-line}.observation-empty[_ngcontent-%COMP%]{color:#9aa1b8}.evaluation-panel[_ngcontent-%COMP%]{border:1px solid rgba(255,255,255,.08)}.observations-tooltip[_ngcontent-%COMP%]{position:absolute;top:40px;right:16px;background:#11131a;color:#dbe2ff;padding:10px 14px;border-radius:10px;font-size:12px;line-height:1.4;max-width:230px;box-shadow:0 8px 20px #0009;z-index:10}.history-card[_ngcontent-%COMP%]{background:#10131b;border-radius:16px;border:1px solid rgba(255,255,255,.08);box-shadow:0 18px 30px #0006;padding:16px;margin-top:0}.history-card[_ngcontent-%COMP%]   .history-panel[_ngcontent-%COMP%]{background:rgba(255,255,255,.03);border-radius:12px;padding:12px 16px}.history-card[_ngcontent-%COMP%]   .history-panel.open[_ngcontent-%COMP%]{border:1px solid rgba(255,255,255,.25);box-shadow:0 12px 22px #0006}.history-card[_ngcontent-%COMP%]   .panel-heading[_ngcontent-%COMP%]{justify-content:flex-start;gap:10px;font-size:17px;font-weight:600;color:#fff}.history-card[_ngcontent-%COMP%]   .panel-heading[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;color:#cbd5f5;margin-left:auto}.history-card[_ngcontent-%COMP%]   .panel-title[_ngcontent-%COMP%]{font-size:16px}.history-body[_ngcontent-%COMP%]{margin-top:12px;display:flex;flex-direction:column;gap:12px}.history-card[_ngcontent-%COMP%]   .history-mini[_ngcontent-%COMP%]{background:rgba(255,255,255,.02);border-radius:10px;padding:10px 14px;border:1px solid rgba(255,255,255,.05)}.history-card[_ngcontent-%COMP%]   .history-mini-title[_ngcontent-%COMP%]{font-size:13px;font-weight:600;color:#f4f6fb}.history-card[_ngcontent-%COMP%]   .history-mini-meta[_ngcontent-%COMP%]{font-size:12px;color:#c2c8d9}.history-card[_ngcontent-%COMP%]   .history-mini-detail[_ngcontent-%COMP%]{font-size:12px;color:#dbe2ff;margin-top:4px}.text-observations[_ngcontent-%COMP%]{font-size:13px}.title-observations[_ngcontent-%COMP%]{font-size:15px;border-top:1px solid #444953}.mini-empty[_ngcontent-%COMP%]{font-size:12px;color:#b0b7c3;margin-top:6px}.comment-mini[_ngcontent-%COMP%]{background:#2b303b;border-radius:10px;padding:10px 12px;margin-top:8px;display:flex;flex-direction:column;gap:6px}.comment-mini-text[_ngcontent-%COMP%]{font-size:13px;color:#fff}.comment-mini-meta[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:11px;color:#b0b7c3}.comment-mini-author[_ngcontent-%COMP%]{font-weight:600;color:#d6dde8}.history-mini[_ngcontent-%COMP%]{background:#2b303b;border-radius:10px;padding:10px 12px;margin-top:8px;display:flex;flex-direction:column;gap:6px}.history-mini-title[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#fff}.history-mini-meta[_ngcontent-%COMP%]{font-size:11px;color:#b0b7c3}.history-mini-detail[_ngcontent-%COMP%]{font-size:12px;color:#d6dde8}.mini-toggle[_ngcontent-%COMP%]{margin-top:8px;background:transparent;border:1px solid #3a414f;border-radius:10px;padding:8px 12px;color:#fff;font-size:12px}.list-box-selector-users[_ngcontent-%COMP%]{width:100%;overflow-x:auto;white-space:nowrap;display:flex;gap:16px;padding:8px 0;margin-bottom:-16px;justify-content:space-around}.box-selector-user-section[_ngcontent-%COMP%]{display:flex;white-space:normal;width:80px;min-width:80px;max-width:80px;padding:8px;flex-direction:column;gap:12px;align-items:center;border-radius:8px;justify-content:flex-start}.box-selector-user-section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;color:#fff;font-size:14px;line-height:1.3;text-align:center}.box-selector-user-section-title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:24px}.opacity-light[_ngcontent-%COMP%]{opacity:.6}"]}),r})()}];let fe=(()=>{var o;class r{}return(o=r).\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[v.iI.forChild(me),v.iI]}),r})();var xe=a(5553);let be=(()=>{var o;class r{}return(o=r).\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[p.MD,C.YN,_.bv,fe,xe.h,M.h]}),r})()},4843:(k,f,a)=>{a.d(f,{_:()=>_});var p=a(9350),C=a(7707);function _(v,d){const m="object"==typeof d;return new Promise((u,x)=>{const b=new C.Ms({next:e=>{u(e),b.unsubscribe()},error:x,complete:()=>{m?u(d.defaultValue):x(new p.G)}});v.subscribe(b)})}}}]);