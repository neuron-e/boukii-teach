"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[318],{318:(C,h,r)=>{r.r(h),r.d(h,{CourseDetailLevelPageModule:()=>U});var f=r(177),_=r(9417),v=r(8974),g=r(3314),p=r(467),u=r(4843),d=r(7586),m=r(9065),x=r(9569),e=r(6996),P=r(5663),k=r(918),y=r(4387),B=r(5794),D=r(8551),M=r(1547),I=r(5567);function O(o,a){if(1&o&&(e.j41(0,"div",26),e.EFF(1),e.k0s()),2&o){const n=e.XpG();e.R7$(1),e.SpI(" ",n.selectedBooking.course.name," ")}}function R(o,a){if(1&o&&(e.qex(0),e.EFF(1),e.bVm()),2&o){const n=e.XpG(2);e.R7$(1),e.SpI(" ",n.getLanguageById(n.clientMonitor.main.language1_id)," \xb7 ")}}function w(o,a){if(1&o&&(e.j41(0,"div",27)(1,"div",28),e.nrm(2,"img",29),e.k0s(),e.j41(3,"div",30)(4,"div",31)(5,"div",32),e.DNE(6,R,2,1,"ng-container",12),e.EFF(7),e.nI1(8,"translate"),e.k0s()(),e.j41(9,"div",33)(10,"div"),e.EFF(11),e.k0s(),e.nrm(12,"img",34),e.k0s(),e.j41(13,"div",35)(14,"a",36),e.nrm(15,"img",37),e.k0s(),e.j41(16,"a",36),e.nrm(17,"img",38),e.k0s()()()()),2&o){const n=e.XpG();e.R7$(2),e.Y8G("src",n.clientMonitor.main.image?n.clientMonitor.main.image:"assets/icon/icons-outline-default-avatar.svg",e.B4B),e.R7$(4),e.Y8G("ngIf",n.clientMonitor.main.language1_id),e.R7$(1),e.E5c(" ",n.getCountryById(n.clientMonitor.main.country)," \xb7 ",n.getBirthYears(n.clientMonitor.main.birth_date)," ",e.bMT(8,9,"years")," "),e.R7$(4),e.Lme("",n.clientMonitor.main.first_name," ",n.clientMonitor.main.last_name,""),e.R7$(3),e.Y8G("href","tel:"+n.clientMonitor.main.phone,e.B4B),e.R7$(2),e.Y8G("href","mailto:"+n.clientMonitor.main.email,e.B4B)}}function $(o,a){if(1&o&&(e.qex(0),e.EFF(1),e.bVm()),2&o){const n=e.XpG(2);e.R7$(1),e.SpI(" ",n.getLanguageById(n.clientMonitor.language1_id)," \xb7 ")}}function j(o,a){if(1&o&&(e.j41(0,"div",27)(1,"div",28),e.nrm(2,"img",29),e.k0s(),e.j41(3,"div",30)(4,"div",31)(5,"div",32),e.DNE(6,$,2,1,"ng-container",12),e.EFF(7),e.nI1(8,"translate"),e.k0s()(),e.j41(9,"div",33)(10,"div"),e.EFF(11),e.k0s()(),e.j41(12,"div",35)(13,"a",36),e.nrm(14,"img",37),e.k0s(),e.j41(15,"a",36),e.nrm(16,"img",38),e.k0s()()()()),2&o){const n=e.XpG();e.R7$(2),e.Y8G("src",n.clientMonitor.image?n.clientMonitor.image:"assets/icon/icons-outline-default-avatar.svg",e.B4B),e.R7$(4),e.Y8G("ngIf",n.clientMonitor.language1_id),e.R7$(1),e.E5c(" ",n.getCountryById(n.clientMonitor.country)," \xb7 ",n.clientMonitor.birth_years," ",e.bMT(8,9,"years")," "),e.R7$(4),e.Lme("",n.clientMonitor.first_name," ",n.clientMonitor.last_name,""),e.R7$(2),e.Y8G("href","tel:"+n.clientMonitor.phone,e.B4B),e.R7$(2),e.Y8G("href","mailto:"+n.clientMonitor.email,e.B4B)}}function L(o,a){if(1&o&&(e.qex(0),e.EFF(1),e.bVm()),2&o){const n=e.XpG(2);e.R7$(1),e.SpI(" ",n.getLanguageById(n.clientMonitor.language1_id)," \xb7 ")}}function E(o,a){if(1&o&&(e.j41(0,"div",39)(1,"div",28),e.nrm(2,"img",29),e.k0s(),e.j41(3,"div",30)(4,"div",31)(5,"div",32),e.DNE(6,L,2,1,"ng-container",12),e.EFF(7),e.nI1(8,"translate"),e.k0s()(),e.j41(9,"div",33)(10,"div"),e.EFF(11),e.k0s()(),e.j41(12,"div",35)(13,"a",36),e.nrm(14,"img",37),e.k0s(),e.j41(15,"a",36),e.nrm(16,"img",38),e.k0s()()()()),2&o){const n=e.XpG();e.R7$(2),e.Y8G("src",n.clientMonitor.image?n.clientMonitor.image:"assets/icon/icons-outline-default-avatar.svg",e.B4B),e.R7$(4),e.Y8G("ngIf",n.clientMonitor.language1_id),e.R7$(1),e.E5c(" ",n.getCountryById(n.clientMonitor.country)," \xb7 ",n.clientMonitor.birth_years," ",e.bMT(8,9,"years")," "),e.R7$(4),e.Lme("",n.clientMonitor.first_name," ",n.clientMonitor.last_name,""),e.R7$(2),e.Y8G("href","tel:"+n.clientMonitor.phone,e.B4B),e.R7$(2),e.Y8G("href","mailto:"+n.clientMonitor.email,e.B4B)}}function G(o,a){if(1&o&&(e.qex(0),e.nrm(1,"img",29),e.j41(2,"div",40),e.EFF(3),e.k0s(),e.bVm()),2&o){const n=e.XpG();e.R7$(1),e.Y8G("src",n.selectedBooking.course.sport.icon_selected,e.B4B),e.R7$(2),e.SpI(" ",n.selectedBooking.course.sport.name," ")}}function F(o,a){if(1&o){const n=e.RV6();e.j41(0,"app-level-full",41),e.bIt("click",function(){e.eBV(n);const t=e.XpG();return e.Njj(t.goTo("client-level","course",t.bookingId,t.dateBooking,t.clientIdBooking,t.sportIdBooking))}),e.k0s()}if(2&o){const n=e.XpG();e.Y8G("allLevels",n.sportDegrees)("selectLevel",n.clientMonitor.degree_sport)("size",280)}}function T(o,a){if(1&o&&(e.j41(0,"div",42),e.EFF(1),e.k0s()),2&o){const n=e.XpG();e.R7$(1),e.SpI(" ",n.clientMonitor.observations.general," ")}}function S(o,a){if(1&o&&(e.qex(0),e.j41(1,"div",43),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"div",42),e.EFF(5),e.k0s(),e.bVm()),2&o){const n=e.XpG();e.R7$(2),e.JRh(e.bMT(3,2,"school_notes")),e.R7$(3),e.SpI(" ",n.clientMonitor.observations.notes," ")}}function Y(o,a){if(1&o&&(e.j41(0,"div",42),e.EFF(1),e.k0s()),2&o){const n=e.XpG();e.R7$(1),e.SpI(" ",n.clientMonitor.observations.historical," ")}}const X=[{path:"",component:(()=>{var o;class a{constructor(i,t,s,c,l,b,V,A){this.router=i,this.activatedRoute=t,this.monitorDataService=s,this.sharedDataService=c,this.teachService=l,this.toastr=b,this.spinnerService=V,this.translate=A,this.showGeneral=!0,this.showSports=!1,this.showWinter=!0,this.showSummer=!1,this.showOther=!1,this.showLevel=!1,this.dataSports=[{id:1,name:"Ski",image:"assets/icon/icons-outline-disciplinas-1.svg",checked:!1},{id:2,name:"Snowboard",image:"assets/icon/icons-outline-disciplinas-2.svg",checked:!1},{id:3,name:"Telemark",image:"assets/icon/icons-outline-disciplinas-3.svg",checked:!1},{id:4,name:"S.Rando",image:"assets/icon/icons-outline-disciplinas-4.svg",checked:!1}],this.bookingsCurrent=[],this.degrees=[],this.sportDegrees=[],this.sports=[],this.languages=[]}ngOnInit(){var i=this;return(0,p.A)(function*(){i.subscription=i.monitorDataService.getMonitorData().subscribe(function(){var t=(0,p.A)(function*(s){if(s){i.monitorData=s;try{i.degrees=yield(0,u._)(i.sharedDataService.fetchDegrees(i.monitorData.active_school)),i.sports=yield(0,u._)(i.sharedDataService.fetchSports(i.monitorData.active_school)),i.languages=yield(0,u._)(i.sharedDataService.fetchLanguages()),console.log("Course-detail-level loaded degrees:",i.degrees.length)}catch(c){console.error("Error fetching data:",c),i.toastr.error(i.translate.instant("toast.error_loading_data")),i.degrees=[],i.sports=[],i.languages=[]}i.activatedRoute.params.subscribe(function(){var c=(0,p.A)(function*(l){i.bookingId=+l.id,i.dateBooking=l.date,i.clientIdBooking=+l.client,i.sportIdBooking=+l.sport,i.bookingId&&i.dateBooking&&i.clientIdBooking&&i.sportIdBooking?(i.spinnerService.show(),i.loadBookings()):i.goTo("home")});return function(l){return c.apply(this,arguments)}}())}});return function(s){return t.apply(this,arguments)}}())})()}getLanguageById(i){const t=this.languages.find(s=>s.id===i);return t?t.code.toUpperCase():""}getCountryById(i){const t=m.k.find(s=>s.id===i);return t?t.iso:"Aucun"}getProvinceById(i){const t=x.R.find(s=>s.id===i);return t?t.name:"Aucune"}loadBookings(){this.sportDegrees=this.degrees&&this.degrees.length>0?this.degrees.filter(t=>t.sport_id===this.sportIdBooking):[],console.log("Course-detail-level sportDegrees:",this.sportDegrees);const i={date_start:this.dateBooking,date_end:this.dateBooking};this.monitorData.active_school&&(i.school_id=this.monitorData.active_school),this.teachService.getData("teach/getAgenda",null,i).subscribe(t=>{this.processBookings(t.data.bookings)},t=>{console.error("There was an error!",t),this.spinnerService.hide()})}processBookings(i){const t=new Map;this.bookingsCurrent=[],i.forEach(s=>{if(s.course){let c=`${s.course_id}`;if(1==s.course.course_type?c=`${s.course_id}-${s.course_subgroup_id}`:2==s.course.course_type&&(c=`${s.course_id}-${s.hour_start}-${s.hour_end}`),t.has(c)){const l={...s.client,booking_client:s.booking};t.get(c).all_clients.push(l),s.id===this.bookingId&&(t.get(c).selected_detail=!0)}else{const l={...s.client,booking_client:s.booking};t.set(c,{...s,all_clients:[l],selected_detail:s.id===this.bookingId}),this.bookingsCurrent.push(t.get(c))}}}),this.selectedBooking=this.bookingsCurrent.find(s=>!0===s.selected_detail),this.selectedBooking&&this.selectedBooking.course&&this.sports&&(this.selectedBooking.course.sport=this.sports.find(s=>s.id===this.sportIdBooking)),this.spinnerService.hide(),this.getClient()}getClient(){this.spinnerService.show(),this.teachService.getData(`teach/clients/${this.clientIdBooking}`).subscribe(i=>{const t=i.data;if(t){const s=d(t.birth_date),c=d().diff(s,"years");t.birth_years=c;let l=t.sports.find(b=>b.id===this.sportIdBooking);this.spinnerService.hide(),t.degree_sport=l&&l.pivot&&l.pivot.degree_id?l.pivot.degree_id:0,this.clientMonitor=t}else this.goTo("clients")},i=>{console.error("There was an error fetching clients!",i),this.spinnerService.hide()})}getBirthYears(i){const t=d(i);return d().diff(t,"years")}goTo(...i){this.router.navigate(i)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}return(o=a).\u0275fac=function(i){return new(i||o)(e.rXU(g.Ix),e.rXU(g.nX),e.rXU(P.O),e.rXU(k.H),e.rXU(y.R),e.rXU(B.tw),e.rXU(D.D),e.rXU(M.c$))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-course-detail-level"]],decls:40,vars:18,consts:[[1,"content-size","content-background-image","status-bar-overlap"],[1,"background-color-dark","padding-wrapper"],[1,"header-content","mb-24"],["src","assets/icon/arrow-left.svg",1,"cursor-pointer","header-content-icon",3,"click"],["class","header-top-title",4,"ngIf"],["class","header-user-data mt-24",4,"ngIf"],[1,"padding-wrapper"],[1,"background-color-dark","box-radius"],["class","header-user-data padding-wrapper",4,"ngIf"],[1,"box-top-center"],[1,"box-top-left"],[1,"box-top-icon","cursor-pointer"],[4,"ngIf"],[1,"pt-24"],["class","cursor-pointer",3,"allLevels","selectLevel","size","click",4,"ngIf"],[1,"padding-wrapper","mt-8"],[1,"content-button","btn-back-primary","montserrat",3,"click"],[1,"flex-title-selector","mt-32","mb-8","cursor-pointer"],[1,"flex-title-selector-interior"],[1,"background-color-dark","flex-title-selector-icon"],["src","assets/icon/icon-observations.png"],[1,"flex-title-selector-text"],[1,"background-color-dark","box-radius","box-observations"],["class","montserrat color-light text-observations",4,"ngIf"],["src","assets/icon/icon-historic.png"],[1,"background-color-dark","box-radius","box-observations","mb-24"],[1,"header-top-title"],[1,"header-user-data","mt-24"],[1,"header-user-data-img"],[3,"src"],[1,"header-user-data-text"],[1,"header-user-data-text-top"],[1,"color-light"],[1,"header-user-data-text-title"],["src","assets/icon/icon-crown.png"],[1,"header-user-data-text-icons"],[3,"href"],["src","assets/icon/icon-phone-box.png",1,"cursor-pointer"],["src","assets/icon/icon-mail-box.png",1,"cursor-pointer"],[1,"header-user-data","padding-wrapper"],[1,"montserrat"],[1,"cursor-pointer",3,"allLevels","selectLevel","size","click"],[1,"montserrat","color-light","text-observations"],[1,"montserrat","mt-12","pt-8","pb-8","title-observations"]],template:function(i,t){1&i&&(e.j41(0,"ion-content")(1,"div",0)(2,"div",1)(3,"div",2)(4,"img",3),e.bIt("click",function(){return t.goTo("course-detail",t.bookingId,t.dateBooking)}),e.k0s(),e.DNE(5,O,2,1,"div",4),e.k0s(),e.DNE(6,w,18,11,"div",5),e.DNE(7,j,17,11,"div",5),e.k0s(),e.j41(8,"div",6)(9,"div",7),e.DNE(10,E,17,11,"div",8),e.j41(11,"div",9)(12,"div",10)(13,"div",11),e.DNE(14,G,4,2,"ng-container",12),e.k0s()()(),e.j41(15,"div",13),e.DNE(16,F,1,3,"app-level-full",14),e.j41(17,"div",15)(18,"button",16),e.bIt("click",function(){return t.goTo("client-level","course",t.bookingId,t.dateBooking,t.clientIdBooking,t.sportIdBooking)}),e.EFF(19),e.nI1(20,"translate"),e.k0s()()()(),e.j41(21,"div",17)(22,"div",18)(23,"div",19),e.nrm(24,"img",20),e.k0s(),e.j41(25,"div",21),e.EFF(26),e.nI1(27,"translate"),e.k0s()()(),e.j41(28,"div",22),e.DNE(29,T,2,1,"div",23),e.DNE(30,S,6,4,"ng-container",12),e.k0s(),e.j41(31,"div",17)(32,"div",18)(33,"div",19),e.nrm(34,"img",24),e.k0s(),e.j41(35,"div",21),e.EFF(36),e.nI1(37,"translate"),e.k0s()()(),e.j41(38,"div",25),e.DNE(39,Y,2,1,"div",23),e.k0s()()()()),2&i&&(e.R7$(5),e.Y8G("ngIf",t.selectedBooking),e.R7$(1),e.Y8G("ngIf",t.clientMonitor&&t.clientMonitor.main),e.R7$(1),e.Y8G("ngIf",t.clientMonitor&&!t.clientMonitor.main),e.R7$(3),e.Y8G("ngIf",t.clientMonitor&&t.clientMonitor.main),e.R7$(4),e.Y8G("ngIf",t.selectedBooking&&t.selectedBooking.course.sport&&t.sports.length),e.R7$(2),e.Y8G("ngIf",t.clientMonitor&&t.sportDegrees&&t.sportDegrees.length),e.R7$(3),e.SpI(" ",e.bMT(20,12,"evaluate_progress")," "),e.R7$(7),e.SpI(" ",e.bMT(27,14,"observations")," "),e.R7$(3),e.Y8G("ngIf",t.clientMonitor&&t.clientMonitor.observations.general),e.R7$(1),e.Y8G("ngIf",t.clientMonitor&&t.clientMonitor.observations.notes),e.R7$(6),e.SpI(" ",e.bMT(37,16,"historical")," "),e.R7$(3),e.Y8G("ngIf",t.clientMonitor&&t.clientMonitor.observations.historical))},dependencies:[f.bT,v.W9,I.t,M.D9],styles:[".content-wrapper[_ngcontent-%COMP%]{width:100%;min-height:100%;padding:20px 16px}.content-size[_ngcontent-%COMP%]{width:100%;min-height:100%}.padding-wrapper[_ngcontent-%COMP%]{padding:20px 16px}.dark-background[_ngcontent-%COMP%]{width:100%;min-height:100vh;background:var(--ion-back-color-dark)}.header-content[_ngcontent-%COMP%]{position:relative;top:0;left:0;width:100%;display:flex;align-items:center;justify-content:center;margin-bottom:60px}.header-content-icon[_ngcontent-%COMP%]{position:absolute;left:0;top:50%;transform:translateY(-50%);width:28px}.header-top-title[_ngcontent-%COMP%]{font-size:15px;color:#fff;font-weight:600}.header-user-data[_ngcontent-%COMP%]{display:flex;width:100%;align-items:flex-start;gap:16px}.header-user-data-img[_ngcontent-%COMP%]{width:60px;min-width:60px;height:60px;position:relative;border-radius:60px}.header-user-data-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:cover;width:100%;height:100%;border-radius:100%}.header-user-data-text[_ngcontent-%COMP%]{display:flex;width:100%;flex-direction:column;gap:4px}.header-user-data-text-top[_ngcontent-%COMP%]{display:flex;width:100%;align-items:center;justify-content:space-between}.header-user-data-text-top[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:11px}.header-user-data-text-top[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:22px}.header-user-data-text-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;font-size:17px;color:#fff;font-weight:500}.header-user-data-text-title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:24px}.header-user-data-text-subtitle[_ngcontent-%COMP%]{font-size:13px}.header-user-data-text-icons[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.header-user-data-text-icons[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:34px}.box-sport[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;align-items:center;justify-content:center;padding:18px 12px;border-radius:8px}.box-sport[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:22px}.box-sport[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:15px;color:#fff}.box-sport[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px}.box-school[_ngcontent-%COMP%]{display:block;width:300px;min-width:300px;padding:18px 12px;border-radius:8px}.box-school-icons[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px}.flex-title-selector[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.flex-title-selector-interior[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center}.flex-title-selector-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:40px;display:flex;align-items:center;justify-content:center}.flex-title-selector-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px}.flex-title-selector-text[_ngcontent-%COMP%]{color:#fff;font-size:20px;font-weight:500}.flex-title-selector-arrow[_ngcontent-%COMP%]{width:24px}.box-radius[_ngcontent-%COMP%]{width:100%;border-radius:8px}.box-top[_ngcontent-%COMP%]{padding:10px 20px;border-bottom:1px solid #43494f;display:flex;width:100%;align-items:center;justify-content:space-between}.box-top-center[_ngcontent-%COMP%]{padding:10px 20px;border-bottom:1px solid #43494f;display:flex;width:100%;align-items:center;justify-content:center}.box-top-left[_ngcontent-%COMP%]{display:flex;gap:20px;align-items:center}.box-top-icon[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;align-items:center;justify-content:center}.box-top-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:18px}.box-top-icon[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:13px}.content-button[_ngcontent-%COMP%]{width:100%;height:44px;line-height:44px;display:block;border-radius:44px;color:#000;text-align:center;font-size:14px;font-weight:500;cursor:pointer;transition:all ease-in-out .3s}.box-observations[_ngcontent-%COMP%]{padding:12px 16px}.text-observations[_ngcontent-%COMP%]{font-size:13px}.title-observations[_ngcontent-%COMP%]{font-size:15px;border-top:1px solid #444953}.list-box-selector-users[_ngcontent-%COMP%]{width:100%;overflow-x:auto;white-space:nowrap;display:flex;gap:16px;padding:8px 0;margin-bottom:-16px;justify-content:space-around}.box-selector-user-section[_ngcontent-%COMP%]{display:flex;white-space:normal;width:80px;min-width:80px;max-width:80px;padding:8px;flex-direction:column;gap:12px;align-items:center;border-radius:8px;justify-content:flex-start}.box-selector-user-section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;color:#fff;font-size:14px;line-height:1.3;text-align:center}.box-selector-user-section-title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:24px}.opacity-light[_ngcontent-%COMP%]{opacity:.6}"]}),a})()}];let z=(()=>{var o;class a{}return(o=a).\u0275fac=function(i){return new(i||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[g.iI.forChild(X),g.iI]}),a})();var N=r(5553);let U=(()=>{var o;class a{}return(o=a).\u0275fac=function(i){return new(i||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[f.MD,_.YN,v.bv,z,N.h,M.h]}),a})()},4843:(C,h,r)=>{r.d(h,{_:()=>v});var f=r(9350),_=r(7707);function v(g,p){const u="object"==typeof p;return new Promise((d,m)=>{const x=new _.Ms({next:e=>{d(e),x.unsubscribe()},error:m,complete:()=>{u?d(p.defaultValue):m(new f.G)}});g.subscribe(x)})}}}]);