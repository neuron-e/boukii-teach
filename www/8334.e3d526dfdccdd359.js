"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8334],{3822:(M,h,s)=>{s.d(h,{Gi:()=>O,Nn:()=>v,gH:()=>p});var O=function(n){return n.Aztec="AZTEC",n.Codabar="CODABAR",n.Code39="CODE_39",n.Code93="CODE_93",n.Code128="CODE_128",n.DataMatrix="DATA_MATRIX",n.Ean8="EAN_8",n.Ean13="EAN_13",n.Itf="ITF",n.Pdf417="PDF_417",n.QrCode="QR_CODE",n.UpcA="UPC_A",n.UpcE="UPC_E",n}(O||{}),p=function(n){return n.CalendarEvent="CALENDAR_EVENT",n.ContactInfo="CONTACT_INFO",n.DriversLicense="DRIVERS_LICENSE",n.Email="EMAIL",n.Geo="GEO",n.Isbn="ISBN",n.Phone="PHONE",n.Product="PRODUCT",n.Sms="SMS",n.Text="TEXT",n.Url="URL",n.Wifi="WIFI",n.Unknown="UNKNOWN",n}(p||{}),v=function(n){return n.Front="FRONT",n.Back="BACK",n}(v||{})},8334:(M,h,s)=>{s.r(h),s.d(h,{ScanPageModule:()=>R});var O=s(177),p=s(9417),C=s(8974),v=s(3314),u=s(467),P=s(7464),E=s(3822);const c=(0,P.F3)("BarcodeScanner",{web:()=>s.e(870).then(s.bind(s,870)).then(i=>new i.BarcodeScannerWeb)});var e=s(6996),n=s(4621),L=s(5794),U=s(8551),D=s(1547),S=s(5473);const W=[{path:"",component:(()=>{var i;class d{constructor(t,o,a,r,N){this.router=t,this.menuService=o,this.toastr=a,this.spinnerService=r,this.translate=N,this.handling=!1}ionViewDidEnter(){var t=this;return(0,u.A)(function*(){(yield t.requestCameraPermissions())&&(yield t.initializeScanner())})()}requestCameraPermissions(){var t=this;return(0,u.A)(function*(){try{console.log("Checking camera permissions...");const o=yield c.checkPermissions();if(console.log("Camera permissions status:",o),"granted"!==o.camera){console.log("Requesting camera permissions...");const a=yield c.requestPermissions();if(console.log("Permission request result:",a),"granted"!==a.camera)return t.toastr.error(t.translate.instant("toast.camera_permission_denied")),t.router.navigate(["/home"]),!1}return!0}catch(o){return console.error("Error requesting camera permissions:",o),t.toastr.error(t.translate.instant("toast.camera_permission_denied")),t.router.navigate(["/home"]),!1}})()}initializeScanner(){var t=this;return(0,u.A)(function*(){try{const r=document.querySelector(".qr-scanner-wrapper"),N=document.querySelector(".qr-scanner-frame"),x=document.querySelector(".ion-content-scan"),I=document.body;r&&x&&N?(r.classList.add("barcode-scanner-active"),x.classList.add("ion-content-transparent"),I.style.background="transparent",N.classList.remove("display-none")):console.error("qr-scanner-wrapper element not found"),yield c.startScan({formats:[E.Gi.QrCode]}),t.scanSub=yield c.addListener("barcodesScanned",function(){var m=(0,u.A)(function*(g){var f;if(t.handling)return;const A=null===(f=g.barcodes)||void 0===f||null===(f=f[0])||void 0===f?void 0:f.rawValue;if(A){t.handling=!0,t.spinnerService.show();try{var b;yield t.stopScanner(),yield null===(b=t.scanSub)||void 0===b?void 0:b.remove(),t.toastr.success(t.translate.instant("toast.scanned_successfully")),t.router.navigate(["/scan-booking",A])}finally{t.spinnerService.hide(),t.handling=!1}}});return function(g){return m.apply(this,arguments)}}()),yield c.addListener("scanError",m=>{var g;t.toastr.error(null!==(g=null==m?void 0:m.message)&&void 0!==g?g:t.translate.instant("toast.scan_error"))})}catch(r){var o,a;console.error("Error starting QR Code scanner:",r),console.error("Error details:",{message:null==r?void 0:r.message,stack:null==r?void 0:r.stack,name:null==r?void 0:r.name}),null!=r&&null!==(o=r.message)&&void 0!==o&&o.includes("permission")||null!=r&&null!==(a=r.message)&&void 0!==a&&a.includes("Permission")?t.toastr.error(t.translate.instant("toast.camera_permission_denied")):t.toastr.error(t.translate.instant("toast.scan_error")),yield t.stopScanner(),t.router.navigate(["/home"])}})()}stopScanner(){return(0,u.A)(function*(){const t=document.querySelector(".qr-scanner-wrapper"),o=document.querySelector(".qr-scanner-frame"),a=document.querySelector(".ion-content-scan"),r=document.body;t&&a&&o&&(t.classList.remove("barcode-scanner-active"),a.classList.remove("ion-content-transparent"),r.style.removeProperty("background"),o.classList.add("display-none")),yield c.stopScan()})()}ionViewWillLeave(){var t;this.stopScanner(),null===(t=this.scanSub)||void 0===t||t.remove()}ngOnDestroy(){var t;null===(t=this.scanSub)||void 0===t||t.remove()}toggleMenu(){this.menuService.toggleMenu()}goTo(...t){this.router.navigate(t)}}return(i=d).\u0275fac=function(t){return new(t||i)(e.rXU(v.Ix),e.rXU(n.$),e.rXU(L.tw),e.rXU(U.D),e.rXU(D.c$))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-scan"]],decls:17,vars:3,consts:[[1,"ion-content-scan"],[1,"content-size"],[1,"background-color-dark","padding-wrapper","status-bar-overlap-wrapper","header-index"],[1,"header-section-content"],[1,"header-section-title"],["src","assets/icon/icon-scan-blue.png"],["src","assets/icon/icon-menu.png",1,"header-section-menu","cursor-pointer",3,"click"],[1,"qr-scanner-wrapper"],[1,"qr-scanner-frame","display-none"],[1,"corner","top-left"],[1,"corner","top-right"],[1,"corner","bottom-left"],[1,"corner","bottom-right"],["section","scan"]],template:function(t,o){1&t&&(e.j41(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e.nrm(5,"img",5),e.j41(6,"div"),e.EFF(7),e.nI1(8,"translate"),e.k0s()(),e.j41(9,"img",6),e.bIt("click",function(){return o.toggleMenu()}),e.k0s()()(),e.j41(10,"div",7)(11,"div",8),e.nrm(12,"div",9)(13,"div",10)(14,"div",11)(15,"div",12),e.k0s()()()(),e.nrm(16,"app-footer",13)),2&t&&(e.R7$(7),e.JRh(e.bMT(8,1,"scan")))},dependencies:[C.W9,S.n,D.D9],styles:[".content-size[_ngcontent-%COMP%]{width:100%;min-height:100%}.padding-wrapper[_ngcontent-%COMP%]{padding:20px 16px}.header-section-content[_ngcontent-%COMP%]{position:relative;top:0;left:0;width:100%;display:flex;align-items:center;justify-content:center}.header-section-title[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center;justify-content:center}.header-section-title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:24px}.header-section-title[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{color:#fff;font-size:16px;font-weight:600}.header-section-menu[_ngcontent-%COMP%]{position:absolute;right:0;top:50%;transform:translateY(-50%);width:22px;display:flex;align-items:center;justify-content:center}.header-index[_ngcontent-%COMP%]{z-index:10;position:relative}.qr-scanner-wrapper[_ngcontent-%COMP%]{width:100%;height:100vh;position:fixed;top:0;left:0}.qr-scanner-frame[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:210px;height:210px;border:1px solid transparent}.corner[_ngcontent-%COMP%]{position:absolute;width:32px;height:32px;background-color:transparent;border:4px solid var(--ion-color-primary)}.top-left[_ngcontent-%COMP%]{top:0;left:0;border-bottom:none;border-right:none}.top-right[_ngcontent-%COMP%]{top:0;right:0;border-bottom:none;border-left:none}.bottom-left[_ngcontent-%COMP%]{bottom:0;left:0;border-top:none;border-right:none}.bottom-right[_ngcontent-%COMP%]{bottom:0;right:0;border-top:none;border-left:none}"]}),d})()}];let w=(()=>{var i;class d{}return(i=d).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[v.iI.forChild(W),v.iI]}),d})();var K=s(5553);let R=(()=>{var i;class d{}return(i=d).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[O.MD,p.YN,C.bv,w,K.h,D.h]}),d})()}}]);