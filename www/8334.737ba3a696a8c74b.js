"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8334],{3822:(A,p,s)=>{s.d(p,{Gi:()=>v,Nn:()=>l,gH:()=>C});var v=function(n){return n.Aztec="AZTEC",n.Codabar="CODABAR",n.Code39="CODE_39",n.Code93="CODE_93",n.Code128="CODE_128",n.DataMatrix="DATA_MATRIX",n.Ean8="EAN_8",n.Ean13="EAN_13",n.Itf="ITF",n.Pdf417="PDF_417",n.QrCode="QR_CODE",n.UpcA="UPC_A",n.UpcE="UPC_E",n}(v||{}),C=function(n){return n.CalendarEvent="CALENDAR_EVENT",n.ContactInfo="CONTACT_INFO",n.DriversLicense="DRIVERS_LICENSE",n.Email="EMAIL",n.Geo="GEO",n.Isbn="ISBN",n.Phone="PHONE",n.Product="PRODUCT",n.Sms="SMS",n.Text="TEXT",n.Url="URL",n.Wifi="WIFI",n.Unknown="UNKNOWN",n}(C||{}),l=function(n){return n.Front="FRONT",n.Back="BACK",n}(l||{})},8334:(A,p,s)=>{s.r(p),s.d(p,{ScanPageModule:()=>y});var v=s(177),C=s(9417),O=s(8974),l=s(3314),g=s(467),E=s(5083),b=s(3822);const u=(0,E.F3)("BarcodeScanner",{web:()=>s.e(870).then(s.bind(s,870)).then(r=>new r.BarcodeScannerWeb)});var e=s(6996),n=s(4621),L=s(5794),S=s(8551),x=s(1547),U=s(7473),W=s(5473);const I=function(r){return{"menu-badge-hidden":r}};function w(r,c){if(1&r&&(e.j41(0,"div",16),e.EFF(1),e.k0s()),2&r){const d=c.ngIf;e.Y8G("ngClass",e.eq3(2,I,d<=0)),e.R7$(1),e.SpI(" ",d>99?"99+":d," ")}}const R=[{path:"",component:(()=>{var r;class c{constructor(t,o,a,i,N,P){this.router=t,this.menuService=o,this.toastr=a,this.spinnerService=i,this.translate=N,this.notificationService=P,this.handling=!1,this.unreadCount$=this.notificationService.unreadCount$}ionViewDidEnter(){var t=this;return(0,g.A)(function*(){(yield t.requestCameraPermissions())&&(yield t.initializeScanner())})()}requestCameraPermissions(){var t=this;return(0,g.A)(function*(){try{console.log("Checking camera permissions...");const o=yield u.checkPermissions();if(console.log("Camera permissions status:",o),"granted"!==o.camera){console.log("Requesting camera permissions...");const a=yield u.requestPermissions();if(console.log("Permission request result:",a),"granted"!==a.camera)return t.toastr.error(t.translate.instant("toast.camera_permission_denied")),t.router.navigate(["/home"]),!1}return!0}catch(o){return console.error("Error requesting camera permissions:",o),t.toastr.error(t.translate.instant("toast.camera_permission_denied")),t.router.navigate(["/home"]),!1}})()}initializeScanner(){var t=this;return(0,g.A)(function*(){try{const i=document.querySelector(".qr-scanner-wrapper"),N=document.querySelector(".qr-scanner-frame"),P=document.querySelector(".ion-content-scan"),X=document.body;i&&P&&N?(i.classList.add("barcode-scanner-active"),P.classList.add("ion-content-transparent"),X.style.background="transparent",N.classList.remove("display-none")):console.error("qr-scanner-wrapper element not found"),yield u.startScan({formats:[b.Gi.QrCode]}),t.scanSub=yield u.addListener("barcodesScanned",function(){var h=(0,g.A)(function*(f){var m;if(t.handling)return;const M=null===(m=f.barcodes)||void 0===m||null===(m=m[0])||void 0===m?void 0:m.rawValue;if(M){t.handling=!0,t.spinnerService.show();try{var D;yield t.stopScanner(),yield null===(D=t.scanSub)||void 0===D?void 0:D.remove(),t.toastr.success(t.translate.instant("toast.scanned_successfully")),t.router.navigate(["/scan-booking",M])}finally{t.spinnerService.hide(),t.handling=!1}}});return function(f){return h.apply(this,arguments)}}()),yield u.addListener("scanError",h=>{var f;t.toastr.error(null!==(f=null==h?void 0:h.message)&&void 0!==f?f:t.translate.instant("toast.scan_error"))})}catch(i){var o,a;console.error("Error starting QR Code scanner:",i),console.error("Error details:",{message:null==i?void 0:i.message,stack:null==i?void 0:i.stack,name:null==i?void 0:i.name}),null!=i&&null!==(o=i.message)&&void 0!==o&&o.includes("permission")||null!=i&&null!==(a=i.message)&&void 0!==a&&a.includes("Permission")?t.toastr.error(t.translate.instant("toast.camera_permission_denied")):t.toastr.error(t.translate.instant("toast.scan_error")),yield t.stopScanner(),t.router.navigate(["/home"])}})()}stopScanner(){return(0,g.A)(function*(){const t=document.querySelector(".qr-scanner-wrapper"),o=document.querySelector(".qr-scanner-frame"),a=document.querySelector(".ion-content-scan"),i=document.body;t&&a&&o&&(t.classList.remove("barcode-scanner-active"),a.classList.remove("ion-content-transparent"),i.style.removeProperty("background"),o.classList.add("display-none")),yield u.stopScan()})()}ionViewWillLeave(){var t;this.stopScanner(),null===(t=this.scanSub)||void 0===t||t.remove()}ngOnDestroy(){var t;null===(t=this.scanSub)||void 0===t||t.remove()}toggleMenu(){this.menuService.toggleMenu()}goTo(...t){this.router.navigate(t)}}return(r=c).\u0275fac=function(t){return new(t||r)(e.rXU(l.Ix),e.rXU(n.$),e.rXU(L.tw),e.rXU(S.D),e.rXU(x.c$),e.rXU(U.J))},r.\u0275cmp=e.VBU({type:r,selectors:[["app-scan"]],decls:20,vars:6,consts:[[1,"ion-content-scan"],[1,"content-size"],[1,"background-color-dark","padding-wrapper","status-bar-overlap-wrapper","header-index"],[1,"header-section-content"],[1,"header-section-title"],["src","assets/icon/icon-scan-blue.png"],[1,"header-section-menu","header-menu-wrapper","cursor-pointer",3,"click"],["src","assets/icon/icon-menu.png"],["class","menu-badge",3,"ngClass",4,"ngIf"],[1,"qr-scanner-wrapper"],[1,"qr-scanner-frame","display-none"],[1,"corner","top-left"],[1,"corner","top-right"],[1,"corner","bottom-left"],[1,"corner","bottom-right"],["section","scan"],[1,"menu-badge",3,"ngClass"]],template:function(t,o){1&t&&(e.j41(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e.nrm(5,"img",5),e.j41(6,"div"),e.EFF(7),e.nI1(8,"translate"),e.k0s()(),e.j41(9,"div",6),e.bIt("click",function(){return o.toggleMenu()}),e.nrm(10,"img",7),e.DNE(11,w,2,4,"div",8),e.nI1(12,"async"),e.k0s()()(),e.j41(13,"div",9)(14,"div",10),e.nrm(15,"div",11)(16,"div",12)(17,"div",13)(18,"div",14),e.k0s()()()(),e.nrm(19,"app-footer",15)),2&t&&(e.R7$(7),e.JRh(e.bMT(8,2,"scan")),e.R7$(4),e.Y8G("ngIf",e.bMT(12,4,o.unreadCount$)))},dependencies:[v.YU,v.bT,O.W9,W.n,v.Jj,x.D9],styles:[".content-size[_ngcontent-%COMP%]{width:100%;min-height:100%}.padding-wrapper[_ngcontent-%COMP%]{padding:20px 16px}.header-section-content[_ngcontent-%COMP%]{position:relative;top:0;left:0;width:100%;display:flex;align-items:center;justify-content:center}.header-section-title[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center;justify-content:center}.header-section-title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:24px}.header-section-title[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{color:#fff;font-size:16px;font-weight:600}.header-section-menu[_ngcontent-%COMP%]{position:absolute;right:0;top:50%;transform:translateY(-50%);width:22px;display:flex;align-items:center;justify-content:center}.header-section-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:22px}.menu-badge[_ngcontent-%COMP%]{min-width:16px;height:16px;padding:0 4px;border-radius:8px;background:var(--ion-color-primary);color:#fff;font-size:10px;line-height:16px;text-align:center;position:absolute;top:-8px;right:-10px}.menu-badge-hidden[_ngcontent-%COMP%]{display:none}.header-index[_ngcontent-%COMP%]{z-index:10;position:relative}.qr-scanner-wrapper[_ngcontent-%COMP%]{width:100%;height:100vh;position:fixed;top:0;left:0}.qr-scanner-frame[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:210px;height:210px;border:1px solid transparent}.corner[_ngcontent-%COMP%]{position:absolute;width:32px;height:32px;background-color:transparent;border:4px solid var(--ion-color-primary)}.top-left[_ngcontent-%COMP%]{top:0;left:0;border-bottom:none;border-right:none}.top-right[_ngcontent-%COMP%]{top:0;right:0;border-bottom:none;border-left:none}.bottom-left[_ngcontent-%COMP%]{bottom:0;left:0;border-top:none;border-right:none}.bottom-right[_ngcontent-%COMP%]{bottom:0;right:0;border-top:none;border-left:none}"]}),c})()}];let K=(()=>{var r;class c{}return(r=c).\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[l.iI.forChild(R),l.iI]}),c})();var j=s(5553);let y=(()=>{var r;class c{}return(r=c).\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[v.MD,C.YN,O.bv,K,j.h,x.h]}),c})()}}]);