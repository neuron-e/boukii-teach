"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1280],{1280:(M,f,a)=>{a.r(f),a.d(f,{SchoolsPageModule:()=>U});var d=a(6814),b=a(6223),x=a(3582),g=a(8520),h=a(5861),l=a(6825),p=a(4036),_=a(9315),u=a(6676),t=a(2029),O=a(2234),C=a(5693),Z=a(3271),w=a(2425),y=a(7364),S=a(3911);function k(i,c){1&i&&t._UZ(0,"img",33)}function T(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"img",34),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,s=t.oxw().$implicit,r=t.oxw();return t.KtG(r.changeSchoolActive(n.id,s.id))}),t.qZA()}}const P=function(i,c){return{"box-item-img":i,"box-item-img-none":c}};function D(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"div",19)(1,"div",20)(2,"div",21)(3,"div",22),t._UZ(4,"img",23),t.qZA(),t.TgZ(5,"div",24)(6,"span",25),t._uU(7),t.qZA(),t.TgZ(8,"div",26),t._uU(9),t.qZA(),t.TgZ(10,"div",27),t._UZ(11,"img",28)(12,"img",28)(13,"img",28)(14,"img",28),t.qZA()()(),t.TgZ(15,"div",29),t.YNc(16,k,1,0,"img",30),t.YNc(17,T,1,0,"img",31),t.TgZ(18,"img",32),t.NdJ("click",function(){const s=t.CHM(e).$implicit,r=t.oxw(2);return t.KtG(r.toggleMore(s))}),t.qZA()()()()}if(2&i){const e=c.$implicit,o=t.oxw().$implicit,n=t.oxw();t.xp6(4),t.Q6J("src",e.image?e.image:"assets/icon/icon-no-image.png",t.LSH)("ngClass",t.WLB(10,P,e.image,!e.image)),t.xp6(3),t.Oqu(o.name),t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Q6J("src",e.has_ski?"assets/icon/main_ski_on.png":"assets/icon/main_ski_off.png",t.LSH),t.xp6(1),t.Q6J("src",e.has_snowboard?"assets/icon/main_snowboard_on.png":"assets/icon/main_snowboard_off.png",t.LSH),t.xp6(1),t.Q6J("src",e.has_rando?"assets/icon/main_srando_on.png":"assets/icon/main_srando_off.png",t.LSH),t.xp6(1),t.Q6J("src",e.has_telemark?"assets/icon/main_telemark_on.png":"assets/icon/main_telemark_off.png",t.LSH),t.xp6(2),t.Q6J("ngIf",e.id===n.monitorData.active_school),t.xp6(1),t.Q6J("ngIf",e.id!==n.monitorData.active_school)}}function A(i,c){if(1&i&&(t.ynx(0),t.TgZ(1,"div",14)(2,"div",15)(3,"div",16),t._uU(4),t.qZA()()(),t.TgZ(5,"div",17),t.YNc(6,D,19,13,"div",18),t.qZA(),t.BQk()),2&i){const e=c.$implicit;t.xp6(4),t.hij(" ",e.name," "),t.xp6(2),t.Q6J("ngForOf",e.schools)}}function J(i,c){if(1&i&&(t.TgZ(0,"div",35)(1,"div",20)(2,"div",21)(3,"div",22),t._UZ(4,"img",23),t.qZA(),t.TgZ(5,"div",24)(6,"div",26),t._uU(7),t.qZA(),t.TgZ(8,"div",27),t._UZ(9,"img",28)(10,"img",28)(11,"img",28)(12,"img",28),t.qZA()()()(),t.TgZ(13,"div",36)(14,"div",26),t._uU(15),t.qZA()()()),2&i){const e=t.oxw();t.xp6(4),t.Q6J("src",e.selectedSchool.image?e.selectedSchool.image:"assets/icon/icon-no-image.png",t.LSH)("ngClass",t.WLB(8,P,e.selectedSchool.image,!e.selectedSchool.image)),t.xp6(3),t.Oqu(e.selectedSchool.name),t.xp6(2),t.Q6J("src",e.selectedSchool.has_ski?"assets/icon/main_ski_on.png":"assets/icon/main_ski_off.png",t.LSH),t.xp6(1),t.Q6J("src",e.selectedSchool.has_snowboard?"assets/icon/main_snowboard_on.png":"assets/icon/main_snowboard_off.png",t.LSH),t.xp6(1),t.Q6J("src",e.selectedSchool.has_rando?"assets/icon/main_srando_on.png":"assets/icon/main_srando_off.png",t.LSH),t.xp6(1),t.Q6J("src",e.selectedSchool.has_telemark?"assets/icon/main_telemark_on.png":"assets/icon/main_telemark_off.png",t.LSH),t.xp6(3),t.Oqu(e.selectedSchool.description)}}function Y(i,c){if(1&i&&(t.TgZ(0,"div",37)(1,"a",38)(2,"div",39)(3,"div",40)(4,"div",41)(5,"div",42),t._UZ(6,"img",43),t.TgZ(7,"div",26),t._uU(8),t.ALo(9,"translate"),t.qZA()()()()()(),t.TgZ(10,"a",38)(11,"div",39)(12,"div",40)(13,"div",41)(14,"div",42),t._UZ(15,"img",43),t.TgZ(16,"div",26),t._uU(17),t.ALo(18,"translate"),t.qZA()()()()()(),t.TgZ(19,"a",38)(20,"div",44)(21,"div",40)(22,"div",41)(23,"div",42),t._UZ(24,"img",45),t.TgZ(25,"div",26),t._uU(26),t.ALo(27,"translate"),t.qZA()()()()()()()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("href","tel:"+e.selectedSchool.contact_phone,t.LSH),t.xp6(7),t.Oqu(t.lcZ(9,6,"mobile")),t.xp6(2),t.Q6J("href","tel:"+e.selectedSchool.contact_telephone,t.LSH),t.xp6(7),t.Oqu(t.lcZ(18,8,"telephone")),t.xp6(2),t.Q6J("href","mailto:"+e.selectedSchool.contact_email,t.LSH),t.xp6(7),t.Oqu(t.lcZ(27,10,"email"))}}const L=[{path:"",component:(()=>{var i;class c{constructor(o,n,s,r,m,v,z){this.router=o,this.monitorDataService=n,this.sharedDataService=s,this.teachService=r,this.toastr=m,this.spinnerService=v,this.translate=z,this.moreState="out",this.stations=[],this.schools=[],this.stationsSchools=[],this.monitorSchools=[],this.monitorStationsWithSchools=[]}ngOnInit(){var o=this;return(0,h.Z)(function*(){o.subscription=o.monitorDataService.getMonitorData().subscribe(function(){var n=(0,h.Z)(function*(s){if(s){o.spinnerService.show(),o.monitorData=s;try{o.stations=yield(0,p.z)(o.sharedDataService.fetchStations()),o.schools=yield(0,p.z)(o.sharedDataService.fetchSchools())}catch(r){console.error("Error fetching data:",r),o.toastr.error(o.translate.instant("toast.error_loading_data"))}o.fetchAllData()}});return function(s){return n.apply(this,arguments)}}(),n=>{console.error("Error fetching monitor data:",n)})})()}fetchAllData(){(0,_.D)({stationsSchools:this.teachService.getData("stations-schools"),monitorSchools:this.teachService.getData("monitors-schools")}).subscribe({next:o=>{this.stationsSchools=o.stationsSchools.data,this.monitorSchools=o.monitorSchools.data.filter(n=>n.monitor_id===this.monitorData.id),this.onlyMonitorStationsWithSchools()},error:o=>{this.spinnerService.hide(),console.error("Error fetching data:",o)}})}onlyMonitorStationsWithSchools(){const o=this.monitorSchools.map(s=>s.station_id),n=this.monitorSchools.map(s=>s.school_id);this.stations.sort((s,r)=>s.id-r.id),this.monitorStationsWithSchools=this.stations.filter(s=>o.includes(s.id)).map(s=>{let r=this.stationsSchools.filter(m=>m.station_id===s.id).map(m=>this.schools.find(v=>v.id===m.school_id&&n.includes(v.id))).filter(m=>null!=m);return{...s,schools:r}}),console.log(this.monitorStationsWithSchools),this.spinnerService.hide()}changeSchoolActive(o,n){if(o&&confirm("Etes-vous s\xfbr de vouloir changer d'\xe9cole active?")&&this.monitorData){this.spinnerService.show();const r={active_school:o,active_station:n,phone:this.monitorData.phone,telephone:this.monitorData.telephone,first_name:this.monitorData.first_name,last_name:this.monitorData.last_name,birth_date:u.utc(this.monitorData.birth_date).format("YYYY-MM-DDTHH:mm:ss.SSS")+"000Z",address:this.monitorData.address,avs:this.monitorData.avs,bank_details:this.monitorData.bank_details,children:this.monitorData.children,work_license:this.monitorData.work_license};this.teachService.updateData("monitors",this.monitorData.id,r).subscribe(m=>{this.monitorDataService.fetchMonitorData(this.monitorData.id),this.spinnerService.hide(),this.toastr.success(this.translate.instant("toast.updated_correctly")),this.goTo("home")},m=>{this.spinnerService.hide(),this.toastr.error(this.translate.instant("toast.update_failed")),console.error("Update failed",m)})}}toggleMore(o){this.moreState="in",this.selectedSchool=o}toggleMoreHide(){this.moreState="out",this.selectedSchool=null}goTo(...o){this.router.navigate(o)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}return(i=c).\u0275fac=function(o){return new(o||i)(t.Y36(g.F0),t.Y36(O.q),t.Y36(C.g),t.Y36(Z.b),t.Y36(w._W),t.Y36(y.V),t.Y36(S.sK))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-schools"]],decls:18,vars:7,consts:[[1,"content-size","content-background-image"],[1,"background-color-dark","padding-wrapper","status-bar-overlap-wrapper"],[1,"header-top"],["src","assets/icon/arrow-left.svg",1,"header-top-side-img","cursor-pointer",3,"click"],[1,"header-section-title"],["src","assets/icon/ecoles.png"],[1,"padding-wrapper"],[4,"ngFor","ngForOf"],[1,"member-modal-wrapper"],[1,"padding-wrapper","dark-background","member-modal"],[1,"header-member","mt-12"],["src","assets/icon/icon-close-box.png",1,"cursor-pointer",3,"click"],["class","pb-24 mb-8 list-boxes-item",4,"ngIf"],["class","member-list background-color-dark padding-wrapper",4,"ngIf"],[1,"flex-title-selector","mt-12","mb-24"],[1,"flex-title-selector-interior"],[1,"flex-title-selector-text"],[1,"list-boxes-school"],["class","list-boxes-item background-color-dark padding-wrapper",4,"ngFor","ngForOf"],[1,"list-boxes-item","background-color-dark","padding-wrapper"],[1,"box-item-top"],[1,"box-item-left"],[1,"box-item-left-img"],[3,"src","ngClass"],[1,"box-item-left-text"],[1,"montserrat","color-light"],[1,"montserrat"],[1,"box-item-left-text-icons"],[3,"src"],[1,"box-school-icons"],["src","assets/icon/icon-check-radius.png","class","box-item-icon cursor-pointer",4,"ngIf"],["src","assets/icon/icon-check-radius-grey.png","class","box-item-icon cursor-pointer",3,"click",4,"ngIf"],["src","assets/icon/icon-more.png",1,"box-item-icon","cursor-pointer",3,"click"],["src","assets/icon/icon-check-radius.png",1,"box-item-icon","cursor-pointer"],["src","assets/icon/icon-check-radius-grey.png",1,"box-item-icon","cursor-pointer",3,"click"],[1,"pb-24","mb-8","list-boxes-item"],[1,"box-item-bottom"],[1,"member-list","background-color-dark","padding-wrapper"],[3,"href"],[1,"pb-8","mb-8","member-list-item","cursor-pointer"],[1,"member-item-flex"],[1,"member-item-content"],[1,"member-item-title"],["src","assets/icon/icon-phone-blue.png"],[1,"member-list-item","cursor-pointer","no-border"],["src","assets/icon/icon-mail-blue.png"]],template:function(o,n){1&o&&(t.TgZ(0,"ion-content")(1,"div",0)(2,"div",1)(3,"div",2)(4,"img",3),t.NdJ("click",function(){return n.goTo("home")}),t.qZA(),t.TgZ(5,"div",4),t._UZ(6,"img",5),t.TgZ(7,"div"),t._uU(8),t.ALo(9,"translate"),t.qZA()()()(),t.TgZ(10,"div",6),t.YNc(11,A,7,2,"ng-container",7),t.qZA()()(),t.TgZ(12,"div",8)(13,"div",9)(14,"div",10)(15,"img",11),t.NdJ("click",function(){return n.toggleMoreHide()}),t.qZA()(),t.YNc(16,J,16,11,"div",12),t.YNc(17,Y,28,12,"div",13),t.qZA()()),2&o&&(t.xp6(8),t.Oqu(t.lcZ(9,5,"schools")),t.xp6(3),t.Q6J("ngForOf",n.monitorStationsWithSchools),t.xp6(1),t.Q6J("@slideInOut",n.moreState),t.xp6(4),t.Q6J("ngIf",n.selectedSchool),t.xp6(1),t.Q6J("ngIf",n.selectedSchool))},dependencies:[d.mk,d.sg,d.O5,x.W2,S.X$],styles:[".content-size[_ngcontent-%COMP%]{width:100%;min-height:100%}.padding-wrapper[_ngcontent-%COMP%]{padding:20px 16px}.header-top[_ngcontent-%COMP%]{position:relative;top:0;left:0;width:100%;display:flex;align-items:center;justify-content:center}.header-top-side-img[_ngcontent-%COMP%]{position:absolute;left:0;top:50%;transform:translateY(-50%);width:28px}.header-top-side-img-b[_ngcontent-%COMP%]{position:absolute;right:0;top:50%;transform:translateY(-50%);width:20px}.header-top-title[_ngcontent-%COMP%]{font-size:15px;color:#fff;font-weight:600}.header-section-title[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center;justify-content:center}.header-section-title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:24px}.header-section-title[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.flex-title-selector[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.flex-title-selector-interior[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center}.flex-title-selector-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:40px;display:flex;align-items:center;justify-content:center}.flex-title-selector-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px}.flex-title-selector-text[_ngcontent-%COMP%]{color:#fff;font-size:20px;font-weight:500}.flex-title-selector-arrow[_ngcontent-%COMP%]{width:24px}.list-boxes-school[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;gap:16px}.list-boxes-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;border-radius:8px}.box-item-top[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between}.box-item-bottom[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.box-item-left[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:8px}.box-item-left-img[_ngcontent-%COMP%]{width:60px;height:60px;position:relative;background:#41454e;border-radius:8px}.box-item-img-none[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:26px}.box-item-img[_ngcontent-%COMP%]{object-fit:cover;width:100%;height:100%;border-radius:8px}.box-item-left-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;font-size:16px;font-weight:500}.box-item-left-text-icons[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.box-item-left-text-icons[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:22px}.box-item-icon[_ngcontent-%COMP%]{width:24px}.box-item-button[_ngcontent-%COMP%]{padding:8px 20px;border-radius:40px}.box-school-icons[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px}.box-item-left-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px;font-weight:400}.member-modal-wrapper[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;width:100%;height:100vh;min-height:100vh;max-height:100vh;z-index:999;background:rgba(0,0,0,.7)}.member-modal[_ngcontent-%COMP%]{position:fixed;height:-moz-fit-content!important;height:fit-content!important;min-height:-moz-fit-content!important;min-height:fit-content!important;max-height:100vh;bottom:0;left:0;width:100%;overflow-y:auto;z-index:1000}.dark-background[_ngcontent-%COMP%]{width:100%;min-height:100vh;background:var(--ion-back-color-dark)}.header-member[_ngcontent-%COMP%]{position:relative;top:0;left:0;width:100%;display:flex;align-items:center;justify-content:center;margin-bottom:24px}.header-member[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:38px;position:absolute;right:0;top:50%;transform:translateY(-50%)}.member-section-text[_ngcontent-%COMP%]{display:block;color:#fff;font-size:20px;font-weight:600;text-align:center}.member-list[_ngcontent-%COMP%]{border-radius:8px;display:flex;gap:8px;flex-direction:column}.member-list-item[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center;width:100%;border-bottom:1px solid #444953}.member-item-flex[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:100%}.member-item-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.member-item-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.member-item-title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:24px}.member-item-title[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:15px;color:#fff}.member-item-subtitle[_ngcontent-%COMP%]{font-size:12px}.member-item-icon[_ngcontent-%COMP%]{width:20px}.no-border[_ngcontent-%COMP%]{border:none!important}"],data:{animation:[(0,l.X$)("slideInOut",[(0,l.SB)("in",(0,l.oB)({transform:"translateY(0)"})),(0,l.SB)("out",(0,l.oB)({transform:"translateY(100%)"})),(0,l.eR)("in => out",[(0,l.jt)("300ms ease-in-out")]),(0,l.eR)("out => in",[(0,l.jt)("300ms ease-in-out")])])]}}),c})()}];let Q=(()=>{var i;class c{}return(i=c).\u0275fac=function(o){return new(o||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[g.Bz.forChild(L),g.Bz]}),c})(),U=(()=>{var i;class c{}return(i=c).\u0275fac=function(o){return new(o||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[d.ez,b.u5,x.Pc,Q,S.aw]}),c})()},4036:(M,f,a)=>{a.d(f,{z:()=>x});var d=a(6973),b=a(305);function x(g,h){const l="object"==typeof h;return new Promise((p,_)=>{const u=new b.Hp({next:t=>{p(t),u.unsubscribe()},error:_,complete:()=>{l?p(h.defaultValue):_(new d.K)}});g.subscribe(u)})}}}]);