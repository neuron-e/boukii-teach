"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1280],{1280:(Y,p,c)=>{c.r(p),c.d(p,{SchoolsPageModule:()=>U});var g=c(6814),v=c(6223),f=c(3582),h=c(5367),x=c(5861),m=c(6825),_=c(4036),b=c(9315),S=c(6676),t=c(6689),M=c(2234),P=c(5693),C=c(3271),O=c(2425),Z=c(7364);function w(i,r){1&i&&t._UZ(0,"img",41)}function k(i,r){if(1&i){const o=t.EpF();t.TgZ(0,"img",42),t.NdJ("click",function(){t.CHM(o);const n=t.oxw().$implicit,s=t.oxw().$implicit,a=t.oxw();return t.KtG(a.changeSchoolActive(n.id,s.id))}),t.qZA()}}const u=function(i,r){return{"box-item-img":i,"box-item-img-none":r}};function y(i,r){if(1&i){const o=t.EpF();t.TgZ(0,"div",28)(1,"div",29)(2,"div",30)(3,"div",31),t._UZ(4,"img",32),t.qZA(),t.TgZ(5,"div",33)(6,"span",34),t._uU(7),t.qZA(),t.TgZ(8,"div",19),t._uU(9),t.qZA(),t.TgZ(10,"div",35),t._UZ(11,"img",36)(12,"img",36)(13,"img",36)(14,"img",36),t.qZA()()(),t.TgZ(15,"div",37),t.YNc(16,w,1,0,"img",38),t.YNc(17,k,1,0,"img",39),t.TgZ(18,"img",40),t.NdJ("click",function(){const s=t.CHM(o).$implicit,a=t.oxw(2);return t.KtG(a.toggleMore(s))}),t.qZA()()()()}if(2&i){const o=r.$implicit,e=t.oxw().$implicit,n=t.oxw();t.xp6(4),t.Q6J("src",o.image?o.image:"assets/icon/icon-no-image.png",t.LSH)("ngClass",t.WLB(10,u,o.image,!o.image)),t.xp6(3),t.Oqu(e.name),t.xp6(2),t.Oqu(o.name),t.xp6(2),t.Q6J("src",o.has_ski?"assets/icon/main_ski_on.png":"assets/icon/main_ski_off.png",t.LSH),t.xp6(1),t.Q6J("src",o.has_snowboard?"assets/icon/main_snowboard_on.png":"assets/icon/main_snowboard_off.png",t.LSH),t.xp6(1),t.Q6J("src",o.has_rando?"assets/icon/main_srando_on.png":"assets/icon/main_srando_off.png",t.LSH),t.xp6(1),t.Q6J("src",o.has_telemark?"assets/icon/main_telemark_on.png":"assets/icon/main_telemark_off.png",t.LSH),t.xp6(2),t.Q6J("ngIf",o.id===n.monitorData.active_school),t.xp6(1),t.Q6J("ngIf",o.id!==n.monitorData.active_school)}}function T(i,r){if(1&i&&(t.ynx(0),t.TgZ(1,"div",23)(2,"div",24)(3,"div",25),t._uU(4),t.qZA()()(),t.TgZ(5,"div",26),t.YNc(6,y,19,13,"div",27),t.qZA(),t.BQk()),2&i){const o=r.$implicit;t.xp6(4),t.hij(" ",o.name," "),t.xp6(2),t.Q6J("ngForOf",o.schools)}}function D(i,r){if(1&i&&(t.TgZ(0,"div",43)(1,"div",29)(2,"div",30)(3,"div",31),t._UZ(4,"img",32),t.qZA(),t.TgZ(5,"div",33)(6,"div",19),t._uU(7),t.qZA(),t.TgZ(8,"div",35),t._UZ(9,"img",36)(10,"img",36)(11,"img",36)(12,"img",36),t.qZA()()()(),t.TgZ(13,"div",44)(14,"div",19),t._uU(15),t.qZA()()()),2&i){const o=t.oxw();t.xp6(4),t.Q6J("src",o.selectedSchool.image?o.selectedSchool.image:"assets/icon/icon-no-image.png",t.LSH)("ngClass",t.WLB(8,u,o.selectedSchool.image,!o.selectedSchool.image)),t.xp6(3),t.Oqu(o.selectedSchool.name),t.xp6(2),t.Q6J("src",o.selectedSchool.has_ski?"assets/icon/main_ski_on.png":"assets/icon/main_ski_off.png",t.LSH),t.xp6(1),t.Q6J("src",o.selectedSchool.has_snowboard?"assets/icon/main_snowboard_on.png":"assets/icon/main_snowboard_off.png",t.LSH),t.xp6(1),t.Q6J("src",o.selectedSchool.has_rando?"assets/icon/main_srando_on.png":"assets/icon/main_srando_off.png",t.LSH),t.xp6(1),t.Q6J("src",o.selectedSchool.has_telemark?"assets/icon/main_telemark_on.png":"assets/icon/main_telemark_off.png",t.LSH),t.xp6(3),t.Oqu(o.selectedSchool.description)}}const J=[{path:"",component:(()=>{var i;class r{constructor(e,n,s,a,l,d){this.router=e,this.monitorDataService=n,this.sharedDataService=s,this.teachService=a,this.toastr=l,this.spinnerService=d,this.moreState="out",this.stations=[],this.schools=[],this.stationsSchools=[],this.monitorSchools=[],this.monitorStationsWithSchools=[]}ngOnInit(){var e=this;return(0,x.Z)(function*(){e.subscription=e.monitorDataService.getMonitorData().subscribe(function(){var n=(0,x.Z)(function*(s){if(s){e.spinnerService.show(),e.monitorData=s;try{e.stations=yield(0,_.z)(e.sharedDataService.fetchStations()),e.schools=yield(0,_.z)(e.sharedDataService.fetchSchools())}catch(a){console.error("Error fetching data:",a),e.toastr.error("Erreur lors du chargement des donn\xe9es")}e.fetchAllData()}});return function(s){return n.apply(this,arguments)}}(),n=>{console.error("Error fetching monitor data:",n)})})()}fetchAllData(){(0,b.D)({stationsSchools:this.teachService.getData("stations-schools"),monitorSchools:this.teachService.getData("monitors-schools")}).subscribe({next:e=>{this.stationsSchools=e.stationsSchools.data,this.monitorSchools=e.monitorSchools.data.filter(n=>n.monitor_id===this.monitorData.id),this.onlyMonitorStationsWithSchools(),console.log(this.monitorStationsWithSchools)},error:e=>{this.spinnerService.hide(),console.error("Error fetching data:",e)}})}onlyMonitorStationsWithSchools(){const e=this.monitorSchools.map(s=>s.station_id),n=this.monitorSchools.map(s=>s.school_id);this.stations.sort((s,a)=>s.id-a.id),this.monitorStationsWithSchools=this.stations.filter(s=>e.includes(s.id)).map(s=>{let a=this.stationsSchools.filter(l=>l.station_id===s.id).map(l=>this.schools.find(d=>d.id===l.school_id&&n.includes(d.id))).filter(l=>null!=l);return{...s,schools:a}}),this.spinnerService.hide()}changeSchoolActive(e,n){if(e&&confirm("Etes-vous s\xfbr de vouloir changer d'\xe9cole active?")&&this.monitorData){this.spinnerService.show(),console.log("changing active school");const a={active_school:e,active_station:n,phone:this.monitorData.phone,telephone:this.monitorData.telephone,first_name:this.monitorData.first_name,last_name:this.monitorData.last_name,birth_date:S.utc(this.monitorData.birth_date).format("YYYY-MM-DDTHH:mm:ss.SSS")+"000Z",address:this.monitorData.address,avs:this.monitorData.avs,bank_details:this.monitorData.bank_details,children:this.monitorData.children,work_license:this.monitorData.work_license};this.teachService.updateData("monitors",this.monitorData.id,a).subscribe(l=>{console.log("Update successful",l),this.monitorDataService.fetchMonitorData(this.monitorData.id),this.spinnerService.hide(),this.toastr.success("Mis \xe0 jour correctement"),this.goTo("home")},l=>{this.spinnerService.hide(),this.toastr.error("Mise \xe0 jour a \xe9chou\xe9"),console.error("Update failed",l)})}}toggleMore(e){this.moreState="in",this.selectedSchool=e}toggleMoreHide(){this.moreState="out",this.selectedSchool=null}goTo(...e){this.router.navigate(e)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}return(i=r).\u0275fac=function(e){return new(e||i)(t.Y36(h.F0),t.Y36(M.q),t.Y36(P.g),t.Y36(C.b),t.Y36(O._W),t.Y36(Z.V))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-schools"]],decls:38,vars:3,consts:[[1,"content-size","content-background-image"],[1,"background-color-dark","padding-wrapper","status-bar-overlap-wrapper"],[1,"header-top"],["src","assets/icon/arrow-left.svg",1,"header-top-side-img","cursor-pointer",3,"click"],[1,"header-section-title"],["src","assets/icon/ecoles.png"],[1,"padding-wrapper"],[4,"ngFor","ngForOf"],[1,"member-modal-wrapper"],[1,"padding-wrapper","dark-background","member-modal"],[1,"header-member","mt-12"],["src","assets/icon/icon-close-box.png",1,"cursor-pointer",3,"click"],["class","pb-24 mb-8 list-boxes-item",4,"ngIf"],[1,"member-list","background-color-dark","padding-wrapper"],[1,"pb-8","mb-8","member-list-item","cursor-pointer",3,"click"],[1,"member-item-flex"],[1,"member-item-content"],[1,"member-item-title"],["src","assets/icon/icon-message-blue.png"],[1,"montserrat"],["src","assets/icon/icon-phone-blue.png"],[1,"member-list-item","cursor-pointer","no-border",3,"click"],["src","assets/icon/icon-mail-blue.png"],[1,"flex-title-selector","mt-12","mb-24"],[1,"flex-title-selector-interior"],[1,"flex-title-selector-text"],[1,"list-boxes-school"],["class","list-boxes-item background-color-dark padding-wrapper",4,"ngFor","ngForOf"],[1,"list-boxes-item","background-color-dark","padding-wrapper"],[1,"box-item-top"],[1,"box-item-left"],[1,"box-item-left-img"],[3,"src","ngClass"],[1,"box-item-left-text"],[1,"montserrat","color-light"],[1,"box-item-left-text-icons"],[3,"src"],[1,"box-school-icons"],["src","assets/icon/icon-check-radius.png","class","box-item-icon cursor-pointer",4,"ngIf"],["src","assets/icon/icon-check-radius-grey.png","class","box-item-icon cursor-pointer",3,"click",4,"ngIf"],["src","assets/icon/icon-more.png",1,"box-item-icon","cursor-pointer",3,"click"],["src","assets/icon/icon-check-radius.png",1,"box-item-icon","cursor-pointer"],["src","assets/icon/icon-check-radius-grey.png",1,"box-item-icon","cursor-pointer",3,"click"],[1,"pb-24","mb-8","list-boxes-item"],[1,"box-item-bottom"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-content")(1,"div",0)(2,"div",1)(3,"div",2)(4,"img",3),t.NdJ("click",function(){return n.goTo("home")}),t.qZA(),t.TgZ(5,"div",4),t._UZ(6,"img",5),t.TgZ(7,"div"),t._uU(8,"\xc9coles"),t.qZA()()()(),t.TgZ(9,"div",6),t.YNc(10,T,7,2,"ng-container",7),t.qZA()()(),t.TgZ(11,"div",8)(12,"div",9)(13,"div",10)(14,"img",11),t.NdJ("click",function(){return n.toggleMoreHide()}),t.qZA()(),t.YNc(15,D,16,11,"div",12),t.TgZ(16,"div",13)(17,"div",14),t.NdJ("click",function(){return n.toggleMoreHide()}),t.TgZ(18,"div",15)(19,"div",16)(20,"div",17),t._UZ(21,"img",18),t.TgZ(22,"div",19),t._uU(23,"Message"),t.qZA()()()()(),t.TgZ(24,"div",14),t.NdJ("click",function(){return n.toggleMoreHide()}),t.TgZ(25,"div",15)(26,"div",16)(27,"div",17),t._UZ(28,"img",20),t.TgZ(29,"div",19),t._uU(30,"T\xe9l\xe9phone"),t.qZA()()()()(),t.TgZ(31,"div",21),t.NdJ("click",function(){return n.toggleMoreHide()}),t.TgZ(32,"div",15)(33,"div",16)(34,"div",17),t._UZ(35,"img",22),t.TgZ(36,"div",19),t._uU(37,"Mail"),t.qZA()()()()()()()()),2&e&&(t.xp6(10),t.Q6J("ngForOf",n.monitorStationsWithSchools),t.xp6(1),t.Q6J("@slideInOut",n.moreState),t.xp6(4),t.Q6J("ngIf",n.selectedSchool))},dependencies:[g.mk,g.sg,g.O5,f.W2],styles:[".content-size[_ngcontent-%COMP%]{width:100%;min-height:100%}.padding-wrapper[_ngcontent-%COMP%]{padding:20px 16px}.header-top[_ngcontent-%COMP%]{position:relative;top:0;left:0;width:100%;display:flex;align-items:center;justify-content:center}.header-top-side-img[_ngcontent-%COMP%]{position:absolute;left:0;top:50%;transform:translateY(-50%);width:28px}.header-top-side-img-b[_ngcontent-%COMP%]{position:absolute;right:0;top:50%;transform:translateY(-50%);width:20px}.header-top-title[_ngcontent-%COMP%]{font-size:15px;color:#fff;font-weight:600}.header-section-title[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center;justify-content:center}.header-section-title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:24px}.header-section-title[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.flex-title-selector[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.flex-title-selector-interior[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center}.flex-title-selector-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:40px;display:flex;align-items:center;justify-content:center}.flex-title-selector-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px}.flex-title-selector-text[_ngcontent-%COMP%]{color:#fff;font-size:20px;font-weight:500}.flex-title-selector-arrow[_ngcontent-%COMP%]{width:24px}.list-boxes-school[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;gap:16px}.list-boxes-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;border-radius:8px}.box-item-top[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between}.box-item-bottom[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.box-item-left[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:8px}.box-item-left-img[_ngcontent-%COMP%]{width:60px;height:60px;position:relative;background:#41454e;border-radius:8px}.box-item-img-none[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:26px}.box-item-img[_ngcontent-%COMP%]{object-fit:cover;width:100%;height:100%;border-radius:8px}.box-item-left-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;font-size:16px;font-weight:500}.box-item-left-text-icons[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.box-item-left-text-icons[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:22px}.box-item-icon[_ngcontent-%COMP%]{width:24px}.box-item-button[_ngcontent-%COMP%]{padding:8px 20px;border-radius:40px}.box-school-icons[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px}.box-item-left-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px;font-weight:400}.member-modal-wrapper[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;width:100%;height:100vh;min-height:100vh;max-height:100vh;z-index:999;background:rgba(0,0,0,.7)}.member-modal[_ngcontent-%COMP%]{position:fixed;height:-moz-fit-content!important;height:fit-content!important;min-height:-moz-fit-content!important;min-height:fit-content!important;max-height:100vh;bottom:0;left:0;width:100%;overflow-y:auto;z-index:1000}.dark-background[_ngcontent-%COMP%]{width:100%;min-height:100vh;background:var(--ion-back-color-dark)}.header-member[_ngcontent-%COMP%]{position:relative;top:0;left:0;width:100%;display:flex;align-items:center;justify-content:center;margin-bottom:24px}.header-member[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:38px;position:absolute;right:0;top:50%;transform:translateY(-50%)}.member-section-text[_ngcontent-%COMP%]{display:block;color:#fff;font-size:20px;font-weight:600;text-align:center}.member-list[_ngcontent-%COMP%]{border-radius:8px;display:flex;gap:8px;flex-direction:column}.member-list-item[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center;width:100%;border-bottom:1px solid #444953}.member-item-flex[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:100%}.member-item-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.member-item-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.member-item-title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:24px}.member-item-title[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:15px;color:#fff}.member-item-subtitle[_ngcontent-%COMP%]{font-size:12px}.member-item-icon[_ngcontent-%COMP%]{width:20px}.no-border[_ngcontent-%COMP%]{border:none!important}"],data:{animation:[(0,m.X$)("slideInOut",[(0,m.SB)("in",(0,m.oB)({transform:"translateY(0)"})),(0,m.SB)("out",(0,m.oB)({transform:"translateY(100%)"})),(0,m.eR)("in => out",[(0,m.jt)("300ms ease-in-out")]),(0,m.eR)("out => in",[(0,m.jt)("300ms ease-in-out")])])]}}),r})()}];let A=(()=>{var i;class r{}return(i=r).\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[h.Bz.forChild(J),h.Bz]}),r})(),U=(()=>{var i;class r{}return(i=r).\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[g.ez,v.u5,f.Pc,A]}),r})()}}]);