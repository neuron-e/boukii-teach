"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1566],{1566:(P,f,s)=>{s.r(f),s.d(f,{SchoolsPageModule:()=>F});var m=s(177),u=s(9417),_=s(8974),h=s(3314),g=s(467),l=s(9969),p=s(4843),x=s(7468),b=s(7586),t=s(6996),M=s(5663),C=s(918),O=s(4387),k=s(5794),w=s(8551),v=s(1547);function y(i,r){1&i&&t.nrm(0,"img",33)}function D(i,r){if(1&i){const e=t.RV6();t.j41(0,"img",34),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,a=t.XpG().$implicit,c=t.XpG();return t.Njj(c.changeSchoolActive(n.id,a.id))}),t.k0s()}}const S=function(i,r){return{"box-item-img":i,"box-item-img-none":r}};function R(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",19)(1,"div",20)(2,"div",21)(3,"div",22),t.nrm(4,"img",23),t.k0s(),t.j41(5,"div",24)(6,"span",25),t.EFF(7),t.k0s(),t.j41(8,"div",26),t.EFF(9),t.k0s(),t.j41(10,"div",27),t.nrm(11,"img",28)(12,"img",28)(13,"img",28)(14,"img",28),t.k0s()()(),t.j41(15,"div",29),t.DNE(16,y,1,0,"img",30),t.DNE(17,D,1,0,"img",31),t.j41(18,"img",32),t.bIt("click",function(){const a=t.eBV(e).$implicit,c=t.XpG(2);return t.Njj(c.toggleMore(a))}),t.k0s()()()()}if(2&i){const e=r.$implicit,o=t.XpG().$implicit,n=t.XpG();t.R7$(4),t.Y8G("src",e.image?e.image:"assets/icon/icon-no-image.png",t.B4B)("ngClass",t.l_i(10,S,e.image,!e.image)),t.R7$(3),t.JRh(o.name),t.R7$(2),t.JRh(e.name),t.R7$(2),t.Y8G("src",e.has_ski?"assets/icon/main_ski_on.png":"assets/icon/main_ski_off.png",t.B4B),t.R7$(1),t.Y8G("src",e.has_snowboard?"assets/icon/main_snowboard_on.png":"assets/icon/main_snowboard_off.png",t.B4B),t.R7$(1),t.Y8G("src",e.has_rando?"assets/icon/main_srando_on.png":"assets/icon/main_srando_off.png",t.B4B),t.R7$(1),t.Y8G("src",e.has_telemark?"assets/icon/main_telemark_on.png":"assets/icon/main_telemark_off.png",t.B4B),t.R7$(2),t.Y8G("ngIf",e.id===n.monitorData.active_school),t.R7$(1),t.Y8G("ngIf",e.id!==n.monitorData.active_school)}}function j(i,r){if(1&i&&(t.qex(0),t.j41(1,"div",14)(2,"div",15)(3,"div",16),t.EFF(4),t.k0s()()(),t.j41(5,"div",17),t.DNE(6,R,19,13,"div",18),t.k0s(),t.bVm()),2&i){const e=r.$implicit;t.R7$(4),t.SpI(" ",e.name," "),t.R7$(2),t.Y8G("ngForOf",e.schools)}}function $(i,r){if(1&i&&(t.j41(0,"div",35)(1,"div",20)(2,"div",21)(3,"div",22),t.nrm(4,"img",23),t.k0s(),t.j41(5,"div",24)(6,"div",26),t.EFF(7),t.k0s(),t.j41(8,"div",27),t.nrm(9,"img",28)(10,"img",28)(11,"img",28)(12,"img",28),t.k0s()()()(),t.j41(13,"div",36)(14,"div",26),t.EFF(15),t.k0s()()()),2&i){const e=t.XpG();t.R7$(4),t.Y8G("src",e.selectedSchool.image?e.selectedSchool.image:"assets/icon/icon-no-image.png",t.B4B)("ngClass",t.l_i(8,S,e.selectedSchool.image,!e.selectedSchool.image)),t.R7$(3),t.JRh(e.selectedSchool.name),t.R7$(2),t.Y8G("src",e.selectedSchool.has_ski?"assets/icon/main_ski_on.png":"assets/icon/main_ski_off.png",t.B4B),t.R7$(1),t.Y8G("src",e.selectedSchool.has_snowboard?"assets/icon/main_snowboard_on.png":"assets/icon/main_snowboard_off.png",t.B4B),t.R7$(1),t.Y8G("src",e.selectedSchool.has_rando?"assets/icon/main_srando_on.png":"assets/icon/main_srando_off.png",t.B4B),t.R7$(1),t.Y8G("src",e.selectedSchool.has_telemark?"assets/icon/main_telemark_on.png":"assets/icon/main_telemark_off.png",t.B4B),t.R7$(3),t.JRh(e.selectedSchool.description)}}function Y(i,r){if(1&i&&(t.j41(0,"div",37)(1,"a",38)(2,"div",39)(3,"div",40)(4,"div",41)(5,"div",42),t.nrm(6,"img",43),t.j41(7,"div",26),t.EFF(8),t.nI1(9,"translate"),t.k0s()()()()()(),t.j41(10,"a",38)(11,"div",39)(12,"div",40)(13,"div",41)(14,"div",42),t.nrm(15,"img",43),t.j41(16,"div",26),t.EFF(17),t.nI1(18,"translate"),t.k0s()()()()()(),t.j41(19,"a",38)(20,"div",44)(21,"div",40)(22,"div",41)(23,"div",42),t.nrm(24,"img",45),t.j41(25,"div",26),t.EFF(26),t.nI1(27,"translate"),t.k0s()()()()()()()),2&i){const e=t.XpG();t.R7$(1),t.Y8G("href","tel:"+e.selectedSchool.contact_phone,t.B4B),t.R7$(7),t.JRh(t.bMT(9,6,"mobile")),t.R7$(2),t.Y8G("href","tel:"+e.selectedSchool.contact_telephone,t.B4B),t.R7$(7),t.JRh(t.bMT(18,8,"telephone")),t.R7$(2),t.Y8G("href","mailto:"+e.selectedSchool.contact_email,t.B4B),t.R7$(7),t.JRh(t.bMT(27,10,"email"))}}const G=[{path:"",component:(()=>{var i;class r{constructor(o,n,a,c,d,E,I){this.router=o,this.monitorDataService=n,this.sharedDataService=a,this.teachService=c,this.toastr=d,this.spinnerService=E,this.translate=I,this.moreState="out",this.stations=[],this.schools=[],this.stationsSchools=[],this.monitorSchools=[],this.monitorStationsWithSchools=[]}ngOnInit(){var o=this;return(0,g.A)(function*(){o.subscription=o.monitorDataService.getMonitorData().subscribe(function(){var n=(0,g.A)(function*(a){if(a){o.spinnerService.show(),o.monitorData=a;try{o.stations=yield(0,p._)(o.sharedDataService.fetchStations()),o.schools=yield(0,p._)(o.sharedDataService.fetchSchools())}catch(c){console.error("Error fetching data:",c),o.toastr.error(o.translate.instant("toast.error_loading_data"))}o.fetchAllData()}});return function(a){return n.apply(this,arguments)}}(),n=>{console.error("Error fetching monitor data:",n)})})()}fetchAllData(){(0,x.p)({stationsSchools:this.teachService.getData("stations-schools"),monitorSchools:this.teachService.getData("monitors-schools")}).subscribe({next:o=>{this.stationsSchools=o.stationsSchools.data,this.monitorSchools=o.monitorSchools.data.filter(n=>n.monitor_id===this.monitorData.id),this.onlyMonitorStationsWithSchools()},error:o=>{this.spinnerService.hide(),console.error("Error fetching data:",o)}})}onlyMonitorStationsWithSchools(){const o=this.monitorSchools.map(n=>n.school_id);this.stations.sort((n,a)=>n.id-a.id),this.monitorStationsWithSchools=this.stations.map(n=>{let a=this.stationsSchools.filter(c=>c.station_id===n.id&&o.includes(c.school_id)).map(c=>this.schools.find(d=>d.id===c.school_id)).filter(c=>null!=c);return{...n,schools:a}}).filter(n=>n.schools.length>0),this.spinnerService.hide()}changeSchoolActive(o,n){if(o&&confirm("Etes-vous s\xfbr de vouloir changer d'\xe9cole active?")&&this.monitorData){this.spinnerService.show();const c={active_school:o,active_station:n,phone:this.monitorData.phone,telephone:this.monitorData.telephone,first_name:this.monitorData.first_name,last_name:this.monitorData.last_name,birth_date:b.utc(this.monitorData.birth_date).format("YYYY-MM-DDTHH:mm:ss.SSS")+"000Z",address:this.monitorData.address,avs:this.monitorData.avs,bank_details:this.monitorData.bank_details,children:this.monitorData.children,work_license:this.monitorData.work_license};this.teachService.updateData("monitors",this.monitorData.id,c).subscribe(d=>{this.monitorDataService.fetchMonitorData(this.monitorData.id),this.spinnerService.hide(),this.toastr.success(this.translate.instant("toast.updated_correctly")),this.goTo("home")},d=>{this.spinnerService.hide(),this.toastr.error(this.translate.instant("toast.update_failed")),console.error("Update failed",d)})}}toggleMore(o){this.moreState="in",this.selectedSchool=o}toggleMoreHide(){this.moreState="out",this.selectedSchool=null}goTo(...o){this.router.navigate(o)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}return(i=r).\u0275fac=function(o){return new(o||i)(t.rXU(h.Ix),t.rXU(M.O),t.rXU(C.H),t.rXU(O.R),t.rXU(k.tw),t.rXU(w.D),t.rXU(v.c$))},i.\u0275cmp=t.VBU({type:i,selectors:[["app-schools"]],decls:18,vars:7,consts:[[1,"content-size","content-background-image"],[1,"background-color-dark","padding-wrapper","status-bar-overlap-wrapper"],[1,"header-top"],["src","assets/icon/arrow-left.svg",1,"header-top-side-img","cursor-pointer",3,"click"],[1,"header-section-title"],["src","assets/icon/ecoles.png"],[1,"padding-wrapper"],[4,"ngFor","ngForOf"],[1,"member-modal-wrapper"],[1,"padding-wrapper","dark-background","member-modal"],[1,"header-member","mt-12"],["src","assets/icon/icon-close-box.png",1,"cursor-pointer",3,"click"],["class","pb-24 mb-8 list-boxes-item",4,"ngIf"],["class","member-list background-color-dark padding-wrapper",4,"ngIf"],[1,"flex-title-selector","mt-12","mb-24"],[1,"flex-title-selector-interior"],[1,"flex-title-selector-text"],[1,"list-boxes-school"],["class","list-boxes-item background-color-dark padding-wrapper",4,"ngFor","ngForOf"],[1,"list-boxes-item","background-color-dark","padding-wrapper"],[1,"box-item-top"],[1,"box-item-left"],[1,"box-item-left-img"],[3,"src","ngClass"],[1,"box-item-left-text"],[1,"montserrat","color-light"],[1,"montserrat"],[1,"box-item-left-text-icons"],[3,"src"],[1,"box-school-icons"],["src","assets/icon/icon-check-radius.png","class","box-item-icon cursor-pointer",4,"ngIf"],["src","assets/icon/icon-check-radius-grey.png","class","box-item-icon cursor-pointer",3,"click",4,"ngIf"],["src","assets/icon/icon-more.png",1,"box-item-icon","cursor-pointer",3,"click"],["src","assets/icon/icon-check-radius.png",1,"box-item-icon","cursor-pointer"],["src","assets/icon/icon-check-radius-grey.png",1,"box-item-icon","cursor-pointer",3,"click"],[1,"pb-24","mb-8","list-boxes-item"],[1,"box-item-bottom"],[1,"member-list","background-color-dark","padding-wrapper"],[3,"href"],[1,"pb-8","mb-8","member-list-item","cursor-pointer"],[1,"member-item-flex"],[1,"member-item-content"],[1,"member-item-title"],["src","assets/icon/icon-phone-blue.png"],[1,"member-list-item","cursor-pointer","no-border"],["src","assets/icon/icon-mail-blue.png"]],template:function(o,n){1&o&&(t.j41(0,"ion-content")(1,"div",0)(2,"div",1)(3,"div",2)(4,"img",3),t.bIt("click",function(){return n.goTo("home")}),t.k0s(),t.j41(5,"div",4),t.nrm(6,"img",5),t.j41(7,"div"),t.EFF(8),t.nI1(9,"translate"),t.k0s()()()(),t.j41(10,"div",6),t.DNE(11,j,7,2,"ng-container",7),t.k0s()()(),t.j41(12,"div",8)(13,"div",9)(14,"div",10)(15,"img",11),t.bIt("click",function(){return n.toggleMoreHide()}),t.k0s()(),t.DNE(16,$,16,11,"div",12),t.DNE(17,Y,28,12,"div",13),t.k0s()()),2&o&&(t.R7$(8),t.JRh(t.bMT(9,5,"schools")),t.R7$(3),t.Y8G("ngForOf",n.monitorStationsWithSchools),t.R7$(1),t.Y8G("@slideInOut",n.moreState),t.R7$(4),t.Y8G("ngIf",n.selectedSchool),t.R7$(1),t.Y8G("ngIf",n.selectedSchool))},dependencies:[m.YU,m.Sq,m.bT,_.W9,v.D9],styles:[".content-size[_ngcontent-%COMP%]{width:100%;min-height:100%}.padding-wrapper[_ngcontent-%COMP%]{padding:20px 16px}.header-top[_ngcontent-%COMP%]{position:relative;top:0;left:0;width:100%;display:flex;align-items:center;justify-content:center}.header-top-side-img[_ngcontent-%COMP%]{position:absolute;left:0;top:50%;transform:translateY(-50%);width:28px}.header-top-side-img-b[_ngcontent-%COMP%]{position:absolute;right:0;top:50%;transform:translateY(-50%);width:20px}.header-top-title[_ngcontent-%COMP%]{font-size:15px;color:#fff;font-weight:600}.header-section-title[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center;justify-content:center}.header-section-title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:24px}.header-section-title[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.flex-title-selector[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.flex-title-selector-interior[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center}.flex-title-selector-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:40px;display:flex;align-items:center;justify-content:center}.flex-title-selector-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px}.flex-title-selector-text[_ngcontent-%COMP%]{color:#fff;font-size:20px;font-weight:500}.flex-title-selector-arrow[_ngcontent-%COMP%]{width:24px}.list-boxes-school[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;gap:16px}.list-boxes-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;border-radius:8px}.box-item-top[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between}.box-item-bottom[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.box-item-left[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:8px}.box-item-left-img[_ngcontent-%COMP%]{width:60px;height:60px;position:relative;background:#41454e;border-radius:8px}.box-item-img-none[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:26px}.box-item-img[_ngcontent-%COMP%]{object-fit:cover;width:100%;height:100%;border-radius:8px}.box-item-left-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;font-size:16px;font-weight:500}.box-item-left-text-icons[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.box-item-left-text-icons[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:22px}.box-item-icon[_ngcontent-%COMP%]{width:24px}.box-item-button[_ngcontent-%COMP%]{padding:8px 20px;border-radius:40px}.box-school-icons[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px}.box-item-left-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px;font-weight:400}.member-modal-wrapper[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;width:100%;height:100vh;min-height:100vh;max-height:100vh;z-index:999;background:rgba(0,0,0,.7)}.member-modal[_ngcontent-%COMP%]{position:fixed;height:-moz-fit-content!important;height:fit-content!important;min-height:-moz-fit-content!important;min-height:fit-content!important;max-height:100vh;bottom:0;left:0;width:100%;overflow-y:auto;z-index:1000}.dark-background[_ngcontent-%COMP%]{width:100%;min-height:100vh;background:var(--ion-back-color-dark)}.header-member[_ngcontent-%COMP%]{position:relative;top:0;left:0;width:100%;display:flex;align-items:center;justify-content:center;margin-bottom:24px}.header-member[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:38px;position:absolute;right:0;top:50%;transform:translateY(-50%)}.member-section-text[_ngcontent-%COMP%]{display:block;color:#fff;font-size:20px;font-weight:600;text-align:center}.member-list[_ngcontent-%COMP%]{border-radius:8px;display:flex;gap:8px;flex-direction:column}.member-list-item[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center;width:100%;border-bottom:1px solid #444953}.member-item-flex[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:100%}.member-item-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.member-item-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.member-item-title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:24px}.member-item-title[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:15px;color:#fff}.member-item-subtitle[_ngcontent-%COMP%]{font-size:12px}.member-item-icon[_ngcontent-%COMP%]{width:20px}.no-border[_ngcontent-%COMP%]{border:none!important}"],data:{animation:[(0,l.hZ)("slideInOut",[(0,l.wk)("in",(0,l.iF)({transform:"translateY(0)"})),(0,l.wk)("out",(0,l.iF)({transform:"translateY(100%)"})),(0,l.kY)("in => out",[(0,l.i0)("300ms ease-in-out")]),(0,l.kY)("out => in",[(0,l.i0)("300ms ease-in-out")])])]}}),r})()}];let B=(()=>{var i;class r{}return(i=r).\u0275fac=function(o){return new(o||i)},i.\u0275mod=t.$C({type:i}),i.\u0275inj=t.G2t({imports:[h.iI.forChild(G),h.iI]}),r})(),F=(()=>{var i;class r{}return(i=r).\u0275fac=function(o){return new(o||i)},i.\u0275mod=t.$C({type:i}),i.\u0275inj=t.G2t({imports:[m.MD,u.YN,_.bv,B,v.h]}),r})()},4843:(P,f,s)=>{s.d(f,{_:()=>_});var m=s(9350),u=s(7707);function _(h,g){const l="object"==typeof g;return new Promise((p,x)=>{const b=new u.Ms({next:t=>{p(t),b.unsubscribe()},error:x,complete:()=>{l?p(g.defaultValue):x(new m.G)}});h.subscribe(b)})}}}]);