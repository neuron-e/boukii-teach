(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6686],{6110:(Y,j,H)=>{"use strict";H.d(j,{P:()=>v});var T=H(467),t=H(6996),x=H(7464),G=function(c){return c.Prompt="PROMPT",c.Camera="CAMERA",c.Photos="PHOTOS",c}(G||{}),y=function(c){return c.Rear="REAR",c.Front="FRONT",c}(y||{}),b=function(c){return c.Uri="uri",c.Base64="base64",c.DataUrl="dataUrl",c}(b||{});class i extends x.E_{getPhoto(o){var h=this;return(0,T.A)(function*(){return new Promise(function(){var f=(0,T.A)(function*(s,w){if(o.webUseInput||o.source===G.Photos)h.fileInputExperience(o,s,w);else if(o.source===G.Prompt){let m=document.querySelector("pwa-action-sheet");m||(m=document.createElement("pwa-action-sheet"),document.body.appendChild(m)),m.header=o.promptLabelHeader||"Photo",m.cancelable=!1,m.options=[{title:o.promptLabelPhoto||"From Photos"},{title:o.promptLabelPicture||"Take Picture"}],m.addEventListener("onSelection",function(){var C=(0,T.A)(function*(F){0===F.detail?h.fileInputExperience(o,s,w):h.cameraExperience(o,s,w)});return function(F){return C.apply(this,arguments)}}())}else h.cameraExperience(o,s,w)});return function(s,w){return f.apply(this,arguments)}}())})()}pickImages(o){var h=this;return(0,T.A)(function*(){return new Promise(function(){var f=(0,T.A)(function*(s,w){h.multipleFileInputExperience(s,w)});return function(s,w){return f.apply(this,arguments)}}())})()}cameraExperience(o,h,f){var s=this;return(0,T.A)(function*(){if(customElements.get("pwa-camera-modal")){const w=document.createElement("pwa-camera-modal");w.facingMode=o.direction===y.Front?"user":"environment",document.body.appendChild(w);try{yield w.componentOnReady(),w.addEventListener("onPhoto",function(){var m=(0,T.A)(function*(C){const F=C.detail;null===F?f(new x.I9("User cancelled photos app")):F instanceof Error?f(F):h(yield s._getCameraPhoto(F,o)),w.dismiss(),document.body.removeChild(w)});return function(C){return m.apply(this,arguments)}}()),w.present()}catch{s.fileInputExperience(o,h,f)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),s.fileInputExperience(o,h,f)})()}fileInputExperience(o,h,f){let s=document.querySelector("#_capacitor-camera-input");const w=()=>{var m;null===(m=s.parentNode)||void 0===m||m.removeChild(s)};s||(s=document.createElement("input"),s.id="_capacitor-camera-input",s.type="file",s.hidden=!0,document.body.appendChild(s),s.addEventListener("change",m=>{const C=s.files[0];let F="jpeg";if("image/png"===C.type?F="png":"image/gif"===C.type&&(F="gif"),"dataUrl"===o.resultType||"base64"===o.resultType){const Q=new FileReader;Q.addEventListener("load",()=>{if("dataUrl"===o.resultType)h({dataUrl:Q.result,format:F});else if("base64"===o.resultType){const k=Q.result.split(",")[1];h({base64String:k,format:F})}w()}),Q.readAsDataURL(C)}else h({webPath:URL.createObjectURL(C),format:F}),w()}),s.addEventListener("cancel",m=>{f(new x.I9("User cancelled photos app")),w()})),s.accept="image/*",s.capture=!0,o.source===G.Photos||o.source===G.Prompt?s.removeAttribute("capture"):o.direction===y.Front?s.capture="user":o.direction===y.Rear&&(s.capture="environment"),s.click()}multipleFileInputExperience(o,h){let f=document.querySelector("#_capacitor-camera-input-multiple");const s=()=>{var w;null===(w=f.parentNode)||void 0===w||w.removeChild(f)};f||(f=document.createElement("input"),f.id="_capacitor-camera-input-multiple",f.type="file",f.hidden=!0,f.multiple=!0,document.body.appendChild(f),f.addEventListener("change",w=>{const m=[];for(let C=0;C<f.files.length;C++){const F=f.files[C];let Q="jpeg";"image/png"===F.type?Q="png":"image/gif"===F.type&&(Q="gif"),m.push({webPath:URL.createObjectURL(F),format:Q})}o({photos:m}),s()}),f.addEventListener("cancel",w=>{h(new x.I9("User cancelled photos app")),s()})),f.accept="image/*",f.click()}_getCameraPhoto(o,h){return new Promise((f,s)=>{const w=new FileReader,m=o.type.split("/")[1];"uri"===h.resultType?f({webPath:URL.createObjectURL(o),format:m,saved:!1}):(w.readAsDataURL(o),w.onloadend=()=>{const C=w.result;f("dataUrl"===h.resultType?{dataUrl:C,format:m,saved:!1}:{base64String:C.split(",")[1],format:m,saved:!1})},w.onerror=C=>{s(C)})})}checkPermissions(){var o=this;return(0,T.A)(function*(){if(typeof navigator>"u"||!navigator.permissions)throw o.unavailable("Permissions API not available in this browser");try{return{camera:(yield window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw o.unavailable("Camera permissions are not available in this browser")}})()}requestPermissions(){var o=this;return(0,T.A)(function*(){throw o.unimplemented("Not implemented on web.")})()}pickLimitedLibraryPhotos(){var o=this;return(0,T.A)(function*(){throw o.unavailable("Not implemented on web.")})()}getLimitedLibraryPhotos(){var o=this;return(0,T.A)(function*(){throw o.unavailable("Not implemented on web.")})()}}new i;const A=(0,x.F3)("Camera",{web:()=>new i});var l=H(101),e=H(177),r=H(1547);function E(c,o){if(1&c){const h=t.RV6();t.j41(0,"button",7),t.bIt("click",function(){t.eBV(h),t.XpG();const s=t.sdS(17);return t.Njj(s.click())}),t.EFF(1),t.nI1(2,"translate"),t.k0s()}2&c&&(t.R7$(1),t.JRh(t.bMT(2,1,"record_video")))}function u(c,o){if(1&c&&t.nrm(0,"img",18),2&c){const h=t.XpG(2);t.Y8G("src",h.filePreview,t.B4B)}}function d(c,o){if(1&c&&t.nrm(0,"video",19),2&c){const h=t.XpG(2);t.Y8G("src",h.filePreview,t.B4B)}}function I(c,o){if(1&c){const h=t.RV6();t.j41(0,"div",14),t.DNE(1,u,1,1,"img",15),t.DNE(2,d,1,1,"video",16),t.j41(3,"button",17),t.bIt("click",function(){t.eBV(h);const s=t.XpG();return t.Njj(s.saveFile())}),t.EFF(4),t.nI1(5,"translate"),t.k0s()()}if(2&c){const h=t.XpG();t.R7$(1),t.Y8G("ngIf",!h.isVideo),t.R7$(1),t.Y8G("ngIf",h.isVideo),t.R7$(2),t.JRh(t.bMT(5,3,"save"))}}let v=(()=>{var c;class o{constructor(){this.title="T\xe9l\xe9verser un fichier",this.allowImage=!0,this.allowVideo=!0,this.isVideo=!1,this.close=new t.bkB,this.fileSelected=new t.bkB}onFileSelected(f){const s=f.target;if(s.files&&s.files.length>0){const w=s.files[0];this.isVideo=w.type.startsWith("video"),this.isVideo?this.previewVideo(w):this.resizeAndPreviewImage(w)}}onVideoSelected(f){const s=f.target;if(s.files&&s.files.length>0){const w=s.files[0];this.isVideo=!0,this.previewVideo(w)}}openCamera(){var f=this;return(0,T.A)(function*(){try{const s=yield A.getPhoto({quality:90,allowEditing:!1,resultType:b.Uri,source:G.Camera});if(f.isVideo="video"===s.format,f.isVideo)f.filePreview=s.webPath,f.fileResult={base64:s.webPath,isVideo:!0};else{const w=yield fetch(s.webPath).then(m=>m.blob());f.resizeAndPreviewImage(w)}}catch(s){console.error("Error accessing camera or gallery",s)}})()}resizeAndPreviewImage(f){this.resizeImage(f,600).then(w=>{this.filePreview=w,this.fileResult={base64:w,isVideo:!1}}).catch(w=>{console.error("Error resizing image:",w)})}previewVideo(f){const s=new FileReader;s.onload=()=>{this.filePreview=s.result,this.fileResult={base64:s.result,isVideo:!0}},s.readAsDataURL(f)}saveFile(){this.fileResult&&(this.fileSelected.emit(this.fileResult),this.close.emit())}doCloseModal(){this.close.emit()}get acceptTypes(){let f="";return this.allowImage&&(f+="image/*"),this.allowVideo&&(f+=this.allowImage?",video/*":"video/*"),f}resizeImage(f,s){return new Promise((w,m)=>{const C="image/png"===f.type,Q=["image/png","image/gif","image/avif","image/bmp","image/tiff","image/ico","image/heic"].includes(f.type)?"image/jpeg":f.type||"image/jpeg",k=new FileReader;k.onload=M=>{const S=new Image;S.src=M.target.result,S.onload=()=>{let R=S.width,a=S.height;if(R>s||a>s)if(R>a){const B=s/R;R=s,a*=B}else{const B=s/a;a=s,R*=B}const p=document.createElement("canvas");if(p.width=R,p.height=a,C){const B=p.getContext("2d");B.fillStyle="white",B.fillRect(0,0,p.width,p.height)}const g=document.createElement("canvas");g.width=R,g.height=a,l().resize(S,g).then(B=>(p.getContext("2d").drawImage(g,0,0,R,a),l().toBlob(p,Q,.6))).then(B=>{const _=new FileReader;_.onloadend=()=>w(_.result),_.readAsDataURL(B)}).catch(m)}},k.readAsDataURL(f)})}}return(c=o).\u0275fac=function(f){return new(f||c)},c.\u0275cmp=t.VBU({type:c,selectors:[["app-file-upload"]],inputs:{title:"title",allowImage:"allowImage",allowVideo:"allowVideo"},outputs:{close:"close",fileSelected:"fileSelected"},decls:20,vars:10,consts:[[1,"modal"],[1,"modal-content","content-background-image"],["src","assets/icon/icons-outline-close.svg",1,"cursor-pointer","modal-close",3,"click"],[1,"title-upload","mt-24","mb-24"],[1,"file-upload"],["type","file",2,"display","none",3,"accept","change"],["fileInput",""],[1,"content-button","btn-back-grey","montserrat",3,"click"],[1,"camera-upload","mt-12"],[1,"file-upload","mt-12"],["type","file","accept","video/*","capture","user",2,"display","none",3,"change"],["videoInput",""],["class","content-button btn-back-grey montserrat",3,"click",4,"ngIf"],["class","mt-24 mb-32",4,"ngIf"],[1,"mt-24","mb-32"],["class","preview",3,"src",4,"ngIf"],["class","preview","muted","","playsinline","",3,"src",4,"ngIf"],[1,"content-button","btn-back-primary","montserrat","mt-24",3,"click"],[1,"preview",3,"src"],["muted","","playsinline","",1,"preview",3,"src"]],template:function(f,s){if(1&f){const w=t.RV6();t.j41(0,"div",0)(1,"div",1)(2,"img",2),t.bIt("click",function(){return s.doCloseModal()}),t.k0s(),t.j41(3,"div",3),t.EFF(4),t.k0s(),t.j41(5,"div",4)(6,"input",5,6),t.bIt("change",function(C){return s.onFileSelected(C)}),t.k0s(),t.j41(8,"button",7),t.bIt("click",function(){t.eBV(w);const C=t.sdS(7);return t.Njj(C.click())}),t.EFF(9),t.nI1(10,"translate"),t.k0s()(),t.j41(11,"div",8)(12,"button",7),t.bIt("click",function(){return s.openCamera()}),t.EFF(13),t.nI1(14,"translate"),t.k0s()(),t.j41(15,"div",9)(16,"input",10,11),t.bIt("change",function(C){return s.onVideoSelected(C)}),t.k0s(),t.DNE(18,E,3,3,"button",12),t.k0s(),t.DNE(19,I,6,5,"div",13),t.k0s()()}2&f&&(t.R7$(4),t.JRh(s.title),t.R7$(2),t.Y8G("accept",s.acceptTypes),t.R7$(3),t.JRh(t.bMT(10,6,"choose_file")),t.R7$(4),t.JRh(t.bMT(14,8,"use_camera")),t.R7$(5),t.Y8G("ngIf",s.allowVideo),t.R7$(1),t.Y8G("ngIf",s.filePreview))},dependencies:[e.bT,r.D9],styles:[".modal[_ngcontent-%COMP%]{width:100%;height:100vh;min-height:100vh;max-height:100vh;z-index:999;background:rgba(0,0,0,.7);position:fixed;top:0;left:0}.modal-content[_ngcontent-%COMP%]{width:80%;max-width:300px;padding:20px 16px;position:relative;z-index:1000;left:50%;top:50%;transform:translate(-50%,-50%);border-radius:8px;text-align:center}.modal-close[_ngcontent-%COMP%]{width:28px;position:absolute;top:8px;right:8px}.title-upload[_ngcontent-%COMP%]{font-size:17px;font-weight:500}.content-button[_ngcontent-%COMP%]{width:100%;height:44px;line-height:44px;display:block;border-radius:44px;color:#000;text-align:center;font-size:14px;font-weight:500;cursor:pointer;transition:all ease-in-out .3s}.preview[_ngcontent-%COMP%]{max-width:100%;max-height:300px}"]}),o})()},101:Y=>{Y.exports=function t(x,G,y){function b(A,l){if(!G[A]){if(!x[A]){if(i)return i(A,!0);var r=new Error("Cannot find module '"+A+"'");throw r.code="MODULE_NOT_FOUND",r}var E=G[A]={exports:{}};x[A][0].call(E.exports,function(u){return b(x[A][1][u]||u)},E,E.exports,t,x,G,y)}return G[A].exports}for(var i=void 0,n=0;n<y.length;n++)b(y[n]);return b}({1:[function(t,x,G){"use strict";var y=t("multimath"),b=t("./mm_unsharp_mask"),i=t("./mm_resize");function n(A){var l=A||[],e={js:l.indexOf("js")>=0,wasm:l.indexOf("wasm")>=0};y.call(this,e),this.features={js:e.js,wasm:e.wasm&&this.has_wasm()},this.use(b),this.use(i)}(n.prototype=Object.create(y.prototype)).constructor=n,n.prototype.resizeAndUnsharp=function(l,e){var r=this.resize(l,e);return l.unsharpAmount&&this.unsharp_mask(r,l.toWidth,l.toHeight,l.unsharpAmount,l.unsharpRadius,l.unsharpThreshold),r},x.exports=n},{"./mm_resize":4,"./mm_unsharp_mask":9,multimath:19}],2:[function(t,x,G){"use strict";function y(e){return e<0?0:e>255?255:e}function b(e){return e>=0?e:0}x.exports={convolveHor:function i(e,r,E,u,d,I){var v,c,o,h,f,s,w,m,C,F,Q,k=0,M=0;for(C=0;C<u;C++){for(f=0,F=0;F<d;F++){for(s=I[f++],w=I[f++],m=k+4*s|0,v=c=o=h=0;w>0;w--)h=h+(Q=I[f++])*e[m+3]|0,o=o+Q*e[m+2]|0,c=c+Q*e[m+1]|0,v=v+Q*e[m]|0,m=m+4|0;r[M+3]=b(h>>7),r[M+2]=b(o>>7),r[M+1]=b(c>>7),r[M]=b(v>>7),M=M+4*u|0}M=4*(C+1)|0,k=(C+1)*E*4|0}},convolveVert:function n(e,r,E,u,d,I){var v,c,o,h,f,s,w,m,C,F,Q,k=0,M=0;for(C=0;C<u;C++){for(f=0,F=0;F<d;F++){for(s=I[f++],w=I[f++],m=k+4*s|0,v=c=o=h=0;w>0;w--)h=h+(Q=I[f++])*e[m+3]|0,o=o+Q*e[m+2]|0,c=c+Q*e[m+1]|0,v=v+Q*e[m]|0,m=m+4|0;v>>=7,c>>=7,o>>=7,r[M+3]=y(8192+(h>>=7)>>14),r[M+2]=y(o+8192>>14),r[M+1]=y(c+8192>>14),r[M]=y(v+8192>>14),M=M+4*u|0}M=4*(C+1)|0,k=(C+1)*E*4|0}},convolveHorWithPre:function A(e,r,E,u,d,I){var v,c,o,h,f,s,w,m,C,F,Q,k,M=0,S=0;for(F=0;F<u;F++){for(s=0,Q=0;Q<d;Q++){for(w=I[s++],m=I[s++],C=M+4*w|0,v=c=o=h=0;m>0;m--)h=h+(k=I[s++])*(f=e[C+3])|0,o=o+k*e[C+2]*f|0,c=c+k*e[C+1]*f|0,v=v+k*e[C]*f|0,C=C+4|0;o=o/255|0,c=c/255|0,v=v/255|0,r[S+3]=b(h>>7),r[S+2]=b(o>>7),r[S+1]=b(c>>7),r[S]=b(v>>7),S=S+4*u|0}S=4*(F+1)|0,M=(F+1)*E*4|0}},convolveVertWithPre:function l(e,r,E,u,d,I){var v,c,o,h,f,s,w,m,C,F,Q,k=0,M=0;for(C=0;C<u;C++){for(f=0,F=0;F<d;F++){for(s=I[f++],w=I[f++],m=k+4*s|0,v=c=o=h=0;w>0;w--)h=h+(Q=I[f++])*e[m+3]|0,o=o+Q*e[m+2]|0,c=c+Q*e[m+1]|0,v=v+Q*e[m]|0,m=m+4|0;v>>=7,c>>=7,o>>=7,(h=y(8192+(h>>=7)>>14))>0&&(v=255*v/h|0,c=255*c/h|0,o=255*o/h|0),r[M+3]=h,r[M+2]=y(o+8192>>14),r[M+1]=y(c+8192>>14),r[M]=y(v+8192>>14),M=M+4*u|0}M=4*(C+1)|0,k=(C+1)*E*4|0}}}},{}],3:[function(t,x,G){"use strict";x.exports="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"},{}],4:[function(t,x,G){"use strict";x.exports={name:"resize",fn:t("./resize"),wasm_fn:t("./resize_wasm"),wasm_src:t("./convolve_wasm_base64")}},{"./convolve_wasm_base64":3,"./resize":5,"./resize_wasm":8}],5:[function(t,x,G){"use strict";var y=t("./resize_filter_gen"),b=t("./convolve"),i=b.convolveHor,n=b.convolveVert,A=b.convolveHorWithPre,l=b.convolveVertWithPre;x.exports=function(u){var d=u.src,I=u.width,v=u.height,c=u.toWidth,o=u.toHeight,h=u.scaleX||u.toWidth/u.width,f=u.scaleY||u.toHeight/u.height,s=u.offsetX||0,w=u.offsetY||0,m=u.dest||new Uint8Array(c*o*4),C=typeof u.filter>"u"?"mks2013":u.filter,F=y(C,I,c,h,s),Q=y(C,v,o,f,w),k=new Uint16Array(c*v*4);return function e(E,u,d){for(var I=3,v=u*d*4|0;I<v;){if(255!==E[I])return!0;I=I+4|0}return!1}(d,I,v)?(A(d,k,I,v,c,F),l(k,m,v,c,o,Q)):(i(d,k,I,v,c,F),n(k,m,v,c,o,Q),function r(E,u,d){for(var I=3,v=u*d*4|0;I<v;)E[I]=255,I=I+4|0}(m,c,o)),m}},{"./convolve":2,"./resize_filter_gen":6}],6:[function(t,x,G){"use strict";var y=t("./resize_filter_info");function i(n){return Math.round(16383*n)}x.exports=function(A,l,e,r,E){var c,o,h,f,s,w,m,C,F,Q,k,M,S,R,a,g,u=y.filter[A].fn,d=1/r,I=Math.min(1,r),v=y.filter[A].win/I,B=Math.floor(2*(v+1)),_=new Int16Array((B+2)*e),P=0,D=!_.subarray||!_.set;for(c=0;c<e;c++){for(o=(c+.5)*d+E,h=Math.max(0,Math.floor(o-v)),s=(f=Math.min(l-1,Math.ceil(o+v)))-h+1,w=new Float32Array(s),m=new Int16Array(s),C=0,F=h,Q=0;F<=f;F++,Q++)C+=k=u((F+.5-o)*I),w[Q]=k;for(M=0,Q=0;Q<w.length;Q++)M+=S=w[Q]/C,m[Q]=i(S);for(m[e>>1]+=i(1-M),R=0;R<m.length&&0===m[R];)R++;if(R<m.length){for(a=m.length-1;a>0&&0===m[a];)a--;if(g=a-R+1,_[P++]=h+R,_[P++]=g,D)for(Q=R;Q<=a;Q++)_[P++]=m[Q];else _.set(m.subarray(R,a+1),P),P+=g}else _[P++]=0,_[P++]=0}return _}},{"./resize_filter_info":7}],7:[function(t,x,G){"use strict";x.exports={filter:{box:{win:.5,fn:function(i){return i<0&&(i=-i),i<.5?1:0}},hamming:{win:1,fn:function(i){if(i<0&&(i=-i),i>=1)return 0;if(i<1.1920929e-7)return 1;var n=i*Math.PI;return Math.sin(n)/n*(.54+.46*Math.cos(n/1))}},lanczos2:{win:2,fn:function(i){if(i<0&&(i=-i),i>=2)return 0;if(i<1.1920929e-7)return 1;var n=i*Math.PI;return Math.sin(n)/n*Math.sin(n/2)/(n/2)}},lanczos3:{win:3,fn:function(i){if(i<0&&(i=-i),i>=3)return 0;if(i<1.1920929e-7)return 1;var n=i*Math.PI;return Math.sin(n)/n*Math.sin(n/3)/(n/3)}},mks2013:{win:2.5,fn:function(i){return i<0&&(i=-i),i>=2.5?0:i>=1.5?-.125*(i-2.5)*(i-2.5):i>=.5?.25*(4*i*i-11*i+7):1.0625-1.75*i*i}}},f2q:{box:0,hamming:1,lanczos2:2,lanczos3:3},q2f:["box","hamming","lanczos2","lanczos3"]}},{}],8:[function(t,x,G){"use strict";var y=t("./resize_filter_gen");var A=!0;try{A=1===new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0]}catch{}function l(e,r,E){if(A)r.set(function n(e){return new Uint8Array(e.buffer,0,e.byteLength)}(e),E);else for(var u=E,d=0;d<e.length;d++){var I=e[d];r[u++]=255&I,r[u++]=I>>8&255}}x.exports=function(r){var E=r.src,u=r.width,d=r.height,I=r.toWidth,v=r.toHeight,c=r.scaleX||r.toWidth/r.width,o=r.scaleY||r.toHeight/r.height,h=r.offsetX||0,f=r.offsetY||0,s=r.dest||new Uint8Array(I*v*4),w=typeof r.filter>"u"?"mks2013":r.filter,m=y(w,u,I,c,h),C=y(w,d,v,o,f),Q=Math.max(E.byteLength,s.byteLength),k=this.__align(0+Q),S=this.__align(k+d*I*4*2),R=this.__align(S+m.byteLength),p=this.__instance("resize",R+C.byteLength),g=new Uint8Array(this.__memory.buffer),B=new Uint32Array(this.__memory.buffer),_=new Uint32Array(E.buffer);B.set(_),l(m,g,S),l(C,g,R);var P=p.exports.convolveHV||p.exports._convolveHV;return function b(e,r,E){for(var u=3,d=r*E*4|0;u<d;){if(255!==e[u])return!0;u=u+4|0}return!1}(E,u,d)?P(S,R,k,u,d,I,v,1):(P(S,R,k,u,d,I,v,0),function i(e,r,E){for(var u=3,d=r*E*4|0;u<d;)e[u]=255,u=u+4|0}(s,I,v)),new Uint32Array(s.buffer).set(new Uint32Array(this.__memory.buffer,0,v*I)),s}},{"./resize_filter_gen":6}],9:[function(t,x,G){"use strict";x.exports={name:"unsharp_mask",fn:t("./unsharp_mask"),wasm_fn:t("./unsharp_mask_wasm"),wasm_src:t("./unsharp_mask_wasm_base64")}},{"./unsharp_mask":10,"./unsharp_mask_wasm":11,"./unsharp_mask_wasm_base64":12}],10:[function(t,x,G){"use strict";var y=t("glur/mono16");x.exports=function(n,A,l,e,r,E){var u,d,I,v,c;if(!(0===e||r<.5)){r>2&&(r=2);var o=function b(i,n,A){for(var r,E,u,l=n*A,e=new Uint16Array(l),I=0;I<l;I++)u=i[4*I+2],e[I]=((r=i[4*I])>=(E=i[4*I+1])&&r>=u?r:E>=u&&E>=r?E:u)<<8;return e}(n,A,l),h=new Uint16Array(o);y(h,A,l,r);for(var f=e/100*4096+.5|0,s=E<<8,w=A*l,m=0;m<w;m++)v=(u=o[m])-h[m],Math.abs(v)>=s&&(n[c=4*m]=n[c]*(I=((d=(d=(d=u+(f*v+2048>>12))>65280?65280:d)<0?0:d)<<12)/(u=0!==u?u:1)|0)+2048>>12,n[c+1]=n[c+1]*I+2048>>12,n[c+2]=n[c+2]*I+2048>>12)}}},{"glur/mono16":18}],11:[function(t,x,G){"use strict";x.exports=function(b,i,n,A,l,e){if(!(0===A||l<.5)){l>2&&(l=2);var r=i*n,E=4*r,u=2*r,d=2*r,I=4*Math.max(i,n),o=E,h=o+u,f=h+d,s=f+d,w=s+I,m=this.__instance("unsharp_mask",E+u+2*d+I+32,{exp:Math.exp}),C=new Uint32Array(b.buffer);new Uint32Array(this.__memory.buffer).set(C);var Q=m.exports.hsv_v16||m.exports._hsv_v16;Q(0,o,i,n),(Q=m.exports.blurMono16||m.exports._blurMono16)(o,h,f,s,w,i,n,l),(Q=m.exports.unsharp||m.exports._unsharp)(0,0,o,h,i,n,A,e),C.set(new Uint32Array(this.__memory.buffer,0,r))}}},{}],12:[function(t,x,G){"use strict";x.exports="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"},{}],13:[function(t,x,G){"use strict";function b(i,n){this.create=i,this.available=[],this.acquired={},this.lastId=1,this.timeoutId=0,this.idle=n||2e3}b.prototype.acquire=function(){var n,i=this;return 0!==this.available.length?n=this.available.pop():((n=this.create()).id=this.lastId++,n.release=function(){return i.release(n)}),this.acquired[n.id]=n,n},b.prototype.release=function(i){var n=this;delete this.acquired[i.id],i.lastUsed=Date.now(),this.available.push(i),0===this.timeoutId&&(this.timeoutId=setTimeout(function(){return n.gc()},100))},b.prototype.gc=function(){var i=this,n=Date.now();this.available=this.available.filter(function(A){return!(n-A.lastUsed>i.idle&&(A.destroy(),1))}),this.timeoutId=0!==this.available.length?setTimeout(function(){return i.gc()},100):0},x.exports=b},{}],14:[function(t,x,G){"use strict";x.exports=function(i,n,A,l,e,r){var d=(2*r+2+1)/e;if(d>.5)return[[A,l]];var I=Math.ceil(Math.log(Math.min(A/i,l/n))/Math.log(d));if(I<=1)return[[A,l]];for(var v=[],c=0;c<I;c++){var o=Math.round(Math.pow(Math.pow(i,I-c-1)*Math.pow(A,c+1),1/I)),h=Math.round(Math.pow(Math.pow(n,I-c-1)*Math.pow(l,c+1),1/I));v.push([o,h])}return v}},{}],15:[function(t,x,G){"use strict";var y=1e-5;function b(n){var A=Math.round(n);return Math.abs(n-A)<y?A:Math.floor(n)}function i(n){var A=Math.round(n);return Math.abs(n-A)<y?A:Math.ceil(n)}x.exports=function(A){var l=A.toWidth/A.width,e=A.toHeight/A.height,r=b(A.srcTileSize*l)-2*A.destTileBorder,E=b(A.srcTileSize*e)-2*A.destTileBorder;if(r<1||E<1)throw new Error("Internal error in pica: target tile width/height is too small.");var u,d,I,v,c,o,f,h=[];for(v=0;v<A.toHeight;v+=E)for(I=0;I<A.toWidth;I+=r)(u=I-A.destTileBorder)<0&&(u=0),u+(c=I+r+A.destTileBorder-u)>=A.toWidth&&(c=A.toWidth-u),(d=v-A.destTileBorder)<0&&(d=0),d+(o=v+E+A.destTileBorder-d)>=A.toHeight&&(o=A.toHeight-d),f={toX:u,toY:d,toWidth:c,toHeight:o,toInnerX:I,toInnerY:v,toInnerWidth:r,toInnerHeight:E,offsetX:u/l-b(u/l),offsetY:d/e-b(d/e),scaleX:l,scaleY:e,x:b(u/l),y:b(d/e),width:i(c/l),height:i(o/e)},h.push(f);return h}},{}],16:[function(t,x,G){"use strict";function y(b){return Object.prototype.toString.call(b)}x.exports.isCanvas=function(i){var n=y(i);return"[object HTMLCanvasElement]"===n||"[object OffscreenCanvas]"===n||"[object Canvas]"===n},x.exports.isImage=function(i){return"[object HTMLImageElement]"===y(i)},x.exports.isImageBitmap=function(i){return"[object ImageBitmap]"===y(i)},x.exports.limiter=function(i){var n=0,A=[];function l(){n<i&&A.length&&(n++,A.shift()())}return function(r){return new Promise(function(E,u){A.push(function(){r().then(function(d){E(d),n--,l()},function(d){u(d),n--,l()})}),l()})}},x.exports.cib_quality_name=function(i){switch(i){case 0:return"pixelated";case 1:return"low";case 2:return"medium"}return"high"},x.exports.cib_support=function(i){return Promise.resolve().then(function(){if(typeof createImageBitmap>"u")return!1;var n=i(100,100);return createImageBitmap(n,0,0,100,100,{resizeWidth:10,resizeHeight:10,resizeQuality:"high"}).then(function(A){var l=10===A.width;return A.close(),n=null,l})}).catch(function(){return!1})},x.exports.worker_offscreen_canvas_support=function(){return new Promise(function(i,n){if(typeof OffscreenCanvas>"u")i(!1);else{var l=btoa("(".concat(function A(r){typeof createImageBitmap>"u"?r.postMessage(!1):Promise.resolve().then(function(){var E=new OffscreenCanvas(10,10);return E.getContext("2d").rect(0,0,1,1),createImageBitmap(E,0,0,1,1)}).then(function(){return r.postMessage(!0)},function(){return r.postMessage(!1)})}.toString(),")(self);")),e=new Worker("data:text/javascript;base64,".concat(l));e.onmessage=function(r){return i(r.data)},e.onerror=n}}).then(function(i){return i},function(){return!1})},x.exports.can_use_canvas=function(i){var n=!1;try{var l=i(2,1).getContext("2d"),e=l.createImageData(2,1);e.data[0]=12,e.data[1]=23,e.data[2]=34,e.data[3]=255,e.data[4]=45,e.data[5]=56,e.data[6]=67,e.data[7]=255,l.putImageData(e,0,0),e=null,12===(e=l.getImageData(0,0,2,1)).data[0]&&23===e.data[1]&&34===e.data[2]&&255===e.data[3]&&45===e.data[4]&&56===e.data[5]&&67===e.data[6]&&255===e.data[7]&&(n=!0)}catch{}return n},x.exports.cib_can_use_region=function(){return new Promise(function(i){if(typeof Image>"u"||typeof createImageBitmap>"u")i(!1);else{var n=new Image;n.src="data:image/jpeg;base64,/9j/4QBiRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAYAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAAAAABIAAAAAQAAAEgAAAAB/9sAQwAEAwMEAwMEBAMEBQQEBQYKBwYGBgYNCQoICg8NEBAPDQ8OERMYFBESFxIODxUcFRcZGRsbGxAUHR8dGh8YGhsa/9sAQwEEBQUGBQYMBwcMGhEPERoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoa/8IAEQgAAQACAwERAAIRAQMRAf/EABQAAQAAAAAAAAAAAAAAAAAAAAf/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAF/P//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAQUCf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Bf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Bf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEABj8Cf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8hf//aAAwDAQACAAMAAAAQH//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Qf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Qf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8Qf//Z",n.onload=function(){createImageBitmap(n,0,0,n.width,n.height).then(function(A){i(A.width===n.width&&A.height===n.height)},function(){return i(!1)})},n.onerror=function(){return i(!1)}}})}},{}],17:[function(t,x,G){"use strict";x.exports=function(){var b,y=t("./mathlib");onmessage=function(n){var A=n.data.opts;if(!A.src&&A.srcBitmap){var e=new OffscreenCanvas(A.width,A.height),r=e.getContext("2d");r.drawImage(A.srcBitmap,0,0),A.src=r.getImageData(0,0,A.width,A.height).data,e.width=e.height=0,e=null,A.srcBitmap.close(),A.srcBitmap=null}b||(b=new y(n.data.features));var E=b.resizeAndUnsharp(A);postMessage({data:E},[E.buffer])}}},{"./mathlib":1}],18:[function(t,x,G){var y,b,i,n,A,l;function u(I,v,c,o,h,f){var s,w,m,C,F,Q,k,M,S,R,a,p,g,B;for(S=0;S<f;S++){for(k=S,M=0,C=F=(s=I[Q=S*h])*o[6],a=o[0],p=o[1],g=o[4],B=o[5],R=0;R<h;R++)m=(w=I[Q])*a+s*p+C*g+F*B,F=C,s=w,c[M]=C=m,M++,Q++;for(M--,k+=f*(h-1),C=F=(s=I[--Q])*o[7],w=s,a=o[2],p=o[3],R=h-1;R>=0;R--)m=w*a+s*p+C*g+F*B,F=C,s=w,w=I[Q],v[k]=c[M]+(C=m),Q--,M--,k-=f}}x.exports=function d(I,v,c,o){if(o){var h=new Uint16Array(I.length),f=new Float32Array(Math.max(v,c)),s=function E(I){I<.5&&(I=.5);var v=Math.exp(.527076)/I,c=Math.exp(-v),o=Math.exp(-2*v),h=(1-c)*(1-c)/(1+2*v*c-o);return y=h,b=h*(v-1)*c,i=h*(v+1)*c,n=-h*o,A=2*c,l=-o,new Float32Array([y,b,i,n,A,l,(y+b)/(1-A-l),(i+n)/(1-A-l)])}(o);u(I,h,f,s,v,c),u(h,I,f,s,c,v)}}},{}],19:[function(t,x,G){"use strict";var y=t("object-assign"),b=t("./lib/base64decode"),i=t("./lib/wa_detect"),n={js:!0,wasm:!0};function A(l){if(!(this instanceof A))return new A(l);var e=y({},n,l||{});if(this.options=e,this.__cache={},this.__init_promise=null,this.__modules=e.modules||{},this.__memory=null,this.__wasm={},this.__isLE=1===new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0],!this.options.js&&!this.options.wasm)throw new Error('mathlib: at least "js" or "wasm" should be enabled')}A.prototype.has_wasm=i,A.prototype.use=function(l){return this.__modules[l.name]=l,this[l.name]=this.options.wasm&&this.has_wasm()&&l.wasm_fn?l.wasm_fn:l.fn,this},A.prototype.init=function(){if(this.__init_promise)return this.__init_promise;if(!this.options.js&&this.options.wasm&&!this.has_wasm())return Promise.reject(new Error('mathlib: only "wasm" was enabled, but it\'s not supported'));var l=this;return this.__init_promise=Promise.all(Object.keys(l.__modules).map(function(e){var r=l.__modules[e];return l.options.wasm&&l.has_wasm()&&r.wasm_fn&&!l.__wasm[e]?WebAssembly.compile(l.__base64decode(r.wasm_src)).then(function(E){l.__wasm[e]=E}):null})).then(function(){return l}),this.__init_promise},A.prototype.__base64decode=b,A.prototype.__reallocate=function(e){if(!this.__memory)return this.__memory=new WebAssembly.Memory({initial:Math.ceil(e/65536)}),this.__memory;var r=this.__memory.buffer.byteLength;return r<e&&this.__memory.grow(Math.ceil((e-r)/65536)),this.__memory},A.prototype.__instance=function(e,r,E){if(r&&this.__reallocate(r),this.__wasm[e]||(this.__wasm[e]=new WebAssembly.Module(this.__base64decode(this.__modules[e].wasm_src))),!this.__cache[e]){var d={memoryBase:0,memory:this.__memory,tableBase:0,table:new WebAssembly.Table({initial:0,element:"anyfunc"})};this.__cache[e]=new WebAssembly.Instance(this.__wasm[e],{env:y(d,E||{})})}return this.__cache[e]},A.prototype.__align=function(e,r){var E=e%(r=r||8);return e+(E?r-E:0)},x.exports=A},{"./lib/base64decode":20,"./lib/wa_detect":21,"object-assign":22}],20:[function(t,x,G){"use strict";x.exports=function(i){for(var n=i.replace(/[\r\n=]/g,""),A=n.length,l=new Uint8Array(3*A>>2),e=0,r=0,E=0;E<A;E++)E%4==0&&E&&(l[r++]=e>>16&255,l[r++]=e>>8&255,l[r++]=255&e),e=e<<6|"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(n.charAt(E));var u=A%4*6;return 0===u?(l[r++]=e>>16&255,l[r++]=e>>8&255,l[r++]=255&e):18===u?(l[r++]=e>>10&255,l[r++]=e>>2&255):12===u&&(l[r++]=e>>4&255),l}},{}],21:[function(t,x,G){"use strict";var y;x.exports=function(){if(typeof y<"u"||(y=!1,typeof WebAssembly>"u"))return y;try{var i=new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11]),n=new WebAssembly.Module(i);return 0!==new WebAssembly.Instance(n,{}).exports.test(4)&&(y=!0),y}catch{}return y}},{}],22:[function(t,x,G){"use strict";var y=Object.getOwnPropertySymbols,b=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;x.exports=function A(){try{if(!Object.assign)return!1;var l=new String("abc");if(l[5]="de","5"===Object.getOwnPropertyNames(l)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(d){return e[d]}).join(""))return!1;var u={};return"abcdefghijklmnopqrst".split("").forEach(function(d){u[d]=d}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},u)).join("")}catch{return!1}}()?Object.assign:function(l,e){for(var r,u,E=function n(l){if(null==l)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(l)}(l),d=1;d<arguments.length;d++){for(var I in r=Object(arguments[d]))b.call(r,I)&&(E[I]=r[I]);if(y){u=y(r);for(var v=0;v<u.length;v++)i.call(r,u[v])&&(E[u[v]]=r[u[v]])}}return E}},{}],23:[function(t,x,G){var y=arguments[3],b=arguments[4],i=arguments[5],n=JSON.stringify;x.exports=function(A,l){for(var e,r=Object.keys(i),E=0,u=r.length;E<u;E++){var I=i[d=r[E]].exports;if(I===A||I&&I.default===A){e=d;break}}if(!e){e=Math.floor(Math.pow(16,8)*Math.random()).toString(16);var v={};for(E=0,u=r.length;E<u;E++){var d;v[d=r[E]]=d}b[e]=["function(require,module,exports){"+A+"(self); }",v]}var c=Math.floor(Math.pow(16,8)*Math.random()).toString(16),o={};o[e]=e,b[c]=["function(require,module,exports){var f = require("+n(e)+");(f.default ? f.default : f)(self);}",o];var h={};!function f(Q){for(var k in h[Q]=!0,b[Q][1]){var M=b[Q][1][k];h[M]||f(M)}}(c);var s="("+y+")({"+Object.keys(h).map(function(Q){return n(Q)+":["+b[Q][0]+","+n(b[Q][1])+"]"}).join(",")+"},{},["+n(c)+"])",w=window.URL||window.webkitURL||window.mozURL||window.msURL,m=new Blob([s],{type:"text/javascript"});if(l&&l.bare)return m;var C=w.createObjectURL(m),F=new Worker(C);return F.objectURL=C,F}},{}],"/index.js":[function(t,x,G){"use strict";function y(a,p){return function l(a){if(Array.isArray(a))return a}(a)||function A(a,p){var g=null==a?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(null!=g){var D,U,B=[],_=!0,P=!1;try{for(g=g.call(a);!(_=(D=g.next()).done)&&(B.push(D.value),!p||B.length!==p);_=!0);}catch(O){P=!0,U=O}finally{try{!_&&null!=g.return&&g.return()}finally{if(P)throw U}}return B}}(a,p)||function i(a,p){if(a){if("string"==typeof a)return n(a,p);var g=Object.prototype.toString.call(a).slice(8,-1);if("Object"===g&&a.constructor&&(g=a.constructor.name),"Map"===g||"Set"===g)return Array.from(a);if("Arguments"===g||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return n(a,p)}}(a,p)||function b(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(a,p){(null==p||p>a.length)&&(p=a.length);for(var g=0,B=new Array(p);g<p;g++)B[g]=a[g];return B}var e=t("object-assign"),r=t("webworkify"),E=t("./lib/mathlib"),u=t("./lib/pool"),d=t("./lib/utils"),I=t("./lib/worker"),v=t("./lib/stepper"),c=t("./lib/tiler"),o=t("./lib/mm_resize/resize_filter_info"),h={},f=!1;try{typeof navigator<"u"&&navigator.userAgent&&(f=navigator.userAgent.indexOf("Safari")>=0)}catch{}var s=1;typeof navigator<"u"&&(s=Math.min(navigator.hardwareConcurrency||1,4));var w={tile:1024,concurrency:s,features:["js","wasm","ww"],idle:2e3,createCanvas:function(p,g){var B=document.createElement("canvas");return B.width=p,B.height=g,B}},m={filter:"mks2013",unsharpAmount:0,unsharpRadius:0,unsharpThreshold:0},C=!1,F=!1,Q=!1,k=!1,M=!1;function S(){return{value:r(I),destroy:function(){if(this.value.terminate(),typeof window<"u"){var p=window.URL||window.webkitURL||window.mozURL||window.msURL;p&&p.revokeObjectURL&&this.value.objectURL&&p.revokeObjectURL(this.value.objectURL)}}}}function R(a){if(!(this instanceof R))return new R(a);this.options=e({},w,a||{});var p="lk_".concat(this.options.concurrency);this.__limit=h[p]||d.limiter(this.options.concurrency),h[p]||(h[p]=this.__limit),this.features={js:!1,wasm:!1,cib:!1,ww:!1},this.__workersPool=null,this.__requested_features=[],this.__mathlib=null}R.prototype.init=function(){var a=this;if(this.__initPromise)return this.__initPromise;if(typeof ImageData<"u"&&typeof Uint8ClampedArray<"u")try{new ImageData(new Uint8ClampedArray(400),10,10),C=!0}catch{}typeof ImageBitmap<"u"&&(ImageBitmap.prototype&&ImageBitmap.prototype.close?F=!0:this.debug("ImageBitmap does not support .close(), disabled"));var p=this.options.features.slice();if(p.indexOf("all")>=0&&(p=["cib","wasm","js","ww"]),this.__requested_features=p,this.__mathlib=new E(p),p.indexOf("ww")>=0&&typeof window<"u"&&"Worker"in window)try{t("webworkify")(function(){}).terminate(),this.features.ww=!0;var B="wp_".concat(JSON.stringify(this.options));h[B]?this.__workersPool=h[B]:(this.__workersPool=new u(S,this.options.idle),h[B]=this.__workersPool)}catch{}var P,D,_=this.__mathlib.init().then(function(O){e(a.features,O.features)});P=F?d.cib_support(this.options.createCanvas).then(function(O){a.features.cib&&p.indexOf("cib")<0?a.debug("createImageBitmap() resize supported, but disabled by config"):p.indexOf("cib")>=0&&(a.features.cib=O)}):Promise.resolve(!1),Q=d.can_use_canvas(this.options.createCanvas),D=(D=F&&C&&-1!==p.indexOf("ww")?d.worker_offscreen_canvas_support():Promise.resolve(!1)).then(function(O){k=O});var U=d.cib_can_use_region().then(function(O){M=O});return this.__initPromise=Promise.all([_,P,D,U]).then(function(){return a}),this.__initPromise},R.prototype.__invokeResize=function(a,p){var g=this;return p.__mathCache=p.__mathCache||{},Promise.resolve().then(function(){return g.features.ww?new Promise(function(B,_){var P=g.__workersPool.acquire();p.cancelToken&&p.cancelToken.catch(function(U){return _(U)}),P.value.onmessage=function(U){P.release(),U.data.err?_(U.data.err):B(U.data)};var D=[];a.src&&D.push(a.src.buffer),a.srcBitmap&&D.push(a.srcBitmap),P.value.postMessage({opts:a,features:g.__requested_features,preload:{wasm_nodule:g.__mathlib.__}},D)}):{data:g.__mathlib.resizeAndUnsharp(a,p.__mathCache)}})},R.prototype.__extractTileData=function(a,p,g,B,_){if(this.features.ww&&k&&(d.isCanvas(p)||M))return this.debug("Create tile for OffscreenCanvas"),createImageBitmap(B.srcImageBitmap||p,a.x,a.y,a.width,a.height).then(function(U){return _.srcBitmap=U,_});if(d.isCanvas(p))return B.srcCtx||(B.srcCtx=p.getContext("2d")),this.debug("Get tile pixel data"),_.src=B.srcCtx.getImageData(a.x,a.y,a.width,a.height).data,_;this.debug("Draw tile imageBitmap/image to temporary canvas");var P=this.options.createCanvas(a.width,a.height),D=P.getContext("2d");return D.globalCompositeOperation="copy",D.drawImage(B.srcImageBitmap||p,a.x,a.y,a.width,a.height,0,0,a.width,a.height),this.debug("Get tile pixel data"),_.src=D.getImageData(0,0,a.width,a.height).data,P.width=P.height=0,_},R.prototype.__landTileData=function(a,p,g){var B;if(this.debug("Convert raw rgba tile result to ImageData"),p.bitmap)return g.toCtx.drawImage(p.bitmap,a.toX,a.toY),null;if(C)B=new ImageData(new Uint8ClampedArray(p.data),a.toWidth,a.toHeight);else if((B=g.toCtx.createImageData(a.toWidth,a.toHeight)).data.set)B.data.set(p.data);else for(var _=B.data.length-1;_>=0;_--)B.data[_]=p.data[_];return this.debug("Draw tile"),f?g.toCtx.putImageData(B,a.toX,a.toY,a.toInnerX-a.toX,a.toInnerY-a.toY,a.toInnerWidth+1e-5,a.toInnerHeight+1e-5):g.toCtx.putImageData(B,a.toX,a.toY,a.toInnerX-a.toX,a.toInnerY-a.toY,a.toInnerWidth,a.toInnerHeight),null},R.prototype.__tileAndResize=function(a,p,g){var B=this,_={srcCtx:null,srcImageBitmap:null,isImageBitmapReused:!1,toCtx:null};return Promise.resolve().then(function(){if(_.toCtx=p.getContext("2d"),d.isCanvas(a))return null;if(d.isImageBitmap(a))return _.srcImageBitmap=a,_.isImageBitmapReused=!0,null;if(d.isImage(a))return F?(B.debug("Decode image via createImageBitmap"),createImageBitmap(a).then(function(D){_.srcImageBitmap=D}).catch(function(D){return null})):null;throw new Error('Pica: ".from" should be Image, Canvas or ImageBitmap')}).then(function(){if(g.canceled)return g.cancelToken;B.debug("Calculate tiles");var U=c({width:g.width,height:g.height,srcTileSize:B.options.tile,toWidth:g.toWidth,toHeight:g.toHeight,destTileBorder:g.__destTileBorder}).map(function(L){return function(U){return B.__limit(function(){if(g.canceled)return g.cancelToken;var O={width:U.width,height:U.height,toWidth:U.toWidth,toHeight:U.toHeight,scaleX:U.scaleX,scaleY:U.scaleY,offsetX:U.offsetX,offsetY:U.offsetY,filter:g.filter,unsharpAmount:g.unsharpAmount,unsharpRadius:g.unsharpRadius,unsharpThreshold:g.unsharpThreshold};return B.debug("Invoke resize math"),Promise.resolve(O).then(function(L){return B.__extractTileData(U,a,g,_,L)}).then(function(L){return B.debug("Invoke resize math"),B.__invokeResize(L,g)}).then(function(L){return g.canceled?g.cancelToken:(_.srcImageData=null,B.__landTileData(U,L,_))})})}(L)});function O(L){L.srcImageBitmap&&(L.isImageBitmapReused||L.srcImageBitmap.close(),L.srcImageBitmap=null)}return B.debug("Process tiles"),Promise.all(U).then(function(){return B.debug("Finished!"),O(_),p},function(L){throw O(_),L})})},R.prototype.__processStages=function(a,p,g,B){var _=this;if(B.canceled)return B.cancelToken;var N,W,D=y(a.shift(),2),U=D[0],O=D[1],L=0===a.length;return N=L||o.q2f.indexOf(B.filter)<0?B.filter:"box"===B.filter?"box":"hamming",B=e({},B,{toWidth:U,toHeight:O,filter:N}),L||(W=this.options.createCanvas(U,O)),this.__tileAndResize(p,L?g:W,B).then(function(){return L?g:(B.width=U,B.height=O,_.__processStages(a,W,g,B))}).then(function(z){return W&&(W.width=W.height=0),z})},R.prototype.__resizeViaCreateImageBitmap=function(a,p,g){var B=this,_=p.getContext("2d");return this.debug("Resize via createImageBitmap()"),createImageBitmap(a,{resizeWidth:g.toWidth,resizeHeight:g.toHeight,resizeQuality:d.cib_quality_name(o.f2q[g.filter])}).then(function(P){if(g.canceled)return g.cancelToken;if(!g.unsharpAmount)return _.drawImage(P,0,0),P.close(),_=null,B.debug("Finished!"),p;B.debug("Unsharp result");var D=B.options.createCanvas(g.toWidth,g.toHeight),U=D.getContext("2d");U.drawImage(P,0,0),P.close();var O=U.getImageData(0,0,g.toWidth,g.toHeight);return B.__mathlib.unsharp_mask(O.data,g.toWidth,g.toHeight,g.unsharpAmount,g.unsharpRadius,g.unsharpThreshold),_.putImageData(O,0,0),D.width=D.height=0,O=U=D=_=null,B.debug("Finished!"),p})},R.prototype.resize=function(a,p,g){var B=this;this.debug("Start resize...");var _=e({},m);if(isNaN(g)?g&&(_=e(_,g)):_=e(_,{quality:g}),_.toWidth=p.width,_.toHeight=p.height,_.width=a.naturalWidth||a.width,_.height=a.naturalHeight||a.height,Object.prototype.hasOwnProperty.call(_,"quality")){if(_.quality<0||_.quality>3)throw new Error("Pica: .quality should be [0..3], got ".concat(_.quality));_.filter=o.q2f[_.quality]}return 0===p.width||0===p.height?Promise.reject(new Error("Invalid output size: ".concat(p.width,"x").concat(p.height))):(_.unsharpRadius>2&&(_.unsharpRadius=2),_.canceled=!1,_.cancelToken&&(_.cancelToken=_.cancelToken.then(function(D){throw _.canceled=!0,D},function(D){throw _.canceled=!0,D})),_.__destTileBorder=Math.ceil(Math.max(3,2.5*_.unsharpRadius|0)),this.init().then(function(){if(_.canceled)return _.cancelToken;if(B.features.cib){if(o.q2f.indexOf(_.filter)>=0)return B.__resizeViaCreateImageBitmap(a,p,_);B.debug("cib is enabled, but not supports provided filter, fallback to manual math")}if(!Q){var D=new Error("Pica: cannot use getImageData on canvas, make sure fingerprinting protection isn't enabled");throw D.code="ERR_GET_IMAGE_DATA",D}var U=v(_.width,_.height,_.toWidth,_.toHeight,B.options.tile,_.__destTileBorder);return B.__processStages(U,a,p,_)}))},R.prototype.resizeBuffer=function(a){var p=this,g=e({},m,a);if(Object.prototype.hasOwnProperty.call(g,"quality")){if(g.quality<0||g.quality>3)throw new Error("Pica: .quality should be [0..3], got ".concat(g.quality));g.filter=o.q2f[g.quality]}return this.init().then(function(){return p.__mathlib.resizeAndUnsharp(g)})},R.prototype.toBlob=function(a,p,g){return p=p||"image/png",new Promise(function(B){if(a.toBlob)a.toBlob(function(O){return B(O)},p,g);else if(a.convertToBlob)B(a.convertToBlob({type:p,quality:g}));else{for(var _=atob(a.toDataURL(p,g).split(",")[1]),P=_.length,D=new Uint8Array(P),U=0;U<P;U++)D[U]=_.charCodeAt(U);B(new Blob([D],{type:p}))}})},R.prototype.debug=function(){},x.exports=R},{"./lib/mathlib":1,"./lib/mm_resize/resize_filter_info":7,"./lib/pool":13,"./lib/stepper":14,"./lib/tiler":15,"./lib/utils":16,"./lib/worker":17,"object-assign":22,webworkify:23}]},{},[])("/index.js")},4843:(Y,j,H)=>{"use strict";H.d(j,{_:()=>x});var T=H(9350),t=H(7707);function x(G,y){const b="object"==typeof y;return new Promise((i,n)=>{const A=new t.Ms({next:l=>{i(l),A.unsubscribe()},error:n,complete:()=>{b?i(y.defaultValue):n(new T.G)}});G.subscribe(A)})}}}]);